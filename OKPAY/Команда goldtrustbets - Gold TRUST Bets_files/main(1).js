/*
 RequireJS 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/
var redhelper;
(function(){if(typeof redhelper==="undefined"){redhelper={};var a,e,d;(function(f){function j(a){return z.call(a)==="[object Function]"}function g(a){return z.call(a)==="[object Array]"}function b(a,b){if(a){var d;for(d=0;d<a.length;d+=1)if(a[d]&&b(a[d],d,a))break}}function c(a,b){if(a){var d;for(d=a.length-1;d>-1;d-=1)if(a[d]&&b(a[d],d,a))break}}function k(a,b){for(var d in a)if(a.hasOwnProperty(d)&&b(a[d],d))break}function n(a,b,d,c){b&&k(b,function(b,e){if(d||!a.hasOwnProperty(e))c&&typeof b!==
"string"?(a[e]||(a[e]={}),n(a[e],b,d,c)):a[e]=b});return a}function w(a,b){return function(){return b.apply(a,arguments)}}function o(a){if(!a)return a;var d=f;b(a.split("."),function(a){d=d[a]});return d}function r(a,b,d){return function(){var c=G.call(arguments,0),e;if(d&&j(e=c[c.length-1]))e.__requireJsBuild=!0;c.push(b);return a.apply(null,c)}}function u(a,d,c){b([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(b){var e=b[1]||b[0];a[b[0]]=d?r(d[e],c):
function(){var a=P[s];return a[e].apply(a,arguments)}})}function m(a,b,d,c){b=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);b.requireType=a;b.requireModules=c;if(d)b.originalError=d;return b}function p(){if(Y&&Y.readyState==="interactive")return Y;c(document.getElementsByTagName("script"),function(a){if(a.readyState==="interactive")return Y=a});return Y}var q=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,E=/require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,y=/\.js$/,H=/^\.\//,z=Object.prototype.toString,
t=Array.prototype,G=t.slice,v=t.splice,D=!!(typeof window!=="undefined"&&navigator&&document),Q=!D&&typeof importScripts!=="undefined",O=D&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,s="_",S=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",P={},B={},V=[],Z=!1,J,R,F,M,U,Y,x,C,K;if(typeof d==="undefined"){if(typeof a!=="undefined"){if(j(a))return;B=a;a=void 0}typeof e!=="undefined"&&!j(e)&&(B=e,e=void 0);J=a=function(a,b,d,c){var e=s,f;!g(a)&&typeof a!=="string"&&
(f=a,g(b)?(a=b,b=d,d=c):a=[]);if(f&&f.context)e=f.context;(c=P[e])||(c=P[e]=J.s.newContext(e));f&&c.configure(f);return c.require(a,b,d)};J.config=function(a){return J(a)};e||(e=J);J.version="2.0.2";J.jsExtRegExp=/^\/|:|\?|\.js$/;J.isBrowser=D;t=J.s={contexts:P,newContext:function(a){function d(a,b,c){var e=b&&b.split("/"),f=F.map,g=f&&f["*"],m,k,j,p;if(a&&a.charAt(0)===".")if(b){e=F.pkgs[b]?[b]:e.slice(0,e.length-1);b=a=e.concat(a.split("/"));for(m=0;b[m];m+=1)if(k=b[m],k===".")b.splice(m,1),m-=
1;else if(k==="..")if(m===1&&(b[2]===".."||b[0]===".."))break;else m>0&&(b.splice(m-1,2),m-=2);m=F.pkgs[b=a[0]];a=a.join("/");m&&a===b+"/"+m.main&&(a=b)}else a.indexOf("./")===0&&(a=a.substring(2));if(c&&(e||g)&&f){b=a.split("/");for(m=b.length;m>0;m-=1){j=b.slice(0,m).join("/");if(e)for(k=e.length;k>0;k-=1)if(c=f[e.slice(0,k).join("/")])if(c=c[j]){p=c;break}!p&&g&&g[j]&&(p=g[j]);if(p){b.splice(0,m,p);a=b.join("/");break}}}return a}function c(a){D&&b(document.getElementsByTagName("script"),function(b){if(b.getAttribute("data-requiremodule")===
a&&b.getAttribute("data-requirecontext")===I.contextName)return b.parentNode.removeChild(b),!0})}function e(a){var b=F.paths[a];if(b&&g(b)&&b.length>1)return c(a),b.shift(),I.undef(a),I.require([a]),!0}function p(a,b,c,e){var f=a?a.indexOf("!"):-1,g=null,m=b?b.name:null,k=a,j=!0,n="",q,o;a||(j=!1,a="_@r"+(sa+=1));f!==-1&&(g=a.substring(0,f),a=a.substring(f+1,a.length));g&&(g=d(g,m,e),o=T[g]);a&&(g?n=o&&o.normalize?o.normalize(a,function(a){return d(a,m,e)}):d(a,m,e):(n=d(a,m,e),q=I.nameToUrl(a,null,
b)));a=g&&!o&&!c?"_unnormalized"+(Ca+=1):"";return{prefix:g,name:n,parentMap:b,unnormalized:!!a,url:q,originalName:k,isDefine:j,id:(g?g+"!"+n:n)+a}}function q(a){var b=a.id,d=B[b];d||(d=B[b]=new I.Module(a));return d}function s(a,b,d){var c=a.id,e=B[c];if(T.hasOwnProperty(c)&&(!e||e.defineEmitComplete))b==="defined"&&d(T[c]);else q(a).on(b,d)}function C(a,d){var c=a.requireModules,e=!1;if(d)d(a);else if(b(c,function(b){if(b=B[b])b.error=a,b.events.error&&(e=!0,b.emit("error",a))}),!e)J.onError(a)}
function E(){V.length&&(v.apply(ba,[ba.length-1,0].concat(V)),V=[])}function t(a,b,d){a=a&&a.map;b=r(d||I.require,a,b);u(b,I,a);b.isBrowser=D;return b}function K(a){delete B[a];b(fa,function(b,d){if(b.map.id===a)return fa.splice(d,1),b.defined||(I.waitCount-=1),!0})}function G(a,d){var c=a.map.id,e=a.depMaps,g;if(a.inited){if(d[c])return a;d[c]=!0;b(e,function(a){if(a=B[a.id])return!a.inited||!a.enabled?(g=null,delete d[c],!0):g=G(a,n({},d))});return g}}function z(a,d,c){var e=a.map.id,g=a.depMaps;
if(a.inited&&a.map.isDefine){if(d[e])return T[e];d[e]=a;b(g,function(b){var b=b.id,g=B[b];!ga[b]&&g&&(!g.inited||!g.enabled?c[e]=!0:(g=z(g,d,c),c[b]||a.defineDepById(b,g)))});a.check(!0);return T[e]}}function x(a){a.check()}function M(){var a=F.waitSeconds*1E3,d=a&&I.startTime+a<(new Date).getTime(),g=[],f=!1,j=!0,p,n,q;if(!pa){pa=!0;k(B,function(a){p=a.map;n=p.id;if(a.enabled&&!a.error)if(!a.inited&&d)e(n)?f=q=!0:(g.push(n),c(n));else if(!a.inited&&a.fetched&&p.isDefine&&(f=!0,!p.prefix))return j=
!1});if(d&&g.length)return a=m("timeout","Load timeout for modules: "+g,null,g),a.contextName=I.contextName,C(a);j&&(b(fa,function(a){if(!a.defined){var a=G(a,{}),b={};a&&(z(a,b,{}),k(b,x))}}),k(B,x));if((!d||q)&&f)if((D||Q)&&!la)la=setTimeout(function(){la=0;M()},50);pa=!1}}function P(a){q(p(a[0],null,!0)).init(a[1],a[2])}function R(a){var a=a.currentTarget||a.srcElement,b=I.onScriptLoad;a.detachEvent&&!S?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1);b=I.onScriptError;
a.detachEvent&&!S||a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}var F={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},B={},U={},ba=[],T={},ha={},sa=1,Ca=1,fa=[],pa,qa,I,ga,la;ga={require:function(a){return t(a)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports=T[a.map.id]={}},module:function(a){return a.module={id:a.map.id,uri:a.map.url,config:function(){return F.config&&F.config[a.map.id]||{}},exports:T[a.map.id]}}};qa=
function(a){this.events=U[a.id]||{};this.map=a;this.shim=F.shim[a.id];this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};qa.prototype={init:function(a,b,d,c){c=c||{};if(!this.inited){this.factory=b;if(d)this.on("error",d);else this.events.error&&(d=w(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.depMaps.rjsSkipMap=a.rjsSkipMap;this.errback=d;this.inited=!0;this.ignore=c.ignore;c.enabled||this.enabled?this.enable():this.check()}},defineDepById:function(a,
d){var c;b(this.depMaps,function(b,d){if(b.id===a)return c=d,!0});return this.defineDep(c,d)},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;I.startTime=(new Date).getTime();var a=this.map;if(this.shim)t(this,!0)(this.shim.deps||[],w(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;ha[a]||
(ha[a]=!0,I.load(this.map.id,a))},check:function(a){if(this.enabled&&!this.enabling){var b=this.map.id,d=this.depExports,c=this.exports,e=this.factory,g;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(j(e)){if(this.events.error)try{c=I.execCb(b,e,d,c)}catch(f){g=f}else c=I.execCb(b,e,d,c);if(this.map.isDefine)if((d=this.module)&&d.exports!==void 0&&d.exports!==this.exports)c=d.exports;else if(c===void 0&&this.usingExports)c=
this.exports;if(g)return g.requireMap=this.map,g.requireModules=[this.map.id],g.requireType="define",C(this.error=g)}else c=e;this.exports=c;if(this.map.isDefine&&!this.ignore&&(T[b]=c,J.onResourceLoad))J.onResourceLoad(I,this.map,this.depMaps);delete B[b];this.defined=!0;I.waitCount-=1;I.waitCount===0&&(fa=[])}this.defining=!1;if(!a&&this.defined&&!this.defineEmitted)this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0}}else this.fetch()}},callPlugin:function(){var a=
this.map,b=a.id,c=p(a.prefix,null,!1,!0);s(c,"defined",w(this,function(c){var e=this.map.name,g=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){if(c.normalize&&(e=c.normalize(e,function(a){return d(a,g,!0)})||""),c=p(a.prefix+"!"+e,this.map.parentMap,!1,!0),s(c,"defined",w(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),c=B[c.id]){if(this.events.error)c.on("error",w(this,function(a){this.emit("error",a)}));c.enable()}}else e=w(this,function(a){this.init([],
function(){return a},null,{enabled:!0})}),e.error=w(this,function(a){this.inited=!0;this.error=a;a.requireModules=[b];k(B,function(a){a.map.id.indexOf(b+"_unnormalized")===0&&K(a.map.id)});C(a)}),e.fromText=function(a,b){var d=Z;d&&(Z=!1);q(p(a));J.exec(b);d&&(Z=!0);I.completeLoad(a)},c.load(a.name,t(a.parentMap,!0,function(a,b){a.rjsSkipMap=!0;return I.require(a,b)}),e,F)}));I.enable(c,this);this.pluginMaps[c.id]=c},enable:function(){this.enabled=!0;if(!this.waitPushed)fa.push(this),I.waitCount+=
1,this.waitPushed=!0;this.enabling=!0;b(this.depMaps,w(this,function(a,b){var d,c;if(typeof a==="string"){a=p(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap);this.depMaps[b]=a;if(d=ga[a.id]){this.depExports[b]=d(this);return}this.depCount+=1;s(a,"defined",w(this,function(a){this.defineDep(b,a);this.check()}));this.errback&&s(a,"error",this.errback)}d=a.id;c=B[d];!ga[d]&&c&&!c.enabled&&I.enable(a,this)}));k(this.pluginMaps,w(this,function(a){var b=B[a.id];b&&!b.enabled&&
I.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,b){var d=this.events[a];d||(d=this.events[a]=[]);d.push(b)},emit:function(a,d){b(this.events[a],function(a){a(d)});a==="error"&&delete this.events[a]}};return I={config:F,contextName:a,registry:B,defined:T,urlFetched:ha,waitCount:0,defQueue:ba,Module:qa,makeModuleMap:p,configure:function(a){a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/");var d=F.pkgs,c=F.shim,e=F.paths,f=F.map;n(F,a,!0);F.paths=n(e,a.paths,!0);
if(a.map)F.map=n(f||{},a.map,!0,!0);if(a.shim)k(a.shim,function(a,b){g(a)&&(a={deps:a});if(a.exports&&!a.exports.__buildReady)a.exports=I.makeShimExports(a.exports);c[b]=a}),F.shim=c;if(a.packages)b(a.packages,function(a){a=typeof a==="string"?{name:a}:a;d[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(H,"").replace(y,"")}}),F.pkgs=d;k(B,function(a,b){a.map=p(b)});if(a.deps||a.callback)I.require(a.deps||[],a.callback)},makeShimExports:function(a){var b;return typeof a===
"string"?(b=function(){return o(a)},b.exports=a,b):function(){return a.apply(f,arguments)}},requireDefined:function(a,b){var d=p(a,b,!1,!0).id;return T.hasOwnProperty(d)},requireSpecified:function(a,b){a=p(a,b,!1,!0).id;return T.hasOwnProperty(a)||B.hasOwnProperty(a)},require:function(b,d,c,e){var g;if(typeof b==="string"){if(j(d))return C(m("requireargs","Invalid require call"),c);if(J.get)return J.get(I,b,d);b=p(b,d,!1,!0);b=b.id;return!T.hasOwnProperty(b)?C(m("notloaded",'Module name "'+b+'" has not been loaded yet for context: '+
a)):T[b]}c&&!j(c)&&(e=c,c=void 0);d&&!j(d)&&(e=d,d=void 0);for(E();ba.length;)if(g=ba.shift(),g[0]===null)return C(m("mismatch","Mismatched anonymous redhelper.define() module: "+g[g.length-1]));else P(g);q(p(null,e)).init(b,d,c,{enabled:!0});M();return I.require},undef:function(a){var b=p(a,null,!0),d=B[a];delete T[a];delete ha[b.url];delete U[a];if(d){if(d.events.defined)U[a]=d.events;K(a)}},enable:function(a){B[a.id]&&q(a).enable()},completeLoad:function(a){var b=F.shim[a]||{},d=b.exports&&b.exports.exports,
c,g;for(E();ba.length;){g=ba.shift();if(g[0]===null){g[0]=a;if(c)break;c=!0}else g[0]===a&&(c=!0);P(g)}g=B[a];if(!c&&!T[a]&&g&&!g.inited)if(F.enforceDefine&&(!d||!o(d)))if(e(a))return;else return C(m("nodefine","No define call for "+a,null,[a]));else P([a,b.deps||[],b.exports]);M()},toUrl:function(a,b){var d=a.lastIndexOf("."),c=null;d!==-1&&(c=a.substring(d,a.length),a=a.substring(0,d));return I.nameToUrl(a,c,b)},nameToUrl:function(a,b,c){var e,f,m,k,j,a=d(a,c&&c.id,!0);if(J.jsExtRegExp.test(a))b=
a+(b||"");else{e=F.paths;f=F.pkgs;c=a.split("/");for(k=c.length;k>0;k-=1)if(j=c.slice(0,k).join("/"),m=f[j],j=e[j]){g(j)&&(j=j[0]);c.splice(0,k,j);break}else if(m){a=a===m.name?m.location+"/"+m.main:m.location;c.splice(0,k,a);break}b=c.join("/")+(b||".js");b=(b.charAt(0)==="/"||b.match(/^[\w\+\.\-]+:/)?"":F.baseUrl)+b}return F.urlArgs?b+((b.indexOf("?")===-1?"?":"&")+F.urlArgs):b},load:function(a,b){J.load(I,a,b)},execCb:function(a,b,d,c){return b.apply(c,d)},onScriptLoad:function(a){if(a.type===
"load"||O.test((a.currentTarget||a.srcElement).readyState))Y=null,a=R(a),I.completeLoad(a.id)},onScriptError:function(a){var b=R(a);if(!e(b.id))return C(m("scripterror","Script error",a,[b.id]))}}}};J({});u(J);if(D&&(R=t.head=document.getElementsByTagName("head")[0],F=document.getElementsByTagName("base")[0]))R=t.head=F.parentNode;J.onError=function(a){throw a;};J.load=function(a,b,d){var c=a&&a.config||{},e;if(D)return e=c.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):
document.createElement("script"),e.type=c.scriptType||"text/javascript",e.charset="utf-8",e.setAttribute("data-requirecontext",a.contextName),e.setAttribute("data-requiremodule",b),e.attachEvent&&!(e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0)&&!S?(Z=!0,e.attachEvent("onreadystatechange",a.onScriptLoad)):(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)),e.src=d,x=e,F?R.insertBefore(e,F):R.appendChild(e),x=null,e;else Q&&(importScripts(d),
a.completeLoad(b))};D&&c(document.getElementsByTagName("script"),function(a){if(!R)R=a.parentNode;if(M=a.getAttribute("data-main")){U=M.split("/");C=U.pop();K=U.length?U.join("/")+"/":"./";if(!B.baseUrl)B.baseUrl=K;M=C.replace(y,"");B.deps=B.deps?B.deps.concat(M):[M];return!0}});d=function(a,b,d){var c,e;typeof a!=="string"&&(d=b,b=a,a=null);g(b)||(d=b,b=[]);!b.length&&j(d)&&d.length&&(d.toString().replace(q,"").replace(E,function(a,d){b.push(d)}),b=(d.length===1?["require"]:["require","exports",
"module"]).concat(b));if(Z&&(c=x||p()))a||(a=c.getAttribute("data-requiremodule")),e=P[c.getAttribute("data-requirecontext")];(e?e.defQueue:V).push([a,b,d])};d.amd={jQuery:!0};J.exec=function(a){return eval(a)};J(B)}})(this);redhelper.requirejs=a;redhelper.require=e;redhelper.define=d}})();redhelper.define("requireLib",function(){});
redhelper.define("config/setup",[],function(){var a={DEBUG:!1,SHOW_EVENTS:!1,SHOW_SESSION:!1,XMPP_DOMAIN:"xmpp.redhelper.ru",DATA_URL:location.protocol+"//dh7xgsr9ech2h.cloudfront.net",BOSH_SERVICE:location.protocol+"//"+location.host+"/http-bind/",NX_URL:location.protocol+"//redhelper.ru/nx/",CLIENT_NAME:location.href.split("?")[1].split("c=")[1].split("&")[0].split("#")[0],PARENT_URI:decodeURIComponent(location.href.split("#")[1]),PARENT_URL:decodeURIComponent(location.href.split("#")[1]).split("//")[0]+
"//"+decodeURIComponent(location.href.split("#")[1]).split("//")[1].split("/")[0],STANDALONE:location.href.indexOf("&standalone")!=-1,REQUIRE_OPERATOR:null,CURRENT_URL:"",CURRENT_TITLE:"",QUEUE_DELAY_COUNT:0};try{if(localStorage.getItem("rhlp.debug"))a.DEBUG=!0}catch(e){}a.empty=function(a){return typeof a=="undefined"||a===""||a!==a||a===null};Number.prototype.toVisitorJid=function(){return this+"@visitor."+a.XMPP_DOMAIN};String.prototype.toVisitorJid=function(){return this+"@visitor."+a.XMPP_DOMAIN};
String.prototype.toOperatorJid=function(){return this+"@operator."+a.XMPP_DOMAIN};String.prototype.extractNode=function(){var a=this.indexOf("@");return a>-1?this.slice(0,a):this};return a});
redhelper.define("common/extensions/debug",["config/setup"],function(a){return{log:function(e){a.DEBUG&&console&&console.log&&console.log(e)},eventLog:function(e){typeof a.SHOW_EVENTS!="undefined"&&a.SHOW_EVENTS&&console&&console.log&&console.log(e)},sessionLog:function(e){typeof a.SHOW_SESSION!="undefined"&&a.SHOW_SESSION&&console&&console.log&&console.log(e)},info:function(e){a.DEBUG&&console&&console.info&&console.info(e)},clear:function(){a.DEBUG&&console&&clear&&clear()},debug:function(e){a.DEBUG&&
console&&console.debug&&console.debug(e)},time:function(e){a.DEBUG&&console&&console.time&&console.time(e)},timeEnd:function(e){a.DEBUG&&console&&console.timeEnd&&console.timeEnd(e)},profile:function(){a.DEBUG&&console&&console.profile&&console.profile()},profileEnd:function(){a.DEBUG&&console&&console.profileEnd&&console.profileEnd()},error:function(e){a.DEBUG&&console&&console.trace&&console.trace();a.DEBUG&&console&&console.error&&console.error(e)},assert:function(e,d){a.DEBUG&&console&&console.assert&&
console.assert(e,d)}}});
redhelper.define("common/application/eventTarget",["config/setup","common/extensions/debug"],function(a,e){function d(a,d){this.message=d;this.name="Custom Event Exception";this.target=a}var f=function(a){this._types=[];this._listeners=[];this.targetName=a};f.prototype={addEventListener:function(f,g){if(a.empty(f))throw new d(this.targetName,"empty type");if(typeof g!="function")throw new d(this.targetName,"provided listener for event type "+f+" is not a function");var b=this._types.indexOf(f);b==
-1&&(this._types.push(f),b=this._types.indexOf(f));this._listeners[b]instanceof Array||(this._listeners[b]=[]);for(var c in this._listeners[b])if(c===g){e.eventLog("Listener already exists:\ntargetName="+this.targetName+", type="+f);return}this._listeners[b].push(g);e.eventLog("New event listener added:\ntargetName="+this.targetName+", type="+f)},removeAllEventListeners:function(a){var d=this._types.indexOf(a);d!=-1&&(this._listeners[d]=[],e.eventLog("All listeners were removed\ntargetName="+this.targetName+
", type="+a))},removeEventListener:function(a,d){var b=this._types.indexOf(a);if(b!=-1){var c=this._listeners[b].indexOf(d);c!=-1&&(this._listeners[b].splice(c,1),e.eventLog("One listener was removed\ntargetName="+this.targetName+", type="+a))}},fire:function(a,g){typeof a=="string"&&(a={type:a});if(!a.target)a.target=this;if(!a.type)throw new d(this.targetName,"Event missing 'type' property");if(typeof g=="object")for(var b in g)g.hasOwnProperty(b)&&(a[b]=g[b]);b=0;var c=this._types.indexOf(a.type);
if(c!=-1&&this._listeners[c])for(var c=this._listeners[c],f=c.length;b<f;b++)try{c[b].call(this,a)}catch(n){e.error(n)}g&&!g.isMessageTarget&&e.eventLog("Event was fired, "+b+" listeners was called:\ntargetName="+this.targetName+", type="+a.type)}};return f});redhelper.define("application/dispatcher",["common/application/eventTarget"],function(a){return new a("Chat")});
if(!("bind"in Function.prototype))Function.prototype.bind=function(a){var e=this;if(arguments.length<=1)return function(){return e.apply(a,arguments)};else{var d=Array.prototype.slice.call(arguments,1);return function(){return e.apply(a,arguments.length===0?d:d.concat(Array.prototype.slice.call(arguments)))}}};if(!("trim"in String.prototype))String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};
if(!("indexOf"in Array.prototype))Array.prototype.indexOf=function(a,e){e===void 0&&(e=0);e<0&&(e+=this.length);e<0&&(e=0);for(var d=this.length;e<d;e++)if(e in this&&this[e]===a)return e;return-1};if(!("lastIndexOf"in Array.prototype))Array.prototype.lastIndexOf=function(a,e){e===void 0&&(e=this.length-1);e<0&&(e+=this.length);e>this.length-1&&(e=this.length-1);for(e++;e-- >0;)if(e in this&&this[e]===a)return e;return-1};
if(!("forEach"in Array.prototype))Array.prototype.forEach=function(a,e){for(var d=0,f=this.length;d<f;d++)d in this&&a.call(e,this[d],d,this)};if(!("map"in Array.prototype))Array.prototype.map=function(a,e){for(var d=Array(this.length),f=0,j=this.length;f<j;f++)f in this&&(d[f]=a.call(e,this[f],f,this));return d};if(!("filter"in Array.prototype))Array.prototype.filter=function(a,e){for(var d=[],f,j=0,g=this.length;j<g;j++)j in this&&a.call(e,f=this[j],j,this)&&d.push(f);return d};
if(!("every"in Array.prototype))Array.prototype.every=function(a,e){for(var d=0,f=this.length;d<f;d++)if(d in this&&!a.call(e,this[d],d,this))return!1;return!0};if(!("some"in Array.prototype))Array.prototype.some=function(a,e){for(var d=0,f=this.length;d<f;d++)if(d in this&&a.call(e,this[d],d,this))return!0;return!1};
if(typeof Element!="undefined"&&!Element.prototype.addEventListener){var oListeners={},runListeners=function(a){if(!a)a=window.event;for(var e=0,d=0,f=oListeners[a.type];d<f.aEls.length;d++)if(f.aEls[d]===this){for(;e<f.aEvts[d].length;e++)f.aEvts[d][e].call(this,a);break}};Element.prototype.addEventListener=function(a,e){if(oListeners.hasOwnProperty(a)){for(var d=oListeners[a],f=-1,j=0;j<d.aEls.length;j++)if(d.aEls[j]===this){f=j;break}if(f===-1)d.aEls.push(this),d.aEvts.push([e]),this["on"+a]=runListeners;
else{d=d.aEvts[f];this["on"+a]!==runListeners&&(d.splice(0),this["on"+a]=runListeners);for(f=0;f<d.length;f++)if(d[f]===e)return;d.push(e)}}else oListeners[a]={aEls:[this],aEvts:[[e]]},this["on"+a]=runListeners};Element.prototype.removeEventListener=function(a,e){if(oListeners.hasOwnProperty(a)){for(var d=oListeners[a],f=-1,j=0;j<d.aEls.length;j++)if(d.aEls[j]===this){f=j;break}if(f!==-1){j=0;for(d=d.aEvts[f];j<d.length;j++)d[j]===e&&d.splice(j,1)}}}}
if(!window.addEventListener&&window.attachEvent)window.addEventListener=function(a,e){window.attachEvent("on"+a,e)};if(JSON&&typeof JSON.stringify!="function")JSON.stringify=JSON.encode;if(JSON&&typeof JSON.parse!="function")JSON.parse=JSON.decode;window.rhlpSetInterval=function(a,e){var d=function(){try{a()}catch(f){}setTimeout(d,e)};d()};redhelper.define("common/extensions/compatibility",function(){});
redhelper.define("common/extensions/jquery",["common/extensions/compatibility"],function(){var a;(function(e,d){function f(a){var l=B[a]={},b,d,a=a.split(/\s+/);for(b=0,d=a.length;b<d;b++)l[a[b]]=!0;return l}function j(h,l,b){if(b===d&&h.nodeType===1)if(b="data-"+l.replace(J,"-$1").toLowerCase(),b=h.getAttribute(b),typeof b==="string"){try{b=b==="true"?!0:b==="false"?!1:b==="null"?null:a.isNumeric(b)?+b:Z.test(b)?a.parseJSON(b):b}catch(N){}a.data(h,l,b)}else b=d;return b}function g(h){for(var l in h)if(!(l===
"data"&&a.isEmptyObject(h[l]))&&l!=="toJSON")return!1;return!0}function b(h,l,b){var d=l+"defer",c=l+"queue",e=l+"mark",g=a._data(h,d);g&&(b==="queue"||!a._data(h,c))&&(b==="mark"||!a._data(h,e))&&setTimeout(function(){!a._data(h,c)&&!a._data(h,e)&&(a.removeData(h,d,!0),g.fire())},0)}function c(){return!1}function k(){return!0}function n(h,l,b){l=l||0;if(a.isFunction(l))return a.grep(h,function(a,h){return!!l.call(a,h,a)===b});else if(l.nodeType)return a.grep(h,function(a){return a===l===b});else if(typeof l===
"string"){var d=a.grep(h,function(a){return a.nodeType===1});if(nb.test(l))return a.filter(l,d,!b);else l=a.filter(l,d)}return a.grep(h,function(h){return a.inArray(h,l)>=0===b})}function w(a){var l=La.split("|"),a=a.createDocumentFragment();if(a.createElement)for(;l.length;)a.createElement(l.pop());return a}function o(h,l){if(l.nodeType===1&&a.hasData(h)){var b,d,c;d=a._data(h);var e=a._data(l,d),g=d.events;if(g)for(b in delete e.handle,e.events={},g)for(d=0,c=g[b].length;d<c;d++)a.event.add(l,b,
g[b][d]);if(e.data)e.data=a.extend({},e.data)}}function r(h,l){var b;if(l.nodeType===1){l.clearAttributes&&l.clearAttributes();l.mergeAttributes&&l.mergeAttributes(h);b=l.nodeName.toLowerCase();if(b==="object")l.outerHTML=h.outerHTML;else if(b==="input"&&(h.type==="checkbox"||h.type==="radio")){if(h.checked)l.defaultChecked=l.checked=h.checked;if(l.value!==h.value)l.value=h.value}else if(b==="option")l.selected=h.defaultSelected;else if(b==="input"||b==="textarea")l.defaultValue=h.defaultValue;else if(b===
"script"&&l.text!==h.text)l.text=h.text;l.removeAttribute(a.expando);l.removeAttribute("_submit_attached");l.removeAttribute("_change_attached")}}function u(a){return typeof a.getElementsByTagName!=="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!=="undefined"?a.querySelectorAll("*"):[]}function m(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function p(h){var l=(h.nodeName||"").toLowerCase();l==="input"?m(h):l!=="script"&&typeof h.getElementsByTagName!==
"undefined"&&a.grep(h.getElementsByTagName("input"),m)}function q(h,l,b){var d=l==="width"?h.offsetWidth:h.offsetHeight,c=l==="width"?1:0;if(d>0){if(b!=="border")for(;c<4;c+=2)b||(d-=parseFloat(a.css(h,"padding"+ea[c]))||0),b==="margin"?d+=parseFloat(a.css(h,b+ea[c]))||0:d-=parseFloat(a.css(h,"border"+ea[c]+"Width"))||0;return d+"px"}d=ka(h,l);if(d<0||d==null)d=h.style[l];if(Ba.test(d))return d;d=parseFloat(d)||0;if(b)for(;c<4;c+=2)d+=parseFloat(a.css(h,"padding"+ea[c]))||0,b!=="padding"&&(d+=parseFloat(a.css(h,
"border"+ea[c]+"Width"))||0),b==="margin"&&(d+=parseFloat(a.css(h,b+ea[c]))||0);return d+"px"}function E(h){return function(l,b){var A;typeof l!=="string"&&(b=l,l="*");if(a.isFunction(b))for(var d=l.toLowerCase().split(Ma),c=0,e=d.length,g,f;c<e;c++)g=d[c],(f=/^\+/.test(g))&&(g=g.substr(1)||"*"),A=h[g]=h[g]||[],g=A,g[f?"unshift":"push"](b)}}function y(a,l,b,c,e,g){e=e||l.dataTypes[0];g=g||{};g[e]=!0;for(var e=a[e],f=0,m=e?e.length:0,k=a===Da,j;f<m&&(k||!j);f++)j=e[f](l,b,c),typeof j==="string"&&(!k||
g[j]?j=d:(l.dataTypes.unshift(j),j=y(a,l,b,c,j,g)));if((k||!j)&&!g["*"])j=y(a,l,b,c,"*",g);return j}function H(h,l){var b,c,e=a.ajaxSettings.flatOptions||{};for(b in l)l[b]!==d&&((e[b]?h:c||(c={}))[b]=l[b]);c&&a.extend(!0,h,c)}function z(h,l,b,d){if(a.isArray(l))a.each(l,function(a,l){b||pb.test(h)?d(h,l):z(h+"["+(typeof l==="object"?a:"")+"]",l,b,d)});else if(!b&&a.type(l)==="object")for(var c in l)z(h+"["+c+"]",l[c],b,d);else d(h,l)}function t(){try{return new e.XMLHttpRequest}catch(a){}}function G(){setTimeout(v,
0);return ta=a.now()}function v(){ta=d}function D(h,l){var b={};a.each(ua.concat.apply([],ua.slice(0,l)),function(){b[this]=h});return b}function Q(h){if(!Ea[h]){var l=s.body,b=a("<"+h+">").appendTo(l),d=b.css("display");b.remove();if(d==="none"||d===""){if(!$)$=s.createElement("iframe"),$.frameBorder=$.width=$.height=0;l.appendChild($);if(!ma||!$.createElement)ma=($.contentWindow||$.contentDocument).document,ma.write((a.support.boxModel?"<!doctype html>":"")+"<html><body>"),ma.close();b=ma.createElement(h);
ma.body.appendChild(b);d=a.css(b,"display");l.removeChild($)}Ea[h]=d}return Ea[h]}function O(h){return a.isWindow(h)?h:h.nodeType===9?h.defaultView||h.parentWindow:!1}var s=e.document,S=e.navigator,P=e.location;a=function(){function a(){if(!l.isReady){try{s.documentElement.doScroll("left")}catch(b){setTimeout(a,1);return}l.ready()}}var l=function(a,h){return new l.fn.init(a,h,g)},b=e.jQuery,c=e.$,g,f=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,m=/\S/,k=/^\s+/,j=/\s+$/,p=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,
n=/^[\],:{}\s]*$/,q=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,u=/(webkit)[ \/]([\w.]+)/,w=/(opera)(?:.*version)?[ \/]([\w.]+)/,C=/(msie) ([\w.]+)/,E=/(mozilla)(?:.*? rv:([\w.]+))?/,y=/-([a-z]|[0-9])/ig,t=/^-ms-/,K=function(a,h){return(h+"").toUpperCase()},v=S.userAgent,va,na,qb=Object.prototype.toString,Fa=Object.prototype.hasOwnProperty,Ga=Array.prototype.push,ra=Array.prototype.slice,O=String.prototype.trim,
Na=Array.prototype.indexOf,L={};l.fn=l.prototype={constructor:l,init:function(a,h,b){var c;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!h&&s.body)return this.context=s,this[0]=s.body,this.selector=a,this.length=1,this;if(typeof a==="string")if((c=a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?[null,a,null]:f.exec(a))&&(c[1]||!h))if(c[1])return b=(h=h instanceof l?h[0]:h)?h.ownerDocument||h:s,(a=p.exec(a))?l.isPlainObject(h)?(a=[s.createElement(a[1])],
l.fn.attr.call(a,h,!0)):a=[b.createElement(a[1])]:(a=l.buildFragment([c[1]],[b]),a=(a.cacheable?l.clone(a.fragment):a.fragment).childNodes),l.merge(this,a);else{if((h=s.getElementById(c[2]))&&h.parentNode){if(h.id!==c[2])return b.find(a);this.length=1;this[0]=h}this.context=s;this.selector=a;return this}else return!h||h.jquery?(h||b).find(a):this.constructor(h).find(a);else if(l.isFunction(a))return b.ready(a);if(a.selector!==d)this.selector=a.selector,this.context=a.context;return l.makeArray(a,
this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return ra.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,h,b){var d=this.constructor();l.isArray(a)?Ga.apply(d,a):l.merge(d,a);d.prevObject=this;d.context=this.context;if(h==="find")d.selector=this.selector+(this.selector?" ":"")+b;else if(h)d.selector=this.selector+"."+h+"("+b+")";return d},each:function(a,h){return l.each(this,a,h)},
ready:function(a){l.bindReady();va.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(ra.apply(this,arguments),"slice",ra.call(arguments).join(","))},map:function(a){return this.pushStack(l.map(this,function(h,l){return a.call(h,l,h)}))},end:function(){return this.prevObject||this.constructor(null)},push:Ga,sort:[].sort,splice:[].splice};l.fn.init.prototype=
l.fn;l.extend=l.fn.extend=function(){var a,h,b,c,A,e=arguments[0]||{},N=1,g=arguments.length,f=!1;typeof e==="boolean"&&(f=e,e=arguments[1]||{},N=2);typeof e!=="object"&&!l.isFunction(e)&&(e={});g===N&&(e=this,--N);for(;N<g;N++)if((a=arguments[N])!=null)for(h in a)b=e[h],c=a[h],e!==c&&(f&&c&&(l.isPlainObject(c)||(A=l.isArray(c)))?(A?(A=!1,b=b&&l.isArray(b)?b:[]):b=b&&l.isPlainObject(b)?b:{},e[h]=l.extend(f,b,c)):c!==d&&(e[h]=c));return e};l.extend({noConflict:function(a){if(e.$===l)e.$=c;if(a&&e.jQuery===
l)e.jQuery=b;return l},isReady:!1,readyWait:1,holdReady:function(a){a?l.readyWait++:l.ready(!0)},ready:function(a){if(a===!0&&!--l.readyWait||a!==!0&&!l.isReady){if(!s.body)return setTimeout(l.ready,1);l.isReady=!0;a!==!0&&--l.readyWait>0||(va.fireWith(s,[l]),l.fn.trigger&&l(s).trigger("ready").off("ready"))}},bindReady:function(){if(!va){va=l.Callbacks("once memory");if(s.readyState==="complete")return setTimeout(l.ready,1);if(s.addEventListener)s.addEventListener("DOMContentLoaded",na,!1),e.addEventListener("load",
l.ready,!1);else if(s.attachEvent){s.attachEvent("onreadystatechange",na);e.attachEvent("onload",l.ready);var b=!1;try{b=e.frameElement==null}catch(d){}s.documentElement.doScroll&&b&&a()}}},isFunction:function(a){return l.type(a)==="function"},isArray:Array.isArray||function(a){return l.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):L[qb.call(a)]||"object"},isPlainObject:function(a){if(!a||
l.type(a)!=="object"||a.nodeType||l.isWindow(a))return!1;try{if(a.constructor&&!Fa.call(a,"constructor")&&!Fa.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(h){return!1}for(var b in a);return b===d||Fa.call(a,b)},isEmptyObject:function(a){for(var h in a)return!1;return!0},error:function(a){throw Error(a);},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=l.trim(a);if(e.JSON&&e.JSON.parse)return e.JSON.parse(a);if(n.test(a.replace(q,"@").replace(o,"]").replace(r,"")))return(new Function("return "+
a))();l.error("Invalid JSON: "+a)},parseXML:function(a){if(typeof a!=="string"||!a)return null;var h,b;try{e.DOMParser?(b=new DOMParser,h=b.parseFromString(a,"text/xml")):(h=new ActiveXObject("Microsoft.XMLDOM"),h.async="false",h.loadXML(a))}catch(c){h=d}(!h||!h.documentElement||h.getElementsByTagName("parsererror").length)&&l.error("Invalid XML: "+a);return h},noop:function(){},globalEval:function(a){a&&m.test(a)&&(e.execScript||function(a){e.eval.call(e,a)})(a)},camelCase:function(a){return a.replace(t,
"ms-").replace(y,K)},nodeName:function(a,h){return a.nodeName&&a.nodeName.toUpperCase()===h.toUpperCase()},each:function(a,h,b){var c,A=0,e=a.length,N=e===d||l.isFunction(a);if(b)if(N)for(c in a){if(h.apply(a[c],b)===!1)break}else for(;A<e;){if(h.apply(a[A++],b)===!1)break}else if(N)for(c in a){if(h.call(a[c],c,a[c])===!1)break}else for(;A<e;)if(h.call(a[A],A,a[A++])===!1)break;return a},trim:O?function(a){return a==null?"":O.call(a)}:function(a){return a==null?"":a.toString().replace(k,"").replace(j,
"")},makeArray:function(a,h){var b=h||[];if(a!=null){var d=l.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||l.isWindow(a)?Ga.call(b,a):l.merge(b,a)}return b},inArray:function(a,h,l){var b;if(h){if(Na)return Na.call(h,a,l);b=h.length;for(l=l?l<0?Math.max(0,b+l):l:0;l<b;l++)if(l in h&&h[l]===a)return l}return-1},merge:function(a,h){var l=a.length,b=0;if(typeof h.length==="number")for(var c=h.length;b<c;b++)a[l++]=h[b];else for(;h[b]!==d;)a[l++]=h[b++];a.length=l;return a},grep:function(a,
h,l){for(var b=[],d,l=!!l,c=0,A=a.length;c<A;c++)d=!!h(a[c],c),l!==d&&b.push(a[c]);return b},map:function(a,h,b){var c,A,e=[],N=0,g=a.length;if(a instanceof l||g!==d&&typeof g==="number"&&(g>0&&a[0]&&a[g-1]||g===0||l.isArray(a)))for(;N<g;N++)c=h(a[N],N,b),c!=null&&(e[e.length]=c);else for(A in a)c=h(a[A],A,b),c!=null&&(e[e.length]=c);return e.concat.apply([],e)},guid:1,proxy:function(a,h){if(typeof h==="string")var b=a[h],h=a,a=b;if(!l.isFunction(a))return d;var c=ra.call(arguments,2),b=function(){return a.apply(h,
c.concat(ra.call(arguments)))};b.guid=a.guid=a.guid||b.guid||l.guid++;return b},access:function(a,h,b,c,A,e,N){var g,f=b==null,ca=0,m=a.length;if(b&&typeof b==="object"){for(ca in b)l.access(a,h,ca,b[ca],1,e,c);A=1}else if(c!==d){g=N===d&&l.isFunction(c);f&&(g?(g=h,h=function(a,h,b){return g.call(l(a),b)}):(h.call(a,c),h=null));if(h)for(;ca<m;ca++)h(a[ca],b,g?c.call(a[ca],ca,h(a[ca],b)):c,N);A=1}return A?a:f?h.call(a):m?h(a[0],b):e},now:function(){return(new Date).getTime()},uaMatch:function(a){a=
a.toLowerCase();a=u.exec(a)||w.exec(a)||C.exec(a)||a.indexOf("compatible")<0&&E.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(h,l){return new a.fn.init(h,l)}l.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(b,d){d&&d instanceof l&&!(d instanceof a)&&(d=a(d));return l.fn.init.call(this,b,d,h)};a.fn.init.prototype=a.fn;var h=a(s);return a},browser:{}});l.each("Boolean Number String Function Array Date RegExp Object".split(" "),
function(a,h){L["[object "+h+"]"]=h.toLowerCase()});v=l.uaMatch(v);if(v.browser)l.browser[v.browser]=!0,l.browser.version=v.version;if(l.browser.webkit)l.browser.safari=!0;m.test("\u00a0")&&(k=/^[\s\xA0]+/,j=/[\s\xA0]+$/);g=l(s);s.addEventListener?na=function(){s.removeEventListener("DOMContentLoaded",na,!1);l.ready()}:s.attachEvent&&(na=function(){s.readyState==="complete"&&(s.detachEvent("onreadystatechange",na),l.ready())});return l}();var B={};a.Callbacks=function(h){var h=h?B[h]||f(h):{},l=[],
b=[],c,e,g,m,k,j,p=function(b){var d,c,A,e;for(d=0,c=b.length;d<c;d++)A=b[d],e=a.type(A),e==="array"?p(A):e==="function"&&(!h.unique||!q.has(A))&&l.push(A)},n=function(a,d){d=d||[];c=!h.memory||[a,d];g=e=!0;j=m||0;m=0;for(k=l.length;l&&j<k;j++)if(l[j].apply(a,d)===!1&&h.stopOnFalse){c=!0;break}g=!1;l&&(h.once?c===!0?q.disable():l=[]:b&&b.length&&(c=b.shift(),q.fireWith(c[0],c[1])))},q={add:function(){if(l){var a=l.length;p(arguments);g?k=l.length:c&&c!==!0&&(m=a,n(c[0],c[1]))}return this},remove:function(){if(l)for(var a=
arguments,b=0,d=a.length;b<d;b++)for(var c=0;c<l.length;c++)if(a[b]===l[c]&&(g&&c<=k&&(k--,c<=j&&j--),l.splice(c--,1),h.unique))break;return this},has:function(a){if(l)for(var h=0,b=l.length;h<b;h++)if(a===l[h])return!0;return!1},empty:function(){l=[];return this},disable:function(){l=b=c=d;return this},disabled:function(){return!l},lock:function(){b=d;(!c||c===!0)&&q.disable();return this},locked:function(){return!b},fireWith:function(a,l){b&&(g?h.once||b.push([a,l]):(!h.once||!c)&&n(a,l));return this},
fire:function(){q.fireWith(this,arguments);return this},fired:function(){return!!e}};return q};var V=[].slice;a.extend({Deferred:function(h){var l=a.Callbacks("once memory"),b=a.Callbacks("once memory"),d=a.Callbacks("memory"),c="pending",e={resolve:l,reject:b,notify:d},g={done:l.add,fail:b.add,progress:d.add,state:function(){return c},isResolved:l.fired,isRejected:b.fired,then:function(a,h,l){f.done(a).fail(h).progress(l);return this},always:function(){f.done.apply(f,arguments).fail.apply(f,arguments);
return this},pipe:function(h,l,b){return a.Deferred(function(d){a.each({done:[h,"resolve"],fail:[l,"reject"],progress:[b,"notify"]},function(h,l){var b=l[0],c=l[1],A;if(a.isFunction(b))f[h](function(){if((A=b.apply(this,arguments))&&a.isFunction(A.promise))A.promise().then(d.resolve,d.reject,d.notify);else d[c+"With"](this===f?d:this,[A])});else f[h](d[c])})}).promise()},promise:function(a){if(a==null)a=g;else for(var h in g)a[h]=g[h];return a}},f=g.promise({}),m;for(m in e)f[m]=e[m].fire,f[m+"With"]=
e[m].fireWith;f.done(function(){c="resolved"},b.disable,d.lock).fail(function(){c="rejected"},l.disable,d.lock);h&&h.call(f,f);return f},when:function(h){function l(a){return function(h){d[a]=arguments.length>1?V.call(arguments,0):h;--f||m.resolveWith(m,d)}}function b(a){return function(h){g[a]=arguments.length>1?V.call(arguments,0):h;m.notifyWith(k,g)}}var d=V.call(arguments,0),c=0,e=d.length,g=Array(e),f=e,m=e<=1&&h&&a.isFunction(h.promise)?h:a.Deferred(),k=m.promise();if(e>1){for(;c<e;c++)d[c]&&
d[c].promise&&a.isFunction(d[c].promise)?d[c].promise().then(l(c),m.reject,b(c)):--f;f||m.resolveWith(m,d)}else m!==h&&m.resolveWith(m,e?[h]:[]);return k}});a.support=function(){var h,l,b,d,c,g,f,m,k=s.createElement("div");k.setAttribute("className","t");k.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";l=k.getElementsByTagName("*");b=k.getElementsByTagName("a")[0];if(!l||!l.length||!b)return{};d=s.createElement("select");c=d.appendChild(s.createElement("option"));
l=k.getElementsByTagName("input")[0];h={leadingWhitespace:k.firstChild.nodeType===3,tbody:!k.getElementsByTagName("tbody").length,htmlSerialize:!!k.getElementsByTagName("link").length,style:/top/.test(b.getAttribute("style")),hrefNormalized:b.getAttribute("href")==="/a",opacity:/^0.55/.test(b.style.opacity),cssFloat:!!b.style.cssFloat,checkOn:l.value==="on",optSelected:c.selected,getSetAttribute:k.className!=="t",enctype:!!s.createElement("form").enctype,html5Clone:s.createElement("nav").cloneNode(!0).outerHTML!==
"<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0};a.boxModel=h.boxModel=s.compatMode==="CSS1Compat";l.checked=!0;h.noCloneChecked=l.cloneNode(!0).checked;d.disabled=!0;h.optDisabled=!c.disabled;try{delete k.test}catch(j){h.deleteExpando=!1}!k.addEventListener&&k.attachEvent&&k.fireEvent&&(k.attachEvent("onclick",function(){h.noCloneEvent=!1}),k.cloneNode(!0).fireEvent("onclick"));
l=s.createElement("input");l.value="t";l.setAttribute("type","radio");h.radioValue=l.value==="t";l.setAttribute("checked","checked");l.setAttribute("name","t");k.appendChild(l);b=s.createDocumentFragment();b.appendChild(k.lastChild);h.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked;h.appendChecked=l.checked;b.removeChild(l);b.appendChild(k);if(k.attachEvent)for(f in{submit:1,change:1,focusin:1})l="on"+f,m=l in k,m||(k.setAttribute(l,"return;"),m=typeof k[l]==="function"),h[f+"Bubbles"]=
m;b.removeChild(k);b=d=c=k=l=null;a(function(){var l,b,d,c,A=s.getElementsByTagName("body")[0];if(A){l=s.createElement("div");l.style.cssText="padding:0;margin:0;border:0;visibility:hidden;width:0;height:0;position:static;top:0;margin-top:1px";A.insertBefore(l,A.firstChild);k=s.createElement("div");l.appendChild(k);k.innerHTML="<table><tr><td style='padding:0;margin:0;border:0;display:none'></td><td>t</td></tr></table>";g=k.getElementsByTagName("td");m=g[0].offsetHeight===0;g[0].style.display="";
g[1].style.display="none";h.reliableHiddenOffsets=m&&g[0].offsetHeight===0;if(e.getComputedStyle)k.innerHTML="",b=s.createElement("div"),b.style.width="0",b.style.marginRight="0",k.style.width="2px",k.appendChild(b),h.reliableMarginRight=(parseInt((e.getComputedStyle(b,null)||{marginRight:0}).marginRight,10)||0)===0;if(typeof k.style.zoom!=="undefined")k.innerHTML="",k.style.width=k.style.padding="1px",k.style.border=0,k.style.overflow="hidden",k.style.display="inline",k.style.zoom=1,h.inlineBlockNeedsLayout=
k.offsetWidth===3,k.style.display="block",k.style.overflow="visible",k.innerHTML="<div style='width:5px;'></div>",h.shrinkWrapBlocks=k.offsetWidth!==3;k.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:0;visibility:hidden;";k.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
b=k.firstChild;d=b.firstChild;c={doesNotAddBorder:d.offsetTop!==5,doesAddBorderForTableAndCells:b.nextSibling.firstChild.firstChild.offsetTop===5};d.style.position="fixed";d.style.top="20px";c.fixedPosition=d.offsetTop===20||d.offsetTop===15;d.style.position=d.style.top="";b.style.overflow="hidden";b.style.position="relative";c.subtractsBorderForOverflowNotVisible=d.offsetTop===-5;c.doesNotIncludeMarginInBodyOffset=A.offsetTop!==1;if(e.getComputedStyle)k.style.marginTop="1%",h.pixelMargin=(e.getComputedStyle(k,
null)||{marginTop:0}).marginTop!=="1%";if(typeof l.style.zoom!=="undefined")l.style.zoom=1;A.removeChild(l);k=null;a.extend(h,c)}});return h}();var Z=/^(?:\{.*\}|\[.*\])$/,J=/([A-Z])/g;a.extend({cache:{},uuid:0,expando:"jQuery"+(a.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(h){h=h.nodeType?a.cache[h[a.expando]]:h[a.expando];return!!h&&!g(h)},data:function(h,l,b,c){if(a.acceptData(h)){var e;e=a.expando;
var g=typeof l==="string",f=h.nodeType,k=f?a.cache:h,m=f?h[e]:h[e]&&e,j=l==="events";if(m&&k[m]&&(j||c||k[m].data)||!(g&&b===d)){m||(f?h[e]=m=++a.uuid:m=e);if(!k[m]&&(k[m]={},!f))k[m].toJSON=a.noop;if(typeof l==="object"||typeof l==="function")c?k[m]=a.extend(k[m],l):k[m].data=a.extend(k[m].data,l);e=h=k[m];if(!c){if(!h.data)h.data={};h=h.data}b!==d&&(h[a.camelCase(l)]=b);if(j&&!h[l])return e.events;g?(b=h[l],b==null&&(b=h[a.camelCase(l)])):b=h;return b}}},removeData:function(h,b,d){if(a.acceptData(h)){var c,
e,f,m=a.expando,k=h.nodeType,j=k?a.cache:h,p=k?h[m]:m;if(j[p]){if(b&&(c=d?j[p]:j[p].data)){a.isArray(b)||(b in c?b=[b]:(b=a.camelCase(b),b=b in c?[b]:b.split(" ")));for(e=0,f=b.length;e<f;e++)delete c[b[e]];if(!(d?g:a.isEmptyObject)(c))return}if(!d&&(delete j[p].data,!g(j[p])))return;a.support.deleteExpando||!j.setInterval?delete j[p]:j[p]=null;k&&(a.support.deleteExpando?delete h[m]:h.removeAttribute?h.removeAttribute(m):h[m]=null)}}},_data:function(h,b,d){return a.data(h,b,d,!0)},acceptData:function(h){if(h.nodeName){var b=
a.noData[h.nodeName.toLowerCase()];if(b)return!(b===!0||h.getAttribute("classid")!==b)}return!0}});a.fn.extend({data:function(h,b){var c,e,g,f,m,k=this[0],p=0,n=null;if(h===d){if(this.length&&(n=a.data(k),k.nodeType===1&&!a._data(k,"parsedAttrs"))){g=k.attributes;for(m=g.length;p<m;p++)f=g[p].name,f.indexOf("data-")===0&&(f=a.camelCase(f.substring(5)),j(k,f,n[f]));a._data(k,"parsedAttrs",!0)}return n}if(typeof h==="object")return this.each(function(){a.data(this,h)});c=h.split(".",2);c[1]=c[1]?"."+
c[1]:"";e=c[1]+"!";return a.access(this,function(b){if(b===d)return n=this.triggerHandler("getData"+e,[c[0]]),n===d&&k&&(n=a.data(k,h),n=j(k,h,n)),n===d&&c[1]?this.data(c[0]):n;c[1]=b;this.each(function(){var l=a(this);l.triggerHandler("setData"+e,c);a.data(this,h,b);l.triggerHandler("changeData"+e,c)})},null,b,arguments.length>1,null,!1)},removeData:function(h){return this.each(function(){a.removeData(this,h)})}});a.extend({_mark:function(h,b){h&&(b=(b||"fx")+"mark",a._data(h,b,(a._data(h,b)||0)+
1))},_unmark:function(h,l,c){h!==!0&&(c=l,l=h,h=!1);if(l){var c=c||"fx",d=c+"mark";(h=h?0:(a._data(l,d)||1)-1)?a._data(l,d,h):(a.removeData(l,d,!0),b(l,c,"mark"))}},queue:function(h,b,c){var d;if(h)return b=(b||"fx")+"queue",d=a._data(h,b),c&&(!d||a.isArray(c)?d=a._data(h,b,a.makeArray(c)):d.push(c)),d||[]},dequeue:function(h,l){var l=l||"fx",c=a.queue(h,l),d=c.shift(),e={};d==="inprogress"&&(d=c.shift());d&&(l==="fx"&&c.unshift("inprogress"),a._data(h,l+".run",e),d.call(h,function(){a.dequeue(h,
l)},e));c.length||(a.removeData(h,l+"queue "+l+".run",!0),b(h,l,"queue"))}});a.fn.extend({queue:function(h,b){var c=2;typeof h!=="string"&&(b=h,h="fx",c--);return arguments.length<c?a.queue(this[0],h):b===d?this:this.each(function(){var c=a.queue(this,h,b);h==="fx"&&c[0]!=="inprogress"&&a.dequeue(this,h)})},dequeue:function(h){return this.each(function(){a.dequeue(this,h)})},delay:function(h,b){h=a.fx?a.fx.speeds[h]||h:h;return this.queue(b||"fx",function(a,b){var l=setTimeout(a,h);b.stop=function(){clearTimeout(l)}})},
clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(h,b){function c(){--k||e.resolveWith(g,[g])}typeof h!=="string"&&(b=h,h=d);for(var h=h||"fx",e=a.Deferred(),g=this,f=g.length,k=1,m=h+"defer",j=h+"queue",p=h+"mark",n;f--;)if(n=a.data(g[f],m,d,!0)||(a.data(g[f],j,d,!0)||a.data(g[f],p,d,!0))&&a.data(g[f],m,a.Callbacks("once memory"),!0))k++,n.add(c);c();return e.promise(b)}});var R=/[\n\t\r]/g,F=/\s+/,M=/\r/g,U=/^(?:button|input)$/i,Y=/^(?:button|input|object|select|textarea)$/i,
x=/^a(?:rea)?$/i,C=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,K=a.support.getSetAttribute,L,da,X;a.fn.extend({attr:function(h,b){return a.access(this,a.attr,h,b,arguments.length>1)},removeAttr:function(h){return this.each(function(){a.removeAttr(this,h)})},prop:function(h,b){return a.access(this,a.prop,h,b,arguments.length>1)},removeProp:function(h){h=a.propFix[h]||h;return this.each(function(){try{this[h]=d,delete this[h]}catch(a){}})},
addClass:function(h){var b,c,d,e,g,f,k;if(a.isFunction(h))return this.each(function(b){a(this).addClass(h.call(this,b,this.className))});if(h&&typeof h==="string"){b=h.split(F);for(c=0,d=this.length;c<d;c++)if(e=this[c],e.nodeType===1)if(!e.className&&b.length===1)e.className=h;else{g=" "+e.className+" ";for(f=0,k=b.length;f<k;f++)~g.indexOf(" "+b[f]+" ")||(g+=b[f]+" ");e.className=a.trim(g)}}return this},removeClass:function(h){var b,c,e,g,f,k,m;if(a.isFunction(h))return this.each(function(b){a(this).removeClass(h.call(this,
b,this.className))});if(h&&typeof h==="string"||h===d){b=(h||"").split(F);for(c=0,e=this.length;c<e;c++)if(g=this[c],g.nodeType===1&&g.className)if(h){f=(" "+g.className+" ").replace(R," ");for(k=0,m=b.length;k<m;k++)f=f.replace(" "+b[k]+" "," ");g.className=a.trim(f)}else g.className=""}return this},toggleClass:function(h,b){var c=typeof h,d=typeof b==="boolean";return a.isFunction(h)?this.each(function(c){a(this).toggleClass(h.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string")for(var e,
g=0,f=a(this),k=b,m=h.split(F);e=m[g++];)k=d?k:!f.hasClass(e),f[k?"addClass":"removeClass"](e);else if(c==="undefined"||c==="boolean")this.className&&a._data(this,"__className__",this.className),this.className=this.className||h===!1?"":a._data(this,"__className__")||""})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(this[b].nodeType===1&&(" "+this[b].className+" ").replace(R," ").indexOf(a)>-1)return!0;return!1},val:function(h){var b,c,e,g=this[0];if(arguments.length)return e=
a.isFunction(h),this.each(function(c){var g=a(this);if(this.nodeType===1&&(c=e?h.call(this,c,g.val()):h,c==null?c="":typeof c==="number"?c+="":a.isArray(c)&&(c=a.map(c,function(a){return a==null?"":a+""})),b=a.valHooks[this.type]||a.valHooks[this.nodeName.toLowerCase()],!b||!("set"in b)||b.set(this,c,"value")===d))this.value=c});else if(g){if((b=a.valHooks[g.type]||a.valHooks[g.nodeName.toLowerCase()])&&"get"in b&&(c=b.get(g,"value"))!==d)return c;c=g.value;return typeof c==="string"?c.replace(M,
""):c==null?"":c}}});a.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(h){var b,c,d=h.selectedIndex,e=[],g=h.options,f=h.type==="select-one";if(d<0)return null;h=f?d:0;for(c=f?d+1:g.length;h<c;h++)if(b=g[h],b.selected&&(a.support.optDisabled?!b.disabled:b.getAttribute("disabled")===null)&&(!b.parentNode.disabled||!a.nodeName(b.parentNode,"optgroup"))){b=a(b).val();if(f)return b;e.push(b)}return f&&!e.length&&g.length?a(g[d]).val():
e},set:function(h,b){var c=a.makeArray(b);a(h).find("option").each(function(){this.selected=a.inArray(a(this).val(),c)>=0});if(!c.length)h.selectedIndex=-1;return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(h,b,c,e){var g,f,k=h.nodeType;if(h&&!(k===3||k===8||k===2)){if(e&&b in a.attrFn)return a(h)[b](c);if(typeof h.getAttribute==="undefined")return a.prop(h,b,c);if(e=k!==1||!a.isXMLDoc(h))b=b.toLowerCase(),f=a.attrHooks[b]||(C.test(b)?da:L);if(c!==
d)if(c===null)a.removeAttr(h,b);else return f&&"set"in f&&e&&(g=f.set(h,c,b))!==d?g:(h.setAttribute(b,""+c),c);else return f&&"get"in f&&e&&(g=f.get(h,b))!==null?g:(g=h.getAttribute(b),g===null?d:g)}},removeAttr:function(h,b){var c,d,e,g,f,k=0;if(b&&h.nodeType===1){d=b.toLowerCase().split(F);for(g=d.length;k<g;k++)if(e=d[k])c=a.propFix[e]||e,(f=C.test(e))||a.attr(h,e,""),h.removeAttribute(K?e:c),f&&c in h&&(h[c]=!1)}},attrHooks:{type:{set:function(h,b){if(U.test(h.nodeName)&&h.parentNode)a.error("type property can't be changed");
else if(!a.support.radioValue&&b==="radio"&&a.nodeName(h,"input")){var c=h.value;h.setAttribute("type",b);if(c)h.value=c;return b}}},value:{get:function(h,b){return L&&a.nodeName(h,"button")?L.get(h,b):b in h?h.value:null},set:function(h,b,c){if(L&&a.nodeName(h,"button"))return L.set(h,b,c);h.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",
frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(h,b,c){var e,g,f=h.nodeType;if(h&&!(f===3||f===8||f===2)){if(f!==1||!a.isXMLDoc(h))b=a.propFix[b]||b,g=a.propHooks[b];return c!==d?g&&"set"in g&&(e=g.set(h,c,b))!==d?e:h[b]=c:g&&"get"in g&&(e=g.get(h,b))!==null?e:h[b]}},propHooks:{tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex");return b&&b.specified?parseInt(b.value,10):Y.test(a.nodeName)||x.test(a.nodeName)&&a.href?0:d}}}});a.attrHooks.tabindex=a.propHooks.tabIndex;
da={get:function(h,b){var c,e=a.prop(h,b);return e===!0||typeof e!=="boolean"&&(c=h.getAttributeNode(b))&&c.nodeValue!==!1?b.toLowerCase():d},set:function(h,b,c){b===!1?a.removeAttr(h,c):(b=a.propFix[c]||c,b in h&&(h[b]=!0),h.setAttribute(c,c.toLowerCase()));return c}};if(!K)X={name:!0,id:!0,coords:!0},L=a.valHooks.button={get:function(a,b){var c;return(c=a.getAttributeNode(b))&&(X[b]?c.nodeValue!=="":c.specified)?c.nodeValue:d},set:function(a,b,c){var d=a.getAttributeNode(c);d||(d=s.createAttribute(c),
a.setAttributeNode(d));return d.nodeValue=b+""}},a.attrHooks.tabindex.set=L.set,a.each(["width","height"],function(h,b){a.attrHooks[b]=a.extend(a.attrHooks[b],{set:function(a,h){if(h==="")return a.setAttribute(b,"auto"),h}})}),a.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false");L.set(a,b,c)}};a.support.hrefNormalized||a.each(["href","src","width","height"],function(h,b){a.attrHooks[b]=a.extend(a.attrHooks[b],{get:function(a){a=a.getAttribute(b,2);return a===null?d:a}})});
if(!a.support.style)a.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||d},set:function(a,b){return a.style.cssText=""+b}};if(!a.support.optSelected)a.propHooks.selected=a.extend(a.propHooks.selected,{get:function(){return null}});if(!a.support.enctype)a.propFix.enctype="encoding";a.support.checkOn||a.each(["radio","checkbox"],function(){a.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}});a.each(["radio","checkbox"],function(){a.valHooks[this]=
a.extend(a.valHooks[this],{set:function(h,b){if(a.isArray(b))return h.checked=a.inArray(a(h).val(),b)>=0}})});var ya=/^(?:textarea|input|select)$/i,aa=/^([^\.]*)?(?:\.(.+))?$/,Ya=/(?:^|\s)hover(\.\S+)?\b/,gb=/^key/,hb=/^(?:mouse|contextmenu)|click/,Ja=/^(?:focusinfocus|focusoutblur)$/,ib=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,jb=function(a){if(a=ib.exec(a))a[1]=(a[1]||"").toLowerCase(),a[3]=a[3]&&RegExp("(?:^|\\s)"+a[3]+"(?:\\s|$)");return a},Ka=function(h){return a.event.special.hover?h:h.replace(Ya,
"mouseenter$1 mouseleave$1")};a.event={add:function(h,b,c,e,g){var f,k,m,j,p,n,q,o,s;if(!(h.nodeType===3||h.nodeType===8||!b||!c||!(f=a._data(h)))){if(c.handler)q=c,c=q.handler,g=q.selector;if(!c.guid)c.guid=a.guid++;m=f.events;if(!m)f.events=m={};k=f.handle;if(!k)f.handle=k=function(h){return typeof a!=="undefined"&&(!h||a.event.triggered!==h.type)?a.event.dispatch.apply(k.elem,arguments):d},k.elem=h;b=a.trim(Ka(b)).split(" ");for(f=0;f<b.length;f++){j=aa.exec(b[f])||[];p=j[1];n=(j[2]||"").split(".").sort();
s=a.event.special[p]||{};p=(g?s.delegateType:s.bindType)||p;s=a.event.special[p]||{};j=a.extend({type:p,origType:j[1],data:e,handler:c,guid:c.guid,selector:g,quick:g&&jb(g),namespace:n.join(".")},q);o=m[p];if(!o&&(o=m[p]=[],o.delegateCount=0,!s.setup||s.setup.call(h,e,n,k)===!1))h.addEventListener?h.addEventListener(p,k,!1):h.attachEvent&&h.attachEvent("on"+p,k);if(s.add&&(s.add.call(h,j),!j.handler.guid))j.handler.guid=c.guid;g?o.splice(o.delegateCount++,0,j):o.push(j);a.event.global[p]=!0}h=null}},
global:{},remove:function(h,b,c,d,e){var g=a.hasData(h)&&a._data(h),f,k,m,j,p,n,q,o,s,r;if(g&&(q=g.events)){b=a.trim(Ka(b||"")).split(" ");for(f=0;f<b.length;f++)if(k=aa.exec(b[f])||[],m=j=k[1],k=k[2],m){o=a.event.special[m]||{};m=(d?o.delegateType:o.bindType)||m;s=q[m]||[];p=s.length;k=k?RegExp("(^|\\.)"+k.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<s.length;n++)if(r=s[n],(e||j===r.origType)&&(!c||c.guid===r.guid)&&(!k||k.test(r.namespace))&&(!d||d===r.selector||d==="**"&&r.selector))s.splice(n--,
1),r.selector&&s.delegateCount--,o.remove&&o.remove.call(h,r);s.length===0&&p!==s.length&&((!o.teardown||o.teardown.call(h,k)===!1)&&a.removeEvent(h,m,g.handle),delete q[m])}else for(m in q)a.event.remove(h,m+b[f],c,d,!0);if(a.isEmptyObject(q)){if(b=g.handle)b.elem=null;a.removeData(h,["events","handle"],!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(h,b,c,g){if(!c||!(c.nodeType===3||c.nodeType===8)){var f=h.type||h,k=[],m,j,p,n,q;if(!Ja.test(f+a.event.triggered)&&(f.indexOf("!")>=
0&&(f=f.slice(0,-1),m=!0),f.indexOf(".")>=0&&(k=f.split("."),f=k.shift(),k.sort()),c&&!a.event.customEvent[f]||a.event.global[f]))if(h=typeof h==="object"?h[a.expando]?h:new a.Event(f,h):new a.Event(f),h.type=f,h.isTrigger=!0,h.exclusive=m,h.namespace=k.join("."),h.namespace_re=h.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,m=f.indexOf(":")<0?"on"+f:"",c){h.result=d;if(!h.target)h.target=c;b=b!=null?a.makeArray(b):[];b.unshift(h);p=a.event.special[f]||{};if(!(p.trigger&&p.trigger.apply(c,
b)===!1)){q=[[c,p.bindType||f]];if(!g&&!p.noBubble&&!a.isWindow(c)){n=p.delegateType||f;k=Ja.test(n+f)?c:c.parentNode;for(j=null;k;k=k.parentNode)q.push([k,n]),j=k;j&&j===c.ownerDocument&&q.push([j.defaultView||j.parentWindow||e,n])}for(j=0;j<q.length&&!h.isPropagationStopped();j++)k=q[j][0],h.type=q[j][1],(n=(a._data(k,"events")||{})[h.type]&&a._data(k,"handle"))&&n.apply(k,b),(n=m&&k[m])&&a.acceptData(k)&&n.apply(k,b)===!1&&h.preventDefault();h.type=f;if(!g&&!h.isDefaultPrevented()&&(!p._default||
p._default.apply(c.ownerDocument,b)===!1)&&!(f==="click"&&a.nodeName(c,"a"))&&a.acceptData(c))if(m&&c[f]&&(f!=="focus"&&f!=="blur"||h.target.offsetWidth!==0)&&!a.isWindow(c))(j=c[m])&&(c[m]=null),a.event.triggered=f,c[f](),a.event.triggered=d,j&&(c[m]=j);return h.result}}else for(j in c=a.cache,c)c[j].events&&c[j].events[f]&&a.event.trigger(h,b,c[j].handle.elem,!0)}},dispatch:function(h){var h=a.event.fix(h||e.event),b=(a._data(this,"events")||{})[h.type]||[],c=b.delegateCount,g=[].slice.call(arguments,
0),f=!h.exclusive&&!h.namespace,k=a.event.special[h.type]||{},m=[],j,p,n,q,o,s,r;g[0]=h;h.delegateTarget=this;if(!(k.preDispatch&&k.preDispatch.call(this,h)===!1)){if(c&&!(h.button&&h.type==="click")){n=a(this);n.context=this.ownerDocument||this;for(p=h.target;p!=this;p=p.parentNode||this)if(p.disabled!==!0){o={};s=[];n[0]=p;for(j=0;j<c;j++){q=b[j];r=q.selector;if(o[r]===d){var u=o,w=r,C;if(q.quick){C=q.quick;var E=p.attributes||{};C=(!C[1]||p.nodeName.toLowerCase()===C[1])&&(!C[2]||(E.id||{}).value===
C[2])&&(!C[3]||C[3].test((E["class"]||{}).value))}else C=n.is(r);u[w]=C}o[r]&&s.push(q)}s.length&&m.push({elem:p,matches:s})}}b.length>c&&m.push({elem:this,matches:b.slice(c)});for(j=0;j<m.length&&!h.isPropagationStopped();j++){c=m[j];h.currentTarget=c.elem;for(b=0;b<c.matches.length&&!h.isImmediatePropagationStopped();b++)if(q=c.matches[b],f||!h.namespace&&!q.namespace||h.namespace_re&&h.namespace_re.test(q.namespace))if(h.data=q.data,h.handleObj=q,q=((a.event.special[q.origType]||{}).handle||q.handler).apply(c.elem,
g),q!==d)h.result=q,q===!1&&(h.preventDefault(),h.stopPropagation())}k.postDispatch&&k.postDispatch.call(this,h);return h.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){if(a.which==null)a.which=b.charCode!=null?b.charCode:b.keyCode;return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(a,b){var c,e,g=b.button,f=b.fromElement;if(a.pageX==null&&b.clientX!=null)c=a.target.ownerDocument||s,e=c.documentElement,c=c.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0);if(!a.relatedTarget&&f)a.relatedTarget=f===a.target?b.toElement:f;if(!a.which&&g!==d)a.which=g&1?1:g&2?3:g&4?2:0;return a}},fix:function(h){if(h[a.expando])return h;var b,
c,e=h,g=a.event.fixHooks[h.type]||{},f=g.props?this.props.concat(g.props):this.props,h=a.Event(e);for(b=f.length;b;)c=f[--b],h[c]=e[c];if(!h.target)h.target=e.srcElement||s;if(h.target.nodeType===3)h.target=h.target.parentNode;if(h.metaKey===d)h.metaKey=h.ctrlKey;return g.filter?g.filter(h,e):h},special:{ready:{setup:a.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(h,b,c){if(a.isWindow(this))this.onbeforeunload=c},teardown:function(a,
b){if(this.onbeforeunload===b)this.onbeforeunload=null}}},simulate:function(h,b,c,d){h=a.extend(new a.Event,c,{type:h,isSimulated:!0,originalEvent:{}});d?a.event.trigger(h,null,b):a.event.dispatch.call(b,h);h.isDefaultPrevented()&&c.preventDefault()}};a.event.handle=a.event.dispatch;a.removeEvent=s.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};a.Event=function(h,b){if(!(this instanceof a.Event))return new a.Event(h,
b);h&&h.type?(this.originalEvent=h,this.type=h.type,this.isDefaultPrevented=h.defaultPrevented||h.returnValue===!1||h.getPreventDefault&&h.getPreventDefault()?k:c):this.type=h;b&&a.extend(this,b);this.timeStamp=h&&h.timeStamp||a.now();this[a.expando]=!0};a.Event.prototype={preventDefault:function(){this.isDefaultPrevented=k;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=k;var a=this.originalEvent;if(a)a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=k;this.stopPropagation()},isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c};a.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b,c){a.event.special[b]={delegateType:c,bindType:c,handle:function(b){var h=b.relatedTarget,d=b.handleObj,e;if(!h||h!==this&&!a.contains(this,h))b.type=d.origType,e=d.handler.apply(this,arguments),b.type=c;return e}}});if(!a.support.submitBubbles)a.event.special.submit=
{setup:function(){if(a.nodeName(this,"form"))return!1;a.event.add(this,"click._submit keypress._submit",function(b){b=b.target;if((b=a.nodeName(b,"input")||a.nodeName(b,"button")?b.form:d)&&!b._submit_attached)a.event.add(b,"submit._submit",function(a){a._submit_bubble=!0}),b._submit_attached=!0})},postDispatch:function(b){b._submit_bubble&&(delete b._submit_bubble,this.parentNode&&!b.isTrigger&&a.event.simulate("submit",this.parentNode,b,!0))},teardown:function(){if(a.nodeName(this,"form"))return!1;
a.event.remove(this,"._submit")}};if(!a.support.changeBubbles)a.event.special.change={setup:function(){if(ya.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")a.event.add(this,"propertychange._change",function(a){if(a.originalEvent.propertyName==="checked")this._just_changed=!0}),a.event.add(this,"click._change",function(b){if(this._just_changed&&!b.isTrigger)this._just_changed=!1,a.event.simulate("change",this,b,!0)});return!1}a.event.add(this,"beforeactivate._change",function(b){b=
b.target;if(ya.test(b.nodeName)&&!b._change_attached)a.event.add(b,"change._change",function(b){this.parentNode&&!b.isSimulated&&!b.isTrigger&&a.event.simulate("change",this.parentNode,b,!0)}),b._change_attached=!0})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){a.event.remove(this,"._change");return ya.test(this.nodeName)}};a.support.focusinBubbles||a.each({focus:"focusin",
blur:"focusout"},function(b,c){var d=0,e=function(b){a.event.simulate(c,b.target,a.event.fix(b),!0)};a.event.special[c]={setup:function(){d++===0&&s.addEventListener(b,e,!0)},teardown:function(){--d===0&&s.removeEventListener(b,e,!0)}}});a.fn.extend({on:function(b,l,e,g,f){var k,m;if(typeof b==="object"){typeof l!=="string"&&(e=e||l,l=d);for(m in b)this.on(m,l,e,b[m],f);return this}e==null&&g==null?(g=l,e=l=d):g==null&&(typeof l==="string"?(g=e,e=d):(g=e,e=l,l=d));if(g===!1)g=c;else if(!g)return this;
if(f===1)k=g,g=function(b){a().off(b);return k.apply(this,arguments)},g.guid=k.guid||(k.guid=a.guid++);return this.each(function(){a.event.add(this,b,g,e,l)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(b,l,e){if(b&&b.preventDefault&&b.handleObj){var g=b.handleObj;a(b.delegateTarget).off(g.namespace?g.origType+"."+g.namespace:g.origType,g.selector,g.handler);return this}if(typeof b==="object"){for(g in b)this.off(g,l,b[g]);return this}if(l===!1||typeof l==="function")e=l,l=d;e===
!1&&(e=c);return this.each(function(){a.event.remove(this,b,e,l)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(b,c,d){a(this.context).on(b,this.selector,c,d);return this},die:function(b,c){a(this.context).off(b,this.selector||"**",c);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(b,c){return this.each(function(){a.event.trigger(b,
c,this)})},triggerHandler:function(b,c){if(this[0])return a.event.trigger(b,c,this[0],!0)},toggle:function(b){var c=arguments,d=b.guid||a.guid++,e=0,g=function(d){var g=(a._data(this,"lastToggle"+b.guid)||0)%e;a._data(this,"lastToggle"+b.guid,g+1);d.preventDefault();return c[g].apply(this,arguments)||!1};for(g.guid=d;e<c.length;)c[e++].guid=d;return this.click(g)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});a.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu touchstart touchend touchmove".split(" "),
function(b,c){a.fn[c]=function(a,b){b==null&&(b=a,a=null);return arguments.length>0?this.on(c,null,a,b):this.trigger(c)};a.attrFn&&(a.attrFn[c]=!0);if(gb.test(c))a.event.fixHooks[c]=a.event.keyHooks;if(hb.test(c))a.event.fixHooks[c]=a.event.mouseHooks});(function(){function b(a,h,c,d,e,l){for(var e=0,f=d.length;e<f;e++){var k=d[e];if(k){for(var m=!1,k=k[a];k;){if(k[g]===c){m=d[k.sizset];break}if(k.nodeType===1&&!l)k[g]=c,k.sizset=e;if(k.nodeName.toLowerCase()===h){m=k;break}k=k[a]}d[e]=m}}}function c(a,
b,h,d,e,l){for(var e=0,f=d.length;e<f;e++){var k=d[e];if(k){for(var m=!1,k=k[a];k;){if(k[g]===h){m=d[k.sizset];break}if(k.nodeType===1){if(!l)k[g]=h,k.sizset=e;if(typeof b!=="string"){if(k===b){m=!0;break}}else if(o.filter(b,[k]).length>0){m=k;break}}k=k[a]}d[e]=m}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,g="sizcache"+(Math.random()+"").replace(".",""),f=0,k=Object.prototype.toString,m=!1,j=!0,p=/\\/g,
n=/\r\n/g,q=/\W/;[0,0].sort(function(){j=!1;return 0});var o=function(a,b,h,c){var h=h||[],d=b=b||s;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!=="string")return h;var l,g,f,m,j,N=!0,p=o.isXML(b),n=[],q=a;do if(e.exec(""),l=e.exec(q))if(q=l[3],n.push(l[1]),l[2]){m=l[3];break}while(l);if(n.length>1&&w.exec(a))if(n.length===2&&u.relative[n[0]])g=O(n[0]+n[1],b,c);else for(g=u.relative[n[0]]?[b]:o(n.shift(),b);n.length;)a=n.shift(),u.relative[a]&&(a+=n.shift()),g=O(a,g,c);else if(!c&&n.length>
1&&b.nodeType===9&&!p&&u.match.ID.test(n[0])&&!u.match.ID.test(n[n.length-1])&&(l=o.find(n.shift(),b,p),b=l.expr?o.filter(l.expr,l.set)[0]:l.set[0]),b){l=c?{expr:n.pop(),set:y(c)}:o.find(n.pop(),n.length===1&&(n[0]==="~"||n[0]==="+")&&b.parentNode?b.parentNode:b,p);g=l.expr?o.filter(l.expr,l.set):l.set;for(n.length>0?f=y(g):N=!1;n.length;)l=j=n.pop(),u.relative[j]?l=n.pop():j="",l==null&&(l=b),u.relative[j](f,l,p)}else f=[];f||(f=g);f||o.error(j||a);if(k.call(f)==="[object Array]")if(N)if(b&&b.nodeType===
1)for(a=0;f[a]!=null;a++)f[a]&&(f[a]===!0||f[a].nodeType===1&&o.contains(b,f[a]))&&h.push(g[a]);else for(a=0;f[a]!=null;a++)f[a]&&f[a].nodeType===1&&h.push(g[a]);else h.push.apply(h,f);else y(f,h);m&&(o(m,d,h,c),o.uniqueSort(h));return h};o.uniqueSort=function(a){if(K&&(m=j,a.sort(K),m))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};o.matches=function(a,b){return o(a,null,null,b)};o.matchesSelector=function(a,b){return o(b,null,null,[a]).length>0};o.find=function(a,b,h){var c,
d,l,e,g,f;if(!a)return[];for(d=0,l=u.order.length;d<l;d++)if(g=u.order[d],e=u.leftMatch[g].exec(a))if(f=e[1],e.splice(1,1),f.substr(f.length-1)!=="\\"&&(e[1]=(e[1]||"").replace(p,""),c=u.find[g](e,b,h),c!=null)){a=a.replace(u.match[g],"");break}c||(c=typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):[]);return{set:c,expr:a}};o.filter=function(a,b,h,c){for(var l,e,g,f,k,m,j,N,n=a,p=[],A=b,q=b&&b[0]&&o.isXML(b[0]);a&&b.length;){for(g in u.filter)if((l=u.leftMatch[g].exec(a))!=
null&&l[2])if(m=u.filter[g],k=l[1],e=!1,l.splice(1,1),k.substr(k.length-1)!=="\\"){A===p&&(p=[]);if(u.preFilter[g])if(l=u.preFilter[g](l,A,h,p,c,q)){if(l===!0)continue}else e=f=!0;if(l)for(j=0;(k=A[j])!=null;j++)k&&(f=m(k,l,j,A),N=c^f,h&&f!=null?N?e=!0:A[j]=!1:N&&(p.push(k),e=!0));if(f!==d){h||(A=p);a=a.replace(u.match[g],"");if(!e)return[];break}}if(a===n)if(e==null)o.error(a);else break;n=a}return A};o.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};var r=o.getText=
function(a){var b,h;b=a.nodeType;var c="";if(b)if(b===1||b===9||b===11)if(typeof a.textContent==="string")return a.textContent;else if(typeof a.innerText==="string")return a.innerText.replace(n,"");else for(a=a.firstChild;a;a=a.nextSibling)c+=r(a);else{if(b===3||b===4)return a.nodeValue}else for(b=0;h=a[b];b++)h.nodeType!==8&&(c+=r(h));return c},u=o.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,
ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},
type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var h=typeof b==="string",c=h&&!q.test(b),h=h&&!c;c&&(b=b.toLowerCase());for(var c=0,d=a.length,l;c<d;c++)if(l=a[c]){for(;(l=l.previousSibling)&&l.nodeType!==1;);a[c]=h||l&&l.nodeName.toLowerCase()===b?l||!1:l===b}h&&o.filter(b,a,!0)},">":function(a,b){var h,c=typeof b==="string",d=0,l=a.length;if(c&&!q.test(b))for(b=b.toLowerCase();d<l;d++){if(h=a[d])h=h.parentNode,a[d]=h.nodeName.toLowerCase()===b?h:!1}else{for(;d<l;d++)(h=
a[d])&&(a[d]=c?h.parentNode:h.parentNode===b);c&&o.filter(b,a,!0)}},"":function(a,d,e){var g,k=f++,m=c;typeof d==="string"&&!q.test(d)&&(g=d=d.toLowerCase(),m=b);m("parentNode",d,k,a,g,e)},"~":function(a,d,e){var g,k=f++,m=c;typeof d==="string"&&!q.test(d)&&(g=d=d.toLowerCase(),m=b);m("previousSibling",d,k,a,g,e)}},find:{ID:function(a,b,h){if(typeof b.getElementById!=="undefined"&&!h)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var h=
[],c=b.getElementsByName(a[1]),d=0,l=c.length;d<l;d++)c[d].getAttribute("name")===a[1]&&h.push(c[d]);return h.length===0?null:h}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,h,c,d,l){a=" "+a[1].replace(p,"")+" ";if(l)return a;for(var l=0,e;(e=b[l])!=null;l++)e&&(d^(e.className&&(" "+e.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?h||c.push(e):h&&(b[l]=!1));return!1},ID:function(a){return a[1].replace(p,
"")},TAG:function(a){return a[1].replace(p,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||o.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&o.error(a[0]);a[0]=f++;return a},ATTR:function(a,b,h,c,d,l){b=a[1]=a[1].replace(p,"");!l&&u.attrMap[b]&&(a[1]=u.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(p,"");a[2]==="~="&&(a[4]=" "+a[4]+
" ");return a},PSEUDO:function(a,b,h,c,d){if(a[1]==="not")if((e.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=o(a[3],null,null,b);else return a=o.filter(a[3],b,h,1^d),h||c.push.apply(c,a),!1;else if(u.match.POS.test(a[0])||u.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===
!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,h){return!!o(h[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),h=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===h&&(b===h||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()===
"input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},
focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,h,c){return b===c.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,h){return b<h[3]-0},gt:function(a,b,h){return b>h[3]-0},nth:function(a,b,h){return h[3]-0===b},eq:function(a,b,h){return h[3]-0===b}},filter:{PSEUDO:function(a,b,h,c){var d=b[1],l=u.filters[d];if(l)return l(a,h,b,c);else if(d==="contains")return(a.textContent||a.innerText||
r([a])||"").indexOf(b[3])>=0;else if(d==="not"){b=b[3];h=0;for(c=b.length;h<c;h++)if(b[h]===a)return!1;return!0}else o.error(d)},CHILD:function(a,b){var h,c,d,l,e,f;h=b[1];f=a;switch(h){case "only":case "first":for(;f=f.previousSibling;)if(f.nodeType===1)return!1;if(h==="first")return!0;f=a;case "last":for(;f=f.nextSibling;)if(f.nodeType===1)return!1;return!0;case "nth":h=b[2];c=b[3];if(h===1&&c===0)return!0;d=b[0];if((l=a.parentNode)&&(l[g]!==d||!a.nodeIndex)){e=0;for(f=l.firstChild;f;f=f.nextSibling)if(f.nodeType===
1)f.nodeIndex=++e;l[g]=d}f=a.nodeIndex-c;return h===0?f===0:f%h===0&&f/h>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var h=b[1],h=o.attr?o.attr(a,h):u.attrHandle[h]?u.attrHandle[h](a):a[h]!=null?a[h]:a.getAttribute(h),c=h+"",d=b[2],l=b[4];return h==null?d==="!=":!d&&o.attr?
h!=null:d==="="?c===l:d==="*="?c.indexOf(l)>=0:d==="~="?(" "+c+" ").indexOf(l)>=0:!l?c&&h!==!1:d==="!="?c!==l:d==="^="?c.indexOf(l)===0:d==="$="?c.substr(c.length-l.length)===l:d==="|="?c===l||c.substr(0,l.length+1)===l+"-":!1},POS:function(a,b,h,c){var d=u.setFilters[b[2]];if(d)return d(a,h,b,c)}}},w=u.match.POS,C=function(a,b){return"\\"+(b-0+1)},E;for(E in u.match)u.match[E]=RegExp(u.match[E].source+/(?![^\[]*\])(?![^\(]*\))/.source),u.leftMatch[E]=RegExp(/(^(?:.|\r|\n)*?)/.source+u.match[E].source.replace(/\\(\d+)/g,
C));u.match.globalPOS=w;var y=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(s.documentElement.childNodes,0)}catch(t){y=function(a,b){var h=0,c=b||[];if(k.call(a)==="[object Array]")Array.prototype.push.apply(c,a);else if(typeof a.length==="number")for(var d=a.length;h<d;h++)c.push(a[h]);else for(;a[h];h++)c.push(a[h]);return c}}var K,v;s.documentElement.compareDocumentPosition?K=function(a,b){return a===b?(m=!0,0):!a.compareDocumentPosition||
!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(K=function(a,b){if(a===b)return m=!0,0;else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var h,c,d=[],l=[];h=a.parentNode;c=b.parentNode;var e=h;if(h===c)return v(a,b);else if(h){if(!c)return 1}else return-1;for(;e;)d.unshift(e),e=e.parentNode;for(e=c;e;)l.unshift(e),e=e.parentNode;h=d.length;c=l.length;for(e=0;e<h&&e<c;e++)if(d[e]!==l[e])return v(d[e],l[e]);return e===h?v(a,l[e],
-1):v(d[e],b,1)},v=function(a,b,h){if(a===b)return h;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});(function(){var a=s.createElement("div"),b="script"+(new Date).getTime(),h=s.documentElement;a.innerHTML="<a name='"+b+"'/>";h.insertBefore(a,h.firstChild);if(s.getElementById(b))u.find.ID=function(a,b,h){if(typeof b.getElementById!=="undefined"&&!h)return(b=b.getElementById(a[1]))?b.id===a[1]||typeof b.getAttributeNode!=="undefined"&&b.getAttributeNode("id").nodeValue===a[1]?
[b]:d:[]},u.filter.ID=function(a,b){var h=typeof a.getAttributeNode!=="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&h&&h.nodeValue===b};h.removeChild(a);h=a=null})();(function(){var a=s.createElement("div");a.appendChild(s.createComment(""));if(a.getElementsByTagName("*").length>0)u.find.TAG=function(a,b){var h=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var c=[],d=0;h[d];d++)h[d].nodeType===1&&c.push(h[d]);h=c}return h};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!==
"undefined"&&a.firstChild.getAttribute("href")!=="#")u.attrHandle.href=function(a){return a.getAttribute("href",2)};a=null})();s.querySelectorAll&&function(){var a=o,b=s.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)){o=function(b,h,c,d){h=h||s;if(!d&&!o.isXML(h)){var l=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(l&&(h.nodeType===1||h.nodeType===9))if(l[1])return y(h.getElementsByTagName(b),c);else if(l[2]&&u.find.CLASS&&
h.getElementsByClassName)return y(h.getElementsByClassName(l[2]),c);if(h.nodeType===9){if(b==="body"&&h.body)return y([h.body],c);else if(l&&l[3]){var e=h.getElementById(l[3]);if(e&&e.parentNode){if(e.id===l[3])return y([e],c)}else return y([],c)}try{return y(h.querySelectorAll(b),c)}catch(g){}}else if(h.nodeType===1&&h.nodeName.toLowerCase()!=="object"){var l=h,f=(e=h.getAttribute("id"))||"__sizzle__",k=h.parentNode,m=/^\s*[+~]/.test(b);e?f=f.replace(/'/g,"\\$&"):h.setAttribute("id",f);if(m&&k)h=
h.parentNode;try{if(!m||k)return y(h.querySelectorAll("[id='"+f+"'] "+b),c)}catch(j){}finally{e||l.removeAttribute("id")}}}return a(b,h,c,d)};for(var h in a)o[h]=a[h];b=null}}();(function(){var a=s.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var h=!b.call(s.createElement("div"),"div"),c=!1;try{b.call(s.documentElement,"[test!='']:sizzle")}catch(d){c=!0}o.matchesSelector=function(a,d){d=d.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!o.isXML(a))try{if(c||
!u.match.PSEUDO.test(d)&&!/!=/.test(d)){var l=b.call(a,d);if(l||!h||a.document&&a.document.nodeType!==11)return l}}catch(e){}return o(d,null,null,[a]).length>0}}})();(function(){var a=s.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1))u.order.splice(1,0,"CLASS"),u.find.CLASS=function(a,b,h){if(typeof b.getElementsByClassName!==
"undefined"&&!h)return b.getElementsByClassName(a[1])},a=null})();o.contains=s.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:s.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};o.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1};var O=function(a,b,h){for(var c,d=[],l="",b=b.nodeType?[b]:b;c=u.match.PSEUDO.exec(a);)l+=c[0],a=a.replace(u.match.PSEUDO,"");
a=u.relative[a]?a+"*":a;c=0;for(var e=b.length;c<e;c++)o(a,b[c],d,h);return o.filter(l,d)};o.attr=a.attr;o.selectors.attrMap={};a.find=o;a.expr=o.selectors;a.expr[":"]=a.expr.filters;a.unique=o.uniqueSort;a.text=o.getText;a.isXMLDoc=o.isXML;a.contains=o.contains})();var kb=/Until$/,lb=/^(?:parents|prevUntil|prevAll)/,mb=/,/,nb=/^.[^:#\[\.,]*$/,ob=Array.prototype.slice,Ia=a.expr.match.globalPOS,fb={children:!0,contents:!0,next:!0,prev:!0};a.fn.extend({find:function(b){var c=this,d,e;if(typeof b!==
"string")return a(b).filter(function(){for(d=0,e=c.length;d<e;d++)if(a.contains(c[d],this))return!0});var g=this.pushStack("","find",b),f,k,m;for(d=0,e=this.length;d<e;d++)if(f=g.length,a.find(b,this[d],g),d>0)for(k=f;k<g.length;k++)for(m=0;m<f;m++)if(g[m]===g[k]){g.splice(k--,1);break}return g},has:function(b){var c=a(b);return this.filter(function(){for(var b=0,h=c.length;b<h;b++)if(a.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(n(this,a,!1),"not",a)},filter:function(a){return this.pushStack(n(this,
a,!0),"filter",a)},is:function(b){return!!b&&(typeof b==="string"?Ia.test(b)?a(b,this.context).index(this[0])>=0:a.filter(b,this).length>0:this.filter(b).length>0)},closest:function(b,c){var d=[],e,g,f=this[0];if(a.isArray(b)){for(g=1;f&&f.ownerDocument&&f!==c;){for(e=0;e<b.length;e++)a(f).is(b[e])&&d.push({selector:b[e],elem:f,level:g});f=f.parentNode;g++}return d}var k=Ia.test(b)||typeof b!=="string"?a(b,c||this.context):0;for(e=0,g=this.length;e<g;e++)for(f=this[e];f;)if(k?k.index(f)>-1:a.find.matchesSelector(f,
b)){d.push(f);break}else if(f=f.parentNode,!f||!f.ownerDocument||f===c||f.nodeType===11)break;d=d.length>1?a.unique(d):d;return this.pushStack(d,"closest",b)},index:function(b){return!b?this[0]&&this[0].parentNode?this.prevAll().length:-1:typeof b==="string"?a.inArray(this[0],a(b)):a.inArray(b.jquery?b[0]:b,this)},add:function(b,c){var d=typeof b==="string"?a(b,c):a.makeArray(b&&b.nodeType?[b]:b),e=a.merge(this.get(),d);return this.pushStack(!d[0]||!d[0].parentNode||d[0].parentNode.nodeType===11||
!e[0]||!e[0].parentNode||e[0].parentNode.nodeType===11?e:a.unique(e))},andSelf:function(){return this.add(this.prevObject)}});a.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(b){return a.dir(b,"parentNode")},parentsUntil:function(b,c,d){return a.dir(b,"parentNode",d)},next:function(b){return a.nth(b,2,"nextSibling")},prev:function(b){return a.nth(b,2,"previousSibling")},nextAll:function(b){return a.dir(b,"nextSibling")},prevAll:function(b){return a.dir(b,
"previousSibling")},nextUntil:function(b,c,d){return a.dir(b,"nextSibling",d)},prevUntil:function(b,c,d){return a.dir(b,"previousSibling",d)},siblings:function(b){return a.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return a.sibling(b.firstChild)},contents:function(b){return a.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:a.makeArray(b.childNodes)}},function(b,c){a.fn[b]=function(d,e){var g=a.map(this,c,d);kb.test(b)||(e=d);e&&typeof e==="string"&&(g=a.filter(e,
g));g=this.length>1&&!fb[b]?a.unique(g):g;if((this.length>1||mb.test(e))&&lb.test(b))g=g.reverse();return this.pushStack(g,b,ob.call(arguments).join(","))}});a.extend({filter:function(b,c,d){d&&(b=":not("+b+")");return c.length===1?a.find.matchesSelector(c[0],b)?[c[0]]:[]:a.find.matches(b,c)},dir:function(b,c,e){for(var g=[],b=b[c];b&&b.nodeType!==9&&(e===d||b.nodeType!==1||!a(b).is(e));)b.nodeType===1&&g.push(b),b=b[c];return g},nth:function(a,b,c){for(var b=b||1,d=0;a;a=a[c])if(a.nodeType===1&&
++d===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var La="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ba=/ jQuery\d+="(?:\d+|null)"/g,T=/^\s+/,ha=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,sa=/<([\w:]+)/,Ca=/<tbody/i,fa=/<|&#?\w+;/,pa=/<(?:script|style)/i,qa=/<(?:script|object|embed|option|style)/i,
I=RegExp("<(?:"+La+")[\\s/>]","i"),ga=/checked\s*(?:[^=]|=\s*.checked.)/i,la=/\/(java|ecma)script/i,Za=/^\s*<!(?:\[CDATA\[|\-\-)/,W={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},za=w(s);W.optgroup=W.option;W.tbody=W.tfoot=
W.colgroup=W.caption=W.thead;W.th=W.td;if(!a.support.htmlSerialize)W._default=[1,"div<div>","</div>"];a.fn.extend({text:function(b){return a.access(this,function(b){return b===d?a.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(b))},null,b,arguments.length)},wrapAll:function(b){if(a.isFunction(b))return this.each(function(c){a(this).wrapAll(b.call(this,c))});if(this[0]){var c=a(b,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&c.insertBefore(this[0]);c.map(function(){for(var a=
this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(b){return a.isFunction(b)?this.each(function(c){a(this).wrapInner(b.call(this,c))}):this.each(function(){var c=a(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=a.isFunction(b);return this.each(function(d){a(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(){return this.parent().each(function(){a.nodeName(this,"body")||a(this).replaceWith(this.childNodes)}).end()},
append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});else if(arguments.length){var b=a.clean(arguments);b.push.apply(b,this.toArray());return this.pushStack(b,"before",arguments)}},after:function(){if(this[0]&&
this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});else if(arguments.length){var b=this.pushStack(this,"after",arguments);b.push.apply(b,a.clean(arguments));return b}},remove:function(b,c){for(var d=0,e;(e=this[d])!=null;d++)if(!b||a.filter(b,[e]).length)!c&&e.nodeType===1&&(a.cleanData(e.getElementsByTagName("*")),a.cleanData([e])),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var b=0,c;(c=this[b])!=null;b++)for(c.nodeType===
1&&a.cleanData(c.getElementsByTagName("*"));c.firstChild;)c.removeChild(c.firstChild);return this},clone:function(b,c){b=b==null?!1:b;c=c==null?b:c;return this.map(function(){return a.clone(this,b,c)})},html:function(b){return a.access(this,function(b){var h=this[0]||{},c=0,e=this.length;if(b===d)return h.nodeType===1?h.innerHTML.replace(ba,""):null;if(typeof b==="string"&&!pa.test(b)&&(a.support.leadingWhitespace||!T.test(b))&&!W[(sa.exec(b)||["",""])[1].toLowerCase()]){b=b.replace(ha,"<$1></$2>");
try{for(;c<e;c++)if(h=this[c]||{},h.nodeType===1)a.cleanData(h.getElementsByTagName("*")),h.innerHTML=b;h=0}catch(g){}}h&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(b){if(this[0]&&this[0].parentNode){if(a.isFunction(b))return this.each(function(c){var d=a(this),e=d.html();d.replaceWith(b.call(this,c,e))});typeof b!=="string"&&(b=a(b).detach());return this.each(function(){var c=this.nextSibling,d=this.parentNode;a(this).remove();c?a(c).before(b):a(d).append(b)})}else return this.length?
this.pushStack(a(a.isFunction(b)?b():b),"replaceWith",b):this},detach:function(a){return this.remove(a,!0)},domManip:function(b,c,e){var g,f,k,m=b[0],j=[];if(!a.support.checkClone&&arguments.length===3&&typeof m==="string"&&ga.test(m))return this.each(function(){a(this).domManip(b,c,e,!0)});if(a.isFunction(m))return this.each(function(g){var f=a(this);b[0]=m.call(this,g,c?f.html():d);f.domManip(b,c,e)});if(this[0]){g=m&&m.parentNode;g=a.support.parentNode&&g&&g.nodeType===11&&g.childNodes.length===
this.length?{fragment:g}:a.buildFragment(b,this,j);k=g.fragment;if(f=k.childNodes.length===1?k=k.firstChild:k.firstChild){c=c&&a.nodeName(f,"tr");f=0;for(var p=this.length,n=p-1;f<p;f++)e.call(c?a.nodeName(this[f],"table")?this[f].getElementsByTagName("tbody")[0]||this[f].appendChild(this[f].ownerDocument.createElement("tbody")):this[f]:this[f],g.cacheable||p>1&&f<n?a.clone(k,!0,!0):k)}j.length&&a.each(j,function(b,h){h.src?a.ajax({type:"GET",global:!1,url:h.src,async:!1,dataType:"script"}):a.globalEval((h.text||
h.textContent||h.innerHTML||"").replace(Za,"/*$0*/"));h.parentNode&&h.parentNode.removeChild(h)})}return this}});a.buildFragment=function(b,c,d){var e,g,f,k,m=b[0];c&&c[0]&&(k=c[0].ownerDocument||c[0]);k.createDocumentFragment||(k=s);if(b.length===1&&typeof m==="string"&&m.length<512&&k===s&&m.charAt(0)==="<"&&!qa.test(m)&&(a.support.checkClone||!ga.test(m))&&(a.support.html5Clone||!I.test(m)))g=!0,(f=a.fragments[m])&&f!==1&&(e=f);e||(e=k.createDocumentFragment(),a.clean(b,k,e,d));g&&(a.fragments[m]=
f?e:1);return{fragment:e,cacheable:g}};a.fragments={};a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e=[],d=a(d),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&d.length===1)return d[c](this[0]),this;else{for(var g=0,f=d.length;g<f;g++){var k=(g>0?this.clone(!0):this).get();a(d[g])[c](k);e=e.concat(k)}return this.pushStack(e,b,d.selector)}}});a.extend({clone:function(b,
c,d){var e,g,f;a.support.html5Clone||a.isXMLDoc(b)||!I.test("<"+b.nodeName+">")?e=b.cloneNode(!0):(e=s.createElement("div"),za.appendChild(e),e.innerHTML=b.outerHTML,e=e.firstChild);var k=e;if((!a.support.noCloneEvent||!a.support.noCloneChecked)&&(b.nodeType===1||b.nodeType===11)&&!a.isXMLDoc(b)){r(b,k);e=u(b);g=u(k);for(f=0;e[f];++f)g[f]&&r(e[f],g[f])}if(c&&(o(b,k),d)){e=u(b);g=u(k);for(f=0;e[f];++f)o(e[f],g[f])}return k},clean:function(b,c,d,e){var g,f=[],c=c||s;typeof c.createElement==="undefined"&&
(c=c.ownerDocument||c[0]&&c[0].ownerDocument||s);for(var k=0,m;(m=b[k])!=null;k++)if(typeof m==="number"&&(m+=""),m){if(typeof m==="string")if(fa.test(m)){m=m.replace(ha,"<$1></$2>");g=(sa.exec(m)||["",""])[1].toLowerCase();var j=W[g]||W._default,n=j[0],o=c.createElement("div"),q=za.childNodes;c===s?za.appendChild(o):w(c).appendChild(o);for(o.innerHTML=j[1]+m+j[2];n--;)o=o.lastChild;if(!a.support.tbody){n=Ca.test(m);j=g==="table"&&!n?o.firstChild&&o.firstChild.childNodes:j[1]==="<table>"&&!n?o.childNodes:
[];for(g=j.length-1;g>=0;--g)a.nodeName(j[g],"tbody")&&!j[g].childNodes.length&&j[g].parentNode.removeChild(j[g])}!a.support.leadingWhitespace&&T.test(m)&&o.insertBefore(c.createTextNode(T.exec(m)[0]),o.firstChild);m=o.childNodes;o&&(o.parentNode.removeChild(o),q.length>0&&(o=q[q.length-1])&&o.parentNode&&o.parentNode.removeChild(o))}else m=c.createTextNode(m);var u;if(!a.support.appendChecked)if(m[0]&&typeof(u=m.length)==="number")for(g=0;g<u;g++)p(m[g]);else p(m);m.nodeType?f.push(m):f=a.merge(f,
m)}if(d){b=function(a){return!a.type||la.test(a.type)};for(k=0;f[k];k++)c=f[k],e&&a.nodeName(c,"script")&&(!c.type||la.test(c.type))?e.push(c.parentNode?c.parentNode.removeChild(c):c):(c.nodeType===1&&(m=a.grep(c.getElementsByTagName("script"),b),f.splice.apply(f,[k+1,0].concat(m))),d.appendChild(c))}return f},cleanData:function(b){for(var c,d,e=a.cache,g=a.event.special,f=a.support.deleteExpando,k=0,m;(m=b[k])!=null;k++)if(!m.nodeName||!a.noData[m.nodeName.toLowerCase()])if(d=m[a.expando]){if((c=
e[d])&&c.events){for(var j in c.events)g[j]?a.event.remove(m,j):a.removeEvent(m,j,c.handle);if(c.handle)c.handle.elem=null}f?delete m[a.expando]:m.removeAttribute&&m.removeAttribute(a.expando);delete e[d]}}});var Aa=/alpha\([^)]*\)/i,$a=/opacity=([^)]*)/,ab=/([A-Z]|^ms)/g,bb=/^[\-+]?(?:\d*\.)?\d+$/i,Ba=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,cb=/^([\-+])=([\-+.\de]+)/,db=/^margin/,eb={position:"absolute",visibility:"hidden",display:"block"},ea=["Top","Right","Bottom","Left"],ka,Oa,Pa;a.fn.css=function(b,
c){return a.access(this,function(b,c,h){return h!==d?a.style(b,c,h):a.css(b,c)},b,c,arguments.length>1)};a.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=ka(a,"opacity");return c===""?"1":c}else return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":a.support.cssFloat?"cssFloat":"styleFloat"},style:function(b,c,e,g){if(b&&!(b.nodeType===3||b.nodeType===8||!b.style)){var f,k=a.camelCase(c),m=b.style,
j=a.cssHooks[k],c=a.cssProps[k]||k;if(e!==d){g=typeof e;if(g==="string"&&(f=cb.exec(e)))e=+(f[1]+1)*+f[2]+parseFloat(a.css(b,c)),g="number";if(!(e==null||g==="number"&&isNaN(e)))if(g==="number"&&!a.cssNumber[k]&&(e+="px"),!j||!("set"in j)||(e=j.set(b,e))!==d)try{m[c]=e}catch(o){}}else return j&&"get"in j&&(f=j.get(b,!1,g))!==d?f:m[c]}},css:function(b,c,e){var g,f,c=a.camelCase(c);f=a.cssHooks[c];c=a.cssProps[c]||c;c==="cssFloat"&&(c="float");if(f&&"get"in f&&(g=f.get(b,!0,e))!==d)return g;else if(ka)return ka(b,
c)},swap:function(a,b,c){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c=c.call(a);for(e in b)a.style[e]=d[e];return c}});a.curCSS=a.css;s.defaultView&&s.defaultView.getComputedStyle&&(Oa=function(b,c){var d,e,g,f=b.style,c=c.replace(ab,"-$1").toLowerCase();if((e=b.ownerDocument.defaultView)&&(g=e.getComputedStyle(b,null)))d=g.getPropertyValue(c),d===""&&!a.contains(b.ownerDocument.documentElement,b)&&(d=a.style(b,c));if(!a.support.pixelMargin&&g&&db.test(c)&&Ba.test(d))e=f.width,f.width=
d,d=g.width,f.width=e;return d});s.documentElement.currentStyle&&(Pa=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],g=a.style;if(e==null&&g&&(c=g[b]))e=c;if(Ba.test(e)){c=g.left;if(d=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;g.left=b==="fontSize"?"1em":e;e=g.pixelLeft+"px";g.left=c;if(d)a.runtimeStyle.left=d}return e===""?"auto":e});ka=Oa||Pa;a.each(["height","width"],function(b,c){a.cssHooks[c]={get:function(b,h,d){if(h)return b.offsetWidth!==0?q(b,c,
d):a.swap(b,eb,function(){return q(b,c,d)})},set:function(a,b){return bb.test(b)?b+"px":b}}});if(!a.support.opacity)a.cssHooks.opacity={get:function(a,b){return $a.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(b,c){var d=b.style,e=b.currentStyle,g=a.isNumeric(c)?"alpha(opacity="+c*100+")":"",f=e&&e.filter||d.filter||"";d.zoom=1;if(c>=1&&a.trim(f.replace(Aa,""))===""&&(d.removeAttribute("filter"),e&&!e.filter))return;d.filter=
Aa.test(f)?f.replace(Aa,g):f+" "+g}};a(function(){if(!a.support.reliableMarginRight)a.cssHooks.marginRight={get:function(b,c){return a.swap(b,{display:"inline-block"},function(){return c?ka(b,"margin-right"):b.style.marginRight})}}});if(a.expr&&a.expr.filters)a.expr.filters.hidden=function(b){var c=b.offsetHeight;return b.offsetWidth===0&&c===0||!a.support.reliableHiddenOffsets&&(b.style&&b.style.display||a.css(b,"display"))==="none"},a.expr.filters.visible=function(b){return!a.expr.filters.hidden(b)};
a.each({margin:"",padding:"",border:"Width"},function(b,c){a.cssHooks[b+c]={expand:function(a){for(var d=typeof a==="string"?a.split(" "):[a],e={},a=0;a<4;a++)e[b+ea[a]+c]=d[a]||d[a-2]||d[0];return e}}});var rb=/%20/g,pb=/\[\]$/,Qa=/\r?\n/g,sb=/#.*$/,tb=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,ub=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,vb=/^(?:GET|HEAD)$/,wb=/^\/\//,Ra=/\?/,xb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,yb=
/^(?:select|textarea)/i,Ma=/\s+/,zb=/([?&])_=[^&]*/,Sa=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ta=a.fn.load,Da={},Ua={},ia,ja,Va=["*/"]+["*"];try{ia=P.href}catch(Fb){ia=s.createElement("a"),ia.href="",ia=ia.href}ja=Sa.exec(ia.toLowerCase())||[];a.fn.extend({load:function(b,c,e){if(typeof b!=="string"&&Ta)return Ta.apply(this,arguments);else if(!this.length)return this;var g=b.indexOf(" ");if(g>=0)var f=b.slice(g,b.length),b=b.slice(0,g);g="GET";c&&(a.isFunction(c)?(e=c,c=d):typeof c==="object"&&
(c=a.param(c,a.ajaxSettings.traditional),g="POST"));var k=this;a.ajax({url:b,type:g,dataType:"html",data:c,complete:function(b,c,h){h=b.responseText;b.isResolved()&&(b.done(function(a){h=a}),k.html(f?a("<div>").append(h.replace(xb,"")).find(f):h));e&&k.each(e,[h,c,b])}});return this},serialize:function(){return a.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?a.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&
(this.checked||yb.test(this.nodeName)||ub.test(this.type))}).map(function(b,c){var d=a(this).val();return d==null?null:a.isArray(d)?a.map(d,function(a){return{name:c.name,value:a.replace(Qa,"\r\n")}}):{name:c.name,value:d.replace(Qa,"\r\n")}}).get()}});a.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){a.fn[c]=function(a){return this.on(c,a)}});a.each(["get","post"],function(b,c){a[c]=function(b,h,e,g){a.isFunction(h)&&(g=g||e,e=h,h=d);return a.ajax({type:c,
url:b,data:h,success:e,dataType:g})}});a.extend({getScript:function(b,c){return a.get(b,d,c,"script")},getJSON:function(b,c,d){return a.get(b,c,d,"json")},ajaxSetup:function(b,c){c?H(b,a.ajaxSettings):(c=b,b=a.ajaxSettings);H(b,c);return b},ajaxSettings:{url:ia,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(ja[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",
text:"text/plain",json:"application/json, text/javascript","*":Va},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":a.parseJSON,"text xml":a.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:E(Da),ajaxTransport:E(Ua),ajax:function(b,c){function e(b,c,h,l){if(E!==2){E=2;w&&clearTimeout(w);r=d;u=l||"";v.readyState=b>0?4:0;var p,q,s,l=c;if(h){var C=g,A=v,y=C.contents,K=C.dataTypes,O=C.responseFields,
L,G,z,H;for(G in O)G in h&&(A[O[G]]=h[G]);for(;K[0]==="*";)K.shift(),L===d&&(L=C.mimeType||A.getResponseHeader("content-type"));if(L)for(G in y)if(y[G]&&y[G].test(L)){K.unshift(G);break}if(K[0]in h)z=K[0];else{for(G in h){if(!K[0]||C.converters[G+" "+K[0]]){z=G;break}H||(H=G)}z=z||H}z?(z!==K[0]&&K.unshift(z),h=h[z]):h=void 0}else h=d;if(b>=200&&b<300||b===304){if(g.ifModified){if(L=v.getResponseHeader("Last-Modified"))a.lastModified[n]=L;if(L=v.getResponseHeader("Etag"))a.etag[n]=L}if(b===304)l="notmodified",
p=!0;else try{L=g;L.dataFilter&&(h=L.dataFilter(h,L.dataType));var D=L.dataTypes;G={};var Q,x,F=D.length,da,X=D[0],B,J,S,M,aa;for(Q=1;Q<F;Q++){if(Q===1)for(x in L.converters)typeof x==="string"&&(G[x.toLowerCase()]=L.converters[x]);B=X;X=D[Q];if(X==="*")X=B;else if(B!=="*"&&B!==X){J=B+" "+X;S=G[J]||G["* "+X];if(!S)for(M in aa=d,G)if(da=M.split(" "),da[0]===B||da[0]==="*")if(aa=G[da[1]+" "+X]){M=G[M];M===!0?S=aa:aa===!0&&(S=M);break}!S&&!aa&&a.error("No conversion from "+J.replace(" "," to "));S!==
!0&&(h=S?S(h):aa(M(h)))}}q=h;l="success";p=!0}catch(P){l="parsererror",s=P}}else if(s=l,!l||b)l="error",b<0&&(b=0);v.status=b;v.statusText=""+(c||l);p?m.resolveWith(f,[q,l,v]):m.rejectWith(f,[v,l,s]);v.statusCode(o);o=d;t&&k.trigger("ajax"+(p?"Success":"Error"),[v,g,p?q:s]);j.fireWith(f,[v,l]);t&&(k.trigger("ajaxComplete",[v,g]),--a.active||a.event.trigger("ajaxStop"))}}typeof b==="object"&&(c=b,b=d);var c=c||{},g=a.ajaxSetup({},c),f=g.context||g,k=f!==g&&(f.nodeType||f instanceof a)?a(f):a.event,
m=a.Deferred(),j=a.Callbacks("once memory"),o=g.statusCode||{},n,p={},q={},u,s,r,w,C,E=0,t,K,v={readyState:0,setRequestHeader:function(a,b){if(!E){var c=a.toLowerCase(),a=q[c]=q[c]||a;p[a]=b}return this},getAllResponseHeaders:function(){return E===2?u:null},getResponseHeader:function(a){var b;if(E===2){if(!s)for(s={};b=tb.exec(u);)s[b[1].toLowerCase()]=b[2];b=s[a.toLowerCase()]}return b===d?null:b},overrideMimeType:function(a){if(!E)g.mimeType=a;return this},abort:function(a){a=a||"abort";r&&r.abort(a);
e(0,a);return this}};m.promise(v);v.success=v.done;v.error=v.fail;v.complete=j.add;v.statusCode=function(a){if(a){var b;if(E<2)for(b in a)o[b]=[o[b],a[b]];else b=a[v.status],v.then(b,b)}return this};g.url=((b||g.url)+"").replace(sb,"").replace(wb,ja[1]+"//");g.dataTypes=a.trim(g.dataType||"*").toLowerCase().split(Ma);if(g.crossDomain==null)C=Sa.exec(g.url.toLowerCase()),g.crossDomain=!(!C||!(C[1]!=ja[1]||C[2]!=ja[2]||(C[3]||(C[1]==="http:"?80:443))!=(ja[3]||(ja[1]==="http:"?80:443))));if(g.data&&
g.processData&&typeof g.data!=="string")g.data=a.param(g.data,g.traditional);y(Da,g,c,v);if(E===2)return!1;t=g.global;g.type=g.type.toUpperCase();g.hasContent=!vb.test(g.type);t&&a.active++===0&&a.event.trigger("ajaxStart");if(!g.hasContent&&(g.data&&(g.url+=(Ra.test(g.url)?"&":"?")+g.data,delete g.data),n=g.url,g.cache===!1)){C=a.now();var O=g.url.replace(zb,"$1_="+C);g.url=O+(O===g.url?(Ra.test(g.url)?"&":"?")+"_="+C:"")}(g.data&&g.hasContent&&g.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",
g.contentType);g.ifModified&&(n=n||g.url,a.lastModified[n]&&v.setRequestHeader("If-Modified-Since",a.lastModified[n]),a.etag[n]&&v.setRequestHeader("If-None-Match",a.etag[n]));v.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+(g.dataTypes[0]!=="*"?", "+Va+"; q=0.01":""):g.accepts["*"]);for(K in g.headers)v.setRequestHeader(K,g.headers[K]);if(g.beforeSend&&(g.beforeSend.call(f,v,g)===!1||E===2))return v.abort(),!1;for(K in{success:1,error:1,complete:1})v[K](g[K]);
if(r=y(Ua,g,c,v)){v.readyState=1;t&&k.trigger("ajaxSend",[v,g]);g.async&&g.timeout>0&&(w=setTimeout(function(){v.abort("timeout")},g.timeout));try{E=1,r.send(p,e)}catch(L){if(E<2)e(-1,L);else throw L;}}else e(-1,"No Transport");return v},param:function(b,c){var e=[],g=function(b,c){c=a.isFunction(c)?c():c;e[e.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};if(c===d)c=a.ajaxSettings.traditional;if(a.isArray(b)||b.jquery&&!a.isPlainObject(b))a.each(b,function(){g(this.name,this.value)});else for(var f in b)z(f,
b[f],c,g);return e.join("&").replace(rb,"+")}});a.extend({active:0,lastModified:{},etag:{}});var Ab=a.now(),wa=/(\=)\?(&|$)|\?\?/i;a.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return a.expando+"_"+Ab++}});a.ajaxPrefilter("json jsonp",function(b,c,d){c=typeof b.data==="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(wa.test(b.url)||c&&wa.test(b.data))){var g,f=b.jsonpCallback=a.isFunction(b.jsonpCallback)?b.jsonpCallback():
b.jsonpCallback,k=e[f],m=b.url,j=b.data,n="$1"+f+"$2";b.jsonp!==!1&&(m=m.replace(wa,n),b.url===m&&(c&&(j=j.replace(wa,n)),b.data===j&&(m+=(/\?/.test(m)?"&":"?")+b.jsonp+"="+f)));b.url=m;b.data=j;e[f]=function(a){g=[a]};d.always(function(){e[f]=k;if(g&&a.isFunction(k))e[f](g[0])});b.converters["script json"]=function(){g||a.error(f+" was not called");return g[0]};b.dataTypes[0]="json";return"script"}});a.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(b){a.globalEval(b);return b}}});a.ajaxPrefilter("script",function(a){if(a.cache===d)a.cache=!1;if(a.crossDomain)a.type="GET",a.global=!1});a.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=s.head||s.getElementsByTagName("head")[0]||s.documentElement;return{send:function(e,g){b=s.createElement("script");b.async="async";if(a.scriptCharset)b.charset=a.scriptCharset;b.src=a.url;b.onload=b.onreadystatechange=function(a,
h){if(h||!b.readyState||/loaded|complete/.test(b.readyState))b.onload=b.onreadystatechange=null,c&&b.parentNode&&c.removeChild(b),b=d,h||g(200,"success")};c.insertBefore(b,c.firstChild)},abort:function(){if(b)b.onload(0,1)}}}});var Ha=e.ActiveXObject?function(){for(var a in oa)oa[a](0,1)}:!1,Bb=0,oa;a.ajaxSettings.xhr=e.ActiveXObject?function(){var a;if(!(a=!this.isLocal&&t()))a:{try{a=new e.ActiveXObject("Microsoft.XMLHTTP");break a}catch(b){}a=void 0}return a}:t;(function(b){a.extend(a.support,
{ajax:!!b,cors:!!b&&"withCredentials"in b})})(a.ajaxSettings.xhr());a.support.ajax&&a.ajaxTransport(function(b){if(!b.crossDomain||a.support.cors){var c;return{send:function(g,f){var k=b.xhr(),m,j;b.username?k.open(b.type,b.url,b.async,b.username,b.password):k.open(b.type,b.url,b.async);if(b.xhrFields)for(j in b.xhrFields)k[j]=b.xhrFields[j];b.mimeType&&k.overrideMimeType&&k.overrideMimeType(b.mimeType);!b.crossDomain&&!g["X-Requested-With"]&&(g["X-Requested-With"]="XMLHttpRequest");try{for(j in g)k.setRequestHeader(j,
g[j])}catch(n){}k.send(b.hasContent&&b.data||null);c=function(e,g){var j,n,p,o,q;try{if(c&&(g||k.readyState===4)){c=d;if(m)k.onreadystatechange=a.noop,Ha&&delete oa[m];if(g)k.readyState!==4&&k.abort();else{j=k.status;p=k.getAllResponseHeaders();o={};if((q=k.responseXML)&&q.documentElement)o.xml=q;try{o.text=k.responseText}catch(u){}try{n=k.statusText}catch(s){n=""}!j&&b.isLocal&&!b.crossDomain?j=o.text?200:404:j===1223&&(j=204)}}}catch(r){g||f(-1,r)}o&&f(j,n,o,p)};!b.async||k.readyState===4?c():(m=
++Bb,Ha&&(oa||(oa={},a(e).unload(Ha)),oa[m]=c),k.onreadystatechange=c)},abort:function(){c&&c(0,1)}}}});var Ea={},$,ma,Cb=/^(?:toggle|show|hide)$/,Db=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,xa,ua=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],ta;a.fn.extend({show:function(b,c,d){if(b||b===0)return this.animate(D("show",3),b,c,d);else{for(var d=0,e=this.length;d<e;d++)if(b=this[d],b.style){c=b.style.display;
if(!a._data(b,"olddisplay")&&c==="none")c=b.style.display="";(c===""&&a.css(b,"display")==="none"||!a.contains(b.ownerDocument.documentElement,b))&&a._data(b,"olddisplay",Q(b.nodeName))}for(d=0;d<e;d++)if(b=this[d],b.style&&(c=b.style.display,c===""||c==="none"))b.style.display=a._data(b,"olddisplay")||"";return this}},hide:function(b,c,d){if(b||b===0)return this.animate(D("hide",3),b,c,d);else{for(var d=0,e=this.length;d<e;d++)b=this[d],b.style&&(c=a.css(b,"display"),c!=="none"&&!a._data(b,"olddisplay")&&
a._data(b,"olddisplay",c));for(d=0;d<e;d++)if(this[d].style)this[d].style.display="none";return this}},_toggle:a.fn.toggle,toggle:function(b,c,d){var e=typeof b==="boolean";a.isFunction(b)&&a.isFunction(c)?this._toggle.apply(this,arguments):b==null||e?this.each(function(){var c=e?b:a(this).is(":hidden");a(this)[c?"show":"hide"]()}):this.animate(D("toggle",3),b,c,d);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(b,
c,d,e){function g(){var h;f.queue===!1&&a._mark(this);var c=a.extend({},f),d=this.nodeType===1,e=d&&a(this).is(":hidden"),k,m,l,j,n;c.animatedProperties={};for(l in b)if(k=a.camelCase(l),l!==k&&(b[k]=b[l],delete b[l]),(m=a.cssHooks[k])&&"expand"in m)for(l in j=m.expand(b[k]),delete b[k],j)l in b||(b[l]=j[l]);for(k in b){m=b[k];a.isArray(m)?(c.animatedProperties[k]=m[1],h=b[k]=m[0],m=h):c.animatedProperties[k]=c.specialEasing&&c.specialEasing[k]||c.easing||"swing";if(m==="hide"&&e||m==="show"&&!e)return c.complete.call(this);
if(d&&(k==="height"||k==="width"))if(c.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],a.css(this,"display")==="inline"&&a.css(this,"float")==="none")!a.support.inlineBlockNeedsLayout||Q(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1}if(c.overflow!=null)this.style.overflow="hidden";for(l in b)if(d=new a.fx(this,c,l),m=b[l],Cb.test(m))if(k=a._data(this,"toggle"+l)||(m==="toggle"?e?"show":"hide":0))a._data(this,"toggle"+l,k==="show"?"hide":"show"),
d[k]();else d[m]();else k=Db.exec(m),j=d.cur(),k?(m=parseFloat(k[2]),n=k[3]||(a.cssNumber[l]?"":"px"),n!=="px"&&(a.style(this,l,(m||1)+n),j*=(m||1)/d.cur(),a.style(this,l,j+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+j),d.custom(j,m,n)):d.custom(j,m,"");return!0}var f=a.speed(c,d,e);if(a.isEmptyObject(b))return this.each(f.complete,[!1]);b=a.extend({},b);return f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(b,c,e){typeof b!=="string"&&(e=c,c=b,b=d);c&&b!==!1&&this.queue(b||"fx",[]);return this.each(function(){function c(b,
d,h){d=d[h];a.removeData(b,h,!0);d.stop(e)}var d,g=!1,f=a.timers,k=a._data(this);e||a._unmark(!0,this);if(b==null)for(d in k)k[d]&&k[d].stop&&d.indexOf(".run")===d.length-4&&c(this,k,d);else k[d=b+".run"]&&k[d].stop&&c(this,k,d);for(d=f.length;d--;)if(f[d].elem===this&&(b==null||f[d].queue===b)){if(e)f[d](!0);else f[d].saveState();g=!0;f.splice(d,1)}(!e||!g)&&a.dequeue(this,b)})}});a.each({slideDown:D("show",1),slideUp:D("hide",1),slideToggle:D("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}},function(b,c){a.fn[b]=function(a,b,d){return this.animate(c,a,b,d)}});a.extend({speed:function(b,c,d){var e=b&&typeof b==="object"?a.extend({},b):{complete:d||!d&&c||a.isFunction(b)&&b,duration:b,easing:d&&c||c&&!a.isFunction(c)&&c};e.duration=a.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in a.fx.speeds?a.fx.speeds[e.duration]:a.fx.speeds._default;if(e.queue==null||e.queue===!0)e.queue="fx";e.old=e.complete;e.complete=function(b){a.isFunction(e.old)&&
e.old.call(this);e.queue?a.dequeue(this,e.queue):b!==!1&&a._unmark(this)};return e},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+0.5}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});a.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(a.fx.step[this.prop]||a.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==
null))return this.elem[this.prop];var b,c=a.css(this.elem,this.prop);return isNaN(b=parseFloat(c))?!c||c==="auto"?0:c:b},custom:function(b,c,e){function g(a){return f.step(a)}var f=this,k=a.fx;this.startTime=ta||G();this.end=c;this.now=this.start=b;this.pos=this.state=0;this.unit=e||this.unit||(a.cssNumber[this.prop]?"":"px");g.queue=this.options.queue;g.elem=this.elem;g.saveState=function(){a._data(f.elem,"fxshow"+f.prop)===d&&(f.options.hide?a._data(f.elem,"fxshow"+f.prop,f.start):f.options.show&&
a._data(f.elem,"fxshow"+f.prop,f.end))};g()&&a.timers.push(g)&&!xa&&(xa=setInterval(k.tick,k.interval))},show:function(){var b=a._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=b||a.style(this.elem,this.prop);this.options.show=!0;b!==d?this.custom(this.cur(),b):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());a(this.elem).show()},hide:function(){this.options.orig[this.prop]=a._data(this.elem,"fxshow"+this.prop)||a.style(this.elem,this.prop);this.options.hide=
!0;this.custom(this.cur(),0)},step:function(b){var c,d=ta||G(),e=!0,g=this.elem,f=this.options;if(b||d>=f.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();f.animatedProperties[this.prop]=!0;for(c in f.animatedProperties)f.animatedProperties[c]!==!0&&(e=!1);if(e){f.overflow!=null&&!a.support.shrinkWrapBlocks&&a.each(["","X","Y"],function(a,b){g.style["overflow"+b]=f.overflow[a]});f.hide&&a(g).hide();if(f.hide||f.show)for(c in f.animatedProperties)a.style(g,c,f.orig[c]),
a.removeData(g,"fxshow"+c,!0),a.removeData(g,"toggle"+c,!0);if(b=f.complete)f.complete=!1,b.call(g)}return!1}else f.duration==Infinity?this.now=d:(b=d-this.startTime,this.state=b/f.duration,this.pos=a.easing[f.animatedProperties[this.prop]](this.state,b,0,1,f.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}};a.extend(a.fx,{tick:function(){for(var b,c=a.timers,d=0;d<c.length;d++)b=c[d],!b()&&c[d]===b&&c.splice(d--,1);c.length||a.fx.stop()},interval:13,stop:function(){clearInterval(xa);
xa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(b){a.style(b.elem,"opacity",b.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}});a.each(ua.concat.apply([],ua),function(b,c){c.indexOf("margin")&&(a.fx.step[c]=function(b){a.style(b.elem,c,Math.max(0,b.now)+b.unit)})});if(a.expr&&a.expr.filters)a.expr.filters.animated=function(b){return a.grep(a.timers,function(a){return b===a.elem}).length};var Wa,Eb=
/^t(?:able|d|h)$/i,Xa=/^(?:body|html)$/i;Wa="getBoundingClientRect"in s.documentElement?function(b,c,d,e){try{e=b.getBoundingClientRect()}catch(g){}if(!e||!a.contains(d,b))return e?{top:e.top,left:e.left}:{top:0,left:0};b=c.body;c=O(c);return{top:e.top+(c.pageYOffset||a.support.boxModel&&d.scrollTop||b.scrollTop)-(d.clientTop||b.clientTop||0),left:e.left+(c.pageXOffset||a.support.boxModel&&d.scrollLeft||b.scrollLeft)-(d.clientLeft||b.clientLeft||0)}}:function(b,c,d){var e,g=b.offsetParent,f=c.body;
e=(c=c.defaultView)?c.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,m=b.offsetLeft;(b=b.parentNode)&&b!==f&&b!==d;){if(a.support.fixedPosition&&e.position==="fixed")break;e=c?c.getComputedStyle(b,null):b.currentStyle;k-=b.scrollTop;m-=b.scrollLeft;if(b===g){k+=b.offsetTop;m+=b.offsetLeft;if(a.support.doesNotAddBorder&&(!a.support.doesAddBorderForTableAndCells||!Eb.test(b.nodeName)))k+=parseFloat(e.borderTopWidth)||0,m+=parseFloat(e.borderLeftWidth)||0;g=b.offsetParent}a.support.subtractsBorderForOverflowNotVisible&&
e.overflow!=="visible"&&(k+=parseFloat(e.borderTopWidth)||0,m+=parseFloat(e.borderLeftWidth)||0)}if(e.position==="relative"||e.position==="static")k+=f.offsetTop,m+=f.offsetLeft;a.support.fixedPosition&&e.position==="fixed"&&(k+=Math.max(d.scrollTop,f.scrollTop),m+=Math.max(d.scrollLeft,f.scrollLeft));return{top:k,left:m}};a.fn.offset=function(b){if(arguments.length)return b===d?this:this.each(function(c){a.offset.setOffset(this,b,c)});var c=this[0],e=c&&c.ownerDocument;return!e?null:c===e.body?a.offset.bodyOffset(c):
Wa(c,e,e.documentElement)};a.offset={bodyOffset:function(b){var c=b.offsetTop,d=b.offsetLeft;a.support.doesNotIncludeMarginInBodyOffset&&(c+=parseFloat(a.css(b,"marginTop"))||0,d+=parseFloat(a.css(b,"marginLeft"))||0);return{top:c,left:d}},setOffset:function(b,c,d){var e=a.css(b,"position");if(e==="static")b.style.position="relative";var g=a(b),f=g.offset(),k=a.css(b,"top"),m=a.css(b,"left"),j={},n={};(e==="absolute"||e==="fixed")&&a.inArray("auto",[k,m])>-1?(n=g.position(),e=n.top,m=n.left):(e=parseFloat(k)||
0,m=parseFloat(m)||0);a.isFunction(c)&&(c=c.call(b,d,f));if(c.top!=null)j.top=c.top-f.top+e;if(c.left!=null)j.left=c.left-f.left+m;"using"in c?c.using.call(b,j):g.css(j)}};a.fn.extend({position:function(){if(!this[0])return null;var b=this[0],c=this.offsetParent(),d=this.offset(),e=Xa.test(c[0].nodeName)?{top:0,left:0}:c.offset();d.top-=parseFloat(a.css(b,"marginTop"))||0;d.left-=parseFloat(a.css(b,"marginLeft"))||0;e.top+=parseFloat(a.css(c[0],"borderTopWidth"))||0;e.left+=parseFloat(a.css(c[0],
"borderLeftWidth"))||0;return{top:d.top-e.top,left:d.left-e.left}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||s.body;b&&!Xa.test(b.nodeName)&&a.css(b,"position")==="static";)b=b.offsetParent;return b})}});a.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var e=/Y/.test(c);a.fn[b]=function(g){return a.access(this,function(b,g,f){var h=O(b);if(f===d)return h?c in h?h[c]:a.support.boxModel&&h.document.documentElement[g]||h.document.body[g]:b[g];
h?h.scrollTo(!e?f:a(h).scrollLeft(),e?f:a(h).scrollTop()):b[g]=f},b,g,arguments.length,null)}});a.each({Height:"height",Width:"width"},function(b,c){var e="client"+b,g="scroll"+b,f="offset"+b;a.fn["inner"+b]=function(){var b=this[0];return b?b.style?parseFloat(a.css(b,c,"padding")):this[c]():null};a.fn["outer"+b]=function(b){var d=this[0];return d?d.style?parseFloat(a.css(d,c,b?"margin":"border")):this[c]():null};a.fn[c]=function(b){return a.access(this,function(b,c,h){if(a.isWindow(b))return c=b.document,
b=c.documentElement[e],a.support.boxModel&&b||c.body&&c.body[e]||b;if(b.nodeType===9)return c=b.documentElement,c[e]>=c[g]?c[e]:Math.max(b.body[g],c[g],b.body[f],c[f]);if(h===d)return b=a.css(b,c),c=parseFloat(b),a.isNumeric(c)?c:b;a(b).css(c,h)},c,b,arguments.length,null)}})})(window);return a});
redhelper.require(["common/extensions/jquery"],function(a){a.fn.getVisible=function(){if(this.length<=1)return this;var e=a(window).scrollLeft(),d=a(window).scrollTop(),f=a(window).width(),j=a(window).height(),g=null;a.each(this,function(b,c){var k;if(a(c).is(":visible")){k={left:parseInt(a(c).css("padding-left")),right:parseInt(a(c).css("padding-right")),top:parseInt(a(c).css("padding-top")),bottom:parseInt(a(c).css("padding-bottom"))};for(var n in k)k[n]!=k[n]&&(k[n]=0);var w={left:parseInt(a(c).css("border-left-width")),
right:parseInt(a(c).css("border-right-width")),top:parseInt(a(c).css("border-top-width")),bottom:parseInt(a(c).css("border-bottom-width"))};for(n in w)w[n]!=w[n]&&(w[n]=0);n=a(c).offset();n.width=a(c).width()+k.left+k.right+w.left+w.right;n.height=a(c).height()+k.top+k.bottom+w.top+w.bottom;k=n}else k={top:0,left:0,width:0,height:0};if(e+f>k.left&&k.left+k.width>e&&d+j>k.top&&k.top+k.height>d)return g=c,!1});return a(g)}});redhelper.define("common/extensions/jquery.getvisible",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.fn.oldIs=a.fn.is;a.fn.is=function(a){return a==":visible"?this.css("display")!="none"&&this.oldIs(":visible"):this.oldIs(a)}});redhelper.define("common/extensions/jquery.fix",function(){});
redhelper.require(["common/extensions/jquery"],function(a,e){function d(a,b,c){var d=n[b.type]||{};if((b.empty||c)&&a==null)return null;if(b.def&&a==null)return b.def;a=d.floor?~~a:parseFloat(a);if(a==null||isNaN(a))return b.def;return d.mod?(a%=d.mod,a<0?d.mod+a:a):d.min>a?d.min:d.max<a?d.max:a}function f(a,b,c){c=(c+1)%1;return c*6<1?a+(b-a)*6*c:c*2<1?b:c*3<2?a+(b-a)*(2/3-c)*6:a}var j="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),
g=/^([\-+])=\s*(\d+\.?\d*)/,b=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,
parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],c=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},k={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",
def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},n={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},w=k.rgba.props,o=c.support={},r,u=a.each;k.hsla.props.alpha=w.alpha;c.fn=c.prototype={constructor:c,parse:function(g,f,j,n){if(g===e)return this._rgba=[null,null,null,null],this;if(g instanceof a||g.nodeType)g=g instanceof a?g.css(f):a(g).css(f),f=e;var o=
this,H=a.type(g),z=this._rgba=[];f!==e&&(g=[g,f,j,n],H="array");if(H==="string"){g=g.toLowerCase();u(b,function(a,b){var c=b.re.exec(g),d=c&&b.parse(c),e=b.space||"rgba",c=k[e].cache;if(d)return d=o[e](d),o[c]=d[c],z=o._rgba=d._rgba,!1});if(z.length!==0)return Math.max.apply(Math,z)===0&&a.extend(z,r.transparent),this;g=r[g]||r._default;return this.parse(g)}if(H==="array")return u(w,function(a,b){z[b.idx]=d(g[b.idx],b)}),this;if(H==="object")return g instanceof c?u(k,function(a,b){g[b.cache]&&(o[b.cache]=
g[b.cache].slice())}):u(k,function(a,b){u(b.props,function(a,c){var e=b.cache;if(!o[e]&&b.to){if(g[a]==null||a==="alpha")return;o[e]=b.to(o._rgba)}o[e][c.idx]=d(g[a],c,!0)})}),this},is:function(a){var b=c(a),d=!0,e=this;u(k,function(a,c){var g=b[c.cache],f;g&&(f=e[c.cache]||c.to&&c.to(e._rgba)||[],u(c.props,function(a,b){if(g[b.idx]!=null)return d=g[b.idx]==f[b.idx]}));return d});return d},_space:function(){var a=[],b=this;u(k,function(c,d){b[d.cache]&&a.push(c)});return a.pop()},transition:function(a,
b){var e=c(a),g=e._space(),f=k[g],j=this[f.cache]||f.to(this._rgba),o=j.slice(),e=e[f.cache];u(f.props,function(a,c){var g=c.idx,f=j[g],k=e[g],m=n[c.type]||{};k!==null&&(f===null?o[g]=k:(m.mod&&(k-f>m.mod/2?f+=m.mod:f-k>m.mod/2&&(f-=m.mod)),o[c.idx]=d((k-f)*b+f,c)))});return this[g](o)},blend:function(b){if(this._rgba[3]===1)return this;var d=this._rgba.slice(),e=d.pop(),g=c(b)._rgba;return c(a.map(d,function(a,b){return(1-e)*g[b]+e*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,
b){return a==null?b>2?1:0:a});c[3]===1&&(c.pop(),b="rgb(");return b+c.join(",")+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){a==null&&(a=b>2?1:0);b&&b<3&&(a=Math.round(a*100)+"%");return a});c[3]==1&&(c.pop(),b="hsl(");return b+c.join(",")+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();b&&c.push(~~(d*255));return"#"+a.map(c,function(a){a=(a||0).toString(16);return a.length==1?"0"+a:a}).join("")},toString:function(){return this._rgba[3]===0?"transparent":
this.toRgbaString()}};c.fn.parse.prototype=c.fn;k.hsla.to=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,a=a[3],e=Math.max(b,c,d),g=Math.min(b,c,d),f=e-g,k=e+g,j=k*0.5;return[Math.round(g===e?0:b===e?60*(c-d)/f+360:c===e?60*(d-b)/f+120:60*(b-c)/f+240)%360,j===0||j===1?j:j<=0.5?f/k:f/(2-k),j,a==null?1:a]};k.hsla.from=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],a=a[3],c=
d<=0.5?d*(1+c):d+c-d*c,d=2*d-c;return[Math.round(f(d,c,b+1/3)*255),Math.round(f(d,c,b)*255),Math.round(f(d,c,b-1/3)*255),a]};u(k,function(b,f){var k=f.props,j=f.cache,n=f.to,o=f.from;c.fn[b]=function(b){n&&!this[j]&&(this[j]=n(this._rgba));if(b===e)return this[j].slice();var g=a.type(b),f=g==="array"||g==="object"?b:arguments,m=this[j].slice(),p;u(k,function(a,b){var c=f[g==="object"?a:b.idx];c==null&&(c=m[b.idx]);m[b.idx]=d(c,b)});return o?(p=c(o(m)),p[j]=m,p):c(m)};u(k,function(d,e){c.fn[d]||(c.fn[d]=
function(c){var f=a.type(c),k=d==="alpha"?this._hsla?"hsla":"rgba":b,j=this[k](),n=j[e.idx];if(f==="undefined")return n;f==="function"&&(c=c.call(this,n),f=a.type(c));if(c==null&&e.empty)return this;f==="string"&&(f=g.exec(c))&&(c=n+parseFloat(f[2])*(f[1]==="+"?1:-1));j[e.idx]=c;return this[k](j)})})});u(j,function(b,d){a.cssHooks[d]={set:function(b,e){e=c(e);if(!o.rgba&&e._rgba[3]!==1){var g,f=d==="backgroundColor"?b.parentNode:b;do g=a.curCSS(f,"backgroundColor");while((g===""||g==="transparent")&&
(f=f.parentNode)&&f.style);e=e.blend(g&&g!=="transparent"?g:"_default")}e=e.toRgbaString();b.style[d]=e}};a.fx.step[d]=function(b){if(!b.colorInit)b.start=c(b.elem,d),b.end=c(b.end),b.colorInit=!0;a.cssHooks[d].set(b.elem,b.start.transition(b.end,b.pos))}});a(function(){var a=document.createElement("div").style;a.cssText="background-color:rgba(1,1,1,.5)";o.rgba=a.backgroundColor.indexOf("rgba")>-1});r=a.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",
cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",
navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}});redhelper.define("common/extensions/jquery.color",function(){});redhelper.require(["common/extensions/jquery"],function(a){if(window.postMessage)a.postMessage=function(a,d,f){a.postMessage(d,f)},a.receiveMessage=function(a){window.addEventListener("message",a,!1)}});
redhelper.define("common/extensions/jquery.postMessage",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.easing.rh_expIn=function(a,d,f,j){return d==0?f:f+j*Math.pow(2,10*(a-1))};a.easing.rh_expOut=function(a,d,f,j){return a==1?f+j:f+j*(1-Math.pow(2,-10*a))};a.easing.rh_in=function(a,d,f,j){return f+j*a*a*(3*a-2)};a.easing.rh_out=function(a,d,f,j){return f+j*((a-1)*(a-1)*(3*(a-1)+2)+1)};a.easing.rh_bounce=function(a,d,f,j){d=1/2.75;return a<d?f+j*7.5625*a*a:a<2*d?f+j*(7.5625*(a-1.5*d)*(a-1.5*d)+0.75):a<2.5*d?f+j*(7.5625*(a-2.25*d)*(a-2.25*
d)+0.9375):f+j*(7.5625*(a-2.625*d)*(a-2.625*d)+0.984375)}});redhelper.define("common/extensions/jquery.easing",function(){});
redhelper.require(["common/extensions/jquery"],function(a){a.browser.mozilla?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).css("MozUserSelect","none")})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).css("MozUserSelect","")})}):a.browser.webkit?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).css("-webkit-user-select","none")})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).css("-webkit-user-select","")})}):
a.browser.msie?(a.fn.disableTextSelect=function(){return this.each(function(){a(this).bind("selectstart.disableTextSelect",function(){return!1})})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).unbind("selectstart.disableTextSelect")})}):(a.fn.disableTextSelect=function(){return this.each(function(){a(this).bind("mousedown.disableTextSelect",function(){return!1})})},a.fn.enableTextSelect=function(){return this.each(function(){a(this).unbind("mousedown.disableTextSelect")})})});
redhelper.define("common/extensions/jquery.disableSelection",function(){});redhelper.define("common/extensions/jquery.plugins","common/extensions/jquery,common/extensions/jquery.getvisible,common/extensions/jquery.fix,common/extensions/jquery.color,common/extensions/jquery.postMessage,common/extensions/jquery.easing,common/extensions/jquery.disableSelection".split(","),function(a){return a});redhelper.define("common/constants/type",{STRING:0,BOOLEAN:1,INTEGER:2,OBJECT:3});
redhelper.define("common/extensions/base64",{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){for(var e="",d,f,j,g,b,c,k=0,a=Base64._utf8_encode(a);k<a.length;)d=a.charCodeAt(k++),f=a.charCodeAt(k++),j=a.charCodeAt(k++),g=d>>2,d=(d&3)<<4|f>>4,b=(f&15)<<2|j>>6,c=j&63,isNaN(f)?b=c=64:isNaN(j)&&(c=64),e=e+this._keyStr.charAt(g)+this._keyStr.charAt(d)+this._keyStr.charAt(b)+this._keyStr.charAt(c);return e},decode:function(a){for(var e="",d,f,j,g,b,c=0,a=a.replace(/[^A-Za-z0-9\+\/=]/g,
"");c<a.length;)d=this._keyStr.indexOf(a.charAt(c++)),f=this._keyStr.indexOf(a.charAt(c++)),g=this._keyStr.indexOf(a.charAt(c++)),b=this._keyStr.indexOf(a.charAt(c++)),d=d<<2|f>>4,f=(f&15)<<4|g>>2,j=(g&3)<<6|b,e+=String.fromCharCode(d),g!=64&&(e+=String.fromCharCode(f)),b!=64&&(e+=String.fromCharCode(j));return e=Base64._utf8_decode(e)},_utf8_encode:function(a){for(var a=a.replace(/\r\n/g,"\n"),e="",d=0;d<a.length;d++){var f=a.charCodeAt(d);f<128?e+=String.fromCharCode(f):(f>127&&f<2048?e+=String.fromCharCode(f>>
6|192):(e+=String.fromCharCode(f>>12|224),e+=String.fromCharCode(f>>6&63|128)),e+=String.fromCharCode(f&63|128))}return e},_utf8_decode:function(a){for(var e="",d=0,f=0,j=0,g=0;d<a.length;)f=a.charCodeAt(d),f<128?(e+=String.fromCharCode(f),d++):f>191&&f<224?(j=a.charCodeAt(d+1),e+=String.fromCharCode((f&31)<<6|j&63),d+=2):(j=a.charCodeAt(d+1),g=a.charCodeAt(d+2),e+=String.fromCharCode((f&15)<<12|(j&63)<<6|g&63),d+=3);return e}});redhelper.define("common/constants/scope",{SESSION:0,CACHE:1,STORAGE:2});
redhelper.define("common/communication/encoder",{serialize:function(a){return JSON.stringify(a)},parse:function(a){return JSON.parse(a)}});
redhelper.define("common/communication/messageTarget",["common/extensions/jquery.plugins","common/application/eventTarget","common/communication/encoder"],function(a,e,d){function f(d,g,b){this._targetUri=b;this._targetWindow=d;this._origin=g;this._dispatcher=new e("MessageTarget("+g+")");var c=this;a.receiveMessage(function(a){c._handle(a)})}f.prototype={_handle:function(a){if(a.data.indexOf("__rh__")!=-1&&(a=d.parse(a.data.replace("__rh__","")),a._messageType))a.isMessageTarget=!0,this._dispatcher.fire({type:a._messageType,
obj:a})},setOrigin:function(a){this._origin=a},addHandler:function(a,d){this._dispatcher.addEventListener(a,function(a){d(a.obj)})},removeHandlers:function(a){this.dispatcher.removeAllEventListeners(a)},send:function(e,g){typeof g=="undefined"?g={}:typeof g!="object"&&(g={value:g});g._messageType=e;var b="__rh__"+d.serialize(g);a.postMessage(this._targetWindow,b,this._origin,this._targetUri)}};return f});
redhelper.define("common/application/session","common/extensions/jquery.plugins,common/application/eventTarget,common/constants/type,common/extensions/debug,common/extensions/base64,common/constants/scope,common/communication/messageTarget".split(","),function(a,e,d,f,j,g,b){function c(a,b,c){var d=new Date;if(!(p[a]&&p[a]==b+""))p[a]=b+"",b=j.encode(b),b=encodeURIComponent(b)+"; path=/; domain="+n+(c==g.CACHE&&(d.setMinutes(d.getMinutes()+5),!0)||c==g.STORAGE&&(d.setMonth(d.getMonth()+1),!0)?"; expires="+
d.toUTCString():""),document.cookie=a+"="+b}function k(a){if(p[a])return p[a];var b="";document.cookie.split(";").forEach(function(c){c.substr(0,c.indexOf("=")).replace(/^\s+|\s$/g,"")==a&&(b=c.substr(c.indexOf("=")+1))});b=j.decode(decodeURIComponent(b));return p[a]=b}var n="",w="",o=[],r=null,u=null,m={},p=[],q=a.extend(new Image,{dispatcher:new e("Session"),set:function(a,b,d){if(q.get(a)!==""+b){var e="rhlp."+w+"."+(d==g.CACHE?"cache":d==g.STORAGE?"storage":"session"),m=!1,b=(b+"").replace(/;/g,
"_.,"),j=k(e).split(";").map(function(c){return c.split("=")[0]==a?(m=!0,a+"="+b):c}).join(";");m||(j=k(e)+a+"="+b+";");c(e,j,d);q.dispatcher.fire("on"+a.charAt(0).toUpperCase()+a.substr(1)+"Changed");f.sessionLog("COOKIES | "+a+" = "+b)}},get:function(a){var b="";["session","cache","storage"].forEach(function(c){k("rhlp."+w+"."+c).split(";").forEach(function(c){c.substr(0,c.indexOf("="))==a&&(b=c.substr(c.indexOf("=")+1))})});return b.replace(/_\.,/g,";")},init:function(a,b,c,e){w=a;typeof b=="undefined"&&
(b="/");n=b;!e&&window.sessionStorage&&window.localStorage&&q.storageInit(c,a);q._obj=c;for(var k in c)(function(a){var b=function(){var b=q.get(a),e;switch(typeof c[a].type!="undefined"?c[a].type:d.STRING){case d.BOOLEAN:e=b.toLowerCase();e=e=="true"||e=="yes"||e=="ok"||e=="1";break;case d.INTEGER:e=+b;break;case d.OBJECT:try{e=JSON.parse(b)}catch(g){e={}}break;default:e=b}return c[a].value&&b==""?c[a].value:e},e=function(b){var e=c[a].scope;c[a].type==d.OBJECT&&(b=JSON.stringify(b));if(typeof e==
"undefined")e=g.SESSION;q.set(a,b,e)};if(!Object.__defineGetter__&&Object.defineProperty)Object.defineProperty(q,a,{get:b,set:e});else if(q.__defineGetter__)q.__defineGetter__(a,b),q.__defineSetter__(a,e);else{q[a]=b();var f=b();setInterval(function(){q[a]!=f&&(e(q[a]),f=q[a])},100)}})(k);f.sessionLog(["INIT | ",a,b,"isAsync =",!!e+""].join(" "))},addClient:function(a,c,e){u=new b(a,c,e);u.addHandler("readCookie",function(a){var a=JSON.parse(a.value)||q._obj,b={},c;for(c in a)b[c]=q[c];u.send("cookie",
JSON.stringify(b))});u.addHandler("updateCookie",function(a){q[a.name]=q._obj[a.name].type==d.OBJECT?JSON.parse(a.value):a.value});o.push(u)},asyncInit:function(a,c,d,e,g,k){m=e;u=new b(a,"*",k);q.get=function(a){return""+q["_"+a]};q.set=function(a,b,c){q.get(a)!=""+b&&(q["_"+a]=b,u.send("updateCookie",{name:a,value:b,scope:c}),q.dispatcher.fire("on"+a.charAt(0).toUpperCase()+a.substr(1)+"Changed"),f.sessionLog("ASYNC | "+a+" = "+b))};u.addHandler("cookie",function(a){var a=JSON.parse(a.value),b;
for(b in a)q["_"+b]=a[b]||q["_"+b]||"";r&&r()});q.init(c,d,e,!0)},onLoad:function(a){typeof a=="function"&&(r=a);u||r();u.send("readCookie",JSON.stringify(m))},storageInit:function(){q.get=function(a){a="rhlp."+w+"."+a;return sessionStorage.getItem(a)?sessionStorage.getItem(a):localStorage.getItem(a)?localStorage.getItem(a):""};q.set=function(a,b,c){var d=a,a="rhlp."+w+"."+a;localStorage.getItem(a)==b||sessionStorage.getItem(a)==b||(f.sessionLog("STORAGE | "+a+" = "+b),c==g.STORAGE?localStorage.setItem(a,
b):sessionStorage.setItem(a,b),q.dispatcher.fire("on"+d.charAt(0).toUpperCase()+d.substr(1)+"Changed"))}},clear:function(){for(var a in null)a!="vid"&&(q[a]=null[a].value||"")}});return q});redhelper.define("common/constants/chatState",{MINIMIZED:0,INVITATION:1,MAXIMIZED:2,WINDOW:3});
redhelper.define("application/session.objects",["common/application/session","config/setup","common/constants/scope","common/constants/type","common/constants/chatState"],function(a,e,d,f,j){d={vid:{scope:d.STORAGE,type:f.INTEGER,value:0},locale:{scope:d.STORAGE},ip:{scope:d.STORAGE},badge:{value:"badge1.png",scope:d.STORAGE},badgePosition:{value:"left",scope:d.STORAGE},chatColor:{scope:d.STORAGE},chatIntensity:{scope:d.STORAGE},defaultFace:{scope:d.STORAGE},skin:{scope:d.STORAGE},inviteTime:{scope:d.STORAGE},
currentInviteTime:{type:f.INTEGER},firstMessage:{scope:d.STORAGE},currentFirstMessage:{},defaultWelcome:{scope:d.STORAGE},currentWelcome:{},defaultText:{scope:d.STORAGE},currentTopText:{},defaultHeader:{scope:d.STORAGE},currentHeader:{},offlineEnabled:{type:f.BOOLEAN,value:!0,scope:d.STORAGE},offlineText:{},offlineHeader:{},isOnline:{type:f.BOOLEAN},currentOperator:{scope:d.STORAGE},operDisplayName:{scope:d.STORAGE},operAvatar:{scope:d.STORAGE},reconnects:{type:f.INTEGER,value:0},referrer:{scope:d.STORAGE},
isSendMouseActive:{type:f.BOOLEAN,value:!1},currentTypedText:{},chatX:{type:f.INTEGER},chatY:{type:f.INTEGER},chatWidth:{type:f.INTEGER},chatHeight:{type:f.INTEGER},currentChatX:{type:f.INTEGER},currentChatY:{type:f.INTEGER},lastVisit:{value:"1/1/2000",scope:d.STORAGE},currentChatWidth:{type:f.INTEGER},currentChatHeight:{type:f.INTEGER},chatState:{type:f.INTEGER,value:j.MINIMIZED},stringChatState:{scope:d.STORAGE},mouseOperators:{scope:d.STORAGE},previousDay:{value:"1/1/2000",scope:d.STORAGE},badgeColor:{},
badgeText:{},badgeFontSize:{type:f.INTEGER,value:0},badgePadding:{type:f.INTEGER,value:0},badgeX:{type:f.INTEGER,value:"70%"},badgeY:{type:f.INTEGER,value:"40%"},cachedEvent:{},region:{scope:d.SESSION},city:{scope:d.SESSION},country:{scope:d.SESSION},time:{type:f.INTEGER,value:0},lastVisitTime:{type:f.INTEGER,value:0},visits:{type:f.INTEGER,value:1},viewedPages:{type:f.INTEGER,value:1},trigger:{},inviteState:{value:""},rid:{value:0,type:f.INTEGER},sid:{value:""},reconnecting:{value:!1,type:f.BOOLEAN}};
e.STANDALONE?a.init(e.CLIENT_NAME,".redhelper.ru",d):a.asyncInit(parent,e.CLIENT_NAME,".redhelper.ru",d,function(){},e.PARENT_URI);return a});
redhelper.define("config/lang",["application/session.objects"],function(a){var e={CHAT_LABEL:"",YOU_LABEL:"",EMAIL_INCORRECT:"",FAILED_TO_SEND:"",INCORRECT_EMAIL:"",NOT_ALL_FIELDS:"",MAIL_SUCCESS:"",MAIL_SENT:"",SEND_BUTTON:"",THROBBER:"",MESSAGE_LABEL:"",EMAIL_LABEL:"",NAME_LABEL:"",OFFLINE_HEADER:"",OFFLINE_TEXT:"",PAGE_TITLE:"",URL_NEW_TAB:"",TITLE_NEW_TAB:"",WEBSITE:"",TYPING_LABEL:"",PROMPT_LABEL:"",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"",OPERATOR_REDIRECT:"",OPERATOR_REDIRECT_OK:""};
e.initLanguage=function(){if(a.locale=="en")e.CHAT_LABEL="Type your message here",e.YOU_LABEL="You",e.EMAIL_INCORRECT="The email you specified is incorrect",e.FAILED_TO_SEND="Failed to send message",e.INCORRECT_EMAIL="The email is incorrect",e.NOT_ALL_FIELDS="Not all fields filled",e.MAIL_SUCCESS="Your message has been sent successfully",e.MAIL_SENT="The message has been sent",e.SEND_BUTTON="Send",e.THROBBER="Wait please...",e.MESSAGE_LABEL="Message:",e.EMAIL_LABEL="Your e-mail:",e.NAME_LABEL="Your name:",
e.OFFLINE_HEADER="Feedback form",e.OFFLINE_TEXT="We are offline at the moment. Please leave a message and we will answer it by email.",e.PAGE_TITLE="Live Chat",e.URL_NEW_TAB="in a separate tab",e.TITLE_NEW_TAB="in a separate tab",e.WEBSITE="http://redhelper.net",e.TYPING_LABEL=" is typing",e.PROMPT_LABEL="Operator wants to redirect you to another page. Allow?",e.PROMPT_BUTTON_YES="Yes",e.PROMPT_BUTTON_NO="No",e.NOTIFICATION_HEADER="Message from operator",e.OPERATOR_REDIRECT="Operator wants to switch you",
e.OPERATOR_REDIRECT_OK="You are now chatting with ";if(a.locale=="ru")e.CHAT_LABEL="\u0412\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",e.YOU_LABEL="\u0412\u044b",e.EMAIL_INCORRECT="\u0412\u044b \u0432\u0432\u0435\u043b\u0438 \u043d\u0435\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 e-mail",e.FAILED_TO_SEND="\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",
e.INCORRECT_EMAIL="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 email \u0430\u0434\u0440\u0435\u0441\u0430",e.NOT_ALL_FIELDS="\u0412\u044b \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u043b\u0438 \u043d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f",e.MAIL_SUCCESS="\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",e.MAIL_SENT="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",
e.SEND_BUTTON="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",e.THROBBER="\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430...",e.MESSAGE_LABEL="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435:",e.EMAIL_LABEL="\u0412\u0430\u0448 e-mail:",e.NAME_LABEL="\u0412\u0430\u0448\u0435 \u0438\u043c\u044f:",e.OFFLINE_HEADER="\u0424\u043e\u0440\u043c\u0430 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u0438",e.OFFLINE_TEXT="\u0412\u0441\u0435 \u043d\u0430\u0448\u0438 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0441\u0435\u0439\u0447\u0430\u0441 \u043e\u0444\u043b\u0430\u0439\u043d. \u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438 \u043c\u044b \u043e\u0442\u0432\u0435\u0442\u0438\u043c \u043d\u0430 \u043d\u0435\u0433\u043e \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f.",
e.PAGE_TITLE="\u041e\u043d\u043b\u0430\u0439\u043d \u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442",e.URL_NEW_TAB="\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0432\u043a\u043b\u0430\u0434\u043a\u0435",e.TITLE_NEW_TAB="\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0432\u043a\u043b\u0430\u0434\u043a\u0435",e.WEBSITE="http://redhelper.ru",e.TYPING_LABEL=" \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442",e.PROMPT_LABEL="\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0412\u0430\u043c \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443. \u041f\u0435\u0440\u0435\u0439\u0442\u0438?",
e.PROMPT_BUTTON_YES="\u0414\u0430",e.PROMPT_BUTTON_NO="\u041d\u0435\u0442",e.NOTIFICATION_HEADER="\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430",e.OPERATOR_REDIRECT="\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0447\u0430\u0442 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443",e.OPERATOR_REDIRECT_OK="\u041a \u0432\u0430\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 "};
e.initLanguage();return e});redhelper.define("common/constants/sender",{VISITOR:0,OPERATOR:1});redhelper.define("application/parent",[],function(){});
redhelper.define("common/application/time",[],function(){var a=null,e=null,d={now:function(){a=new Date;return d},parse:function(f){a=new Date(Date.parse(f));if(!e)return this;a.setHours(a.getHours()+e[0]);a.setMinutes(a.getMinutes()+e[1]);a.setSeconds(a.getSeconds()+e[2]);return d},setTimeDifference:function(a){var j=a.split(" ")[1]=="PM"?12:0,a=a.split(" ")[0].split(":");a[0]=+a[0]+j;var j=new Date,g=[j.getHours(),j.getMinutes(),j.getSeconds()];e=a.map(function(a,c){return g[c]-a});return d},toString:function(){if(!a)return"";
var d=[a.getHours(),a.getMinutes(),a.getSeconds()];d.forEach(function(a,e){a<10&&(d[e]="0"+a)});return d.join(":")},getTime:function(){return a.getTime()}};return d});
redhelper.define("view/chat","common/extensions/jquery.plugins,application/dispatcher,common/constants/sender,application/session.objects,config/lang,common/constants/chatState,application/parent,common/application/time".split(","),function(a,e,d,f,j,g,b,c){a.valHooks.textarea={get:function(a){return a.value.replace(/\r?\n/g,"\r\n")}};var k={_displayElem:null,_lastMessageFrom:null,_typingTimer:0,_isTyping:!1,_messages:[],_highlightLinks:function(a){return a.replace(/((http|https|ftp)[:][/][/])?(([\w\d_\-]+)\.)+\w{2,}([/]\S*)*/g,
function(a){return'<a target="_blank" href="'+(a.indexOf("://")!=-1?"":"http://")+a+'">'+a+"</a>"})},_escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br>")},_decorate:function(b,c,e,g,f){var k=typeof e!="undefined";typeof c=="undefined"&&(c=!1);var j=b.text;c||(j=!g?this._highlightLinks(this._escapeHtml(b.text)):b.text);g=b.sender==d.OPERATOR?"fromOperator":"fromVisitor";f='<div id="'+b.id+'" class="msg'+(f?" "+
f:"")+(c?" invitation":"")+'">'+(this._lastMessageFrom!=b.sender||c?'<div class="msgHeader '+g+'"><span class="sender '+g+'">'+b.displayName+":</span></div>":"")+'<span class="time">'+b.time+'</span><div class="textWrapper"><div class="text">'+j+"</div></div></div>";k&&(this._lastMessageFrom!=b.sender?a(".msgBlock").length?a(".msgBlock:last",e).after('<div class="msgBlock '+g+'">'+f+"</div>"):a("#invitation",e).after('<div class="msgBlock '+g+'">'+f+"</div>"):a(".msgBlock:last",e).append(f));if(!c)this._lastMessageFrom=
b.sender;return f},setOutput:function(b){this._displayElem=typeof b=="string"?a(b):b;this._displayElem.on("click",".promptButton",function(){if(a(this).hasClass("yes"))return e.fire("redirectOK",{link:a(this).data("link")}),!1;else a(this).parents(".msg").fadeOut("slow",function(){if(!a(this).siblings().length)k._lastMessageFrom=d.VISITOR,a(this).parents(".msgBlock").remove();e.fire("redirectCancel")})})},append:function(a){if(!a.hide&&!(a.text.indexOf(":g")==0||a.text.indexOf(":\u0433")==0)){for(var b=
this._messages.length-1;b>0&&this._messages[b].id&&this._messages[b].id>a.id;b++);a.pushAfter=b>0?this._messages[b].id:0;if(!a.pushAfter||!(a.pushAfter==a.id&&this._messages[b].text==a.text))if(this._messages.push(a),this._messages.sort(function(a,b){return a.id&&b.id?a.id-b.id:(a.time<b.time)*-1+(a.time>b.time)*1}),this._displayElem){if(a.sender==d.VISITOR)a.displayName=j.YOU_LABEL;if(!a.time)a.time=c.now().toString();this._decorate(a,!1,this._displayElem);this.scrollBottom()}}},showTyping:function(){if(this._displayElem&&
!this._isTyping){this._isTyping=!0;a("#typingLabel .text").html(f.operDisplayName+j.TYPING_LABEL+"...");a("#typingLabel").show();var b=3,c=a("#typingLabel .text",this._displayElem);this._typingTimer=setInterval(function(){b>2?(c.html(f.operDisplayName+j.TYPING_LABEL),b=0):(c.html(c.html()+"."),b++)},800);this.scrollBottom()}},showLabel:function(b){this._displayElem&&(a("#chatLabel .text").html(b),a("#chatLabel").show(),this.scrollBottom())},hideLabel:function(){this._displayElem&&(a("#chatLabel").hide(),
this.scrollBottom())},hideTyping:function(){if(this._displayElem&&this._isTyping)a("#typingLabel").hide(),clearInterval(this._typingTimer),this._isTyping=!1},showFirstMessage:function(a){if(this._displayElem){if(a.sender==d.VISITOR)a.displayName=j.YOU_LABEL;this._displayElem.prepend(this._decorate(a,!0));this.scrollBottom()}},scrollBottom:function(){var a=this._displayElem[0];a.scrollTop=a.scrollHeight},clear:function(){this._displayElem.html("");this._lastMessageFrom=null},showRedirectPrompt:function(a){this._displayElem&&
(a.indexOf("://")<0&&(a="http://"+a),a='<div class="promptButtonWrapper"><div class="promptButton no">'+j.PROMPT_BUTTON_NO+'</div><div class="promptButton yes" data-link="'+a+'">'+j.PROMPT_BUTTON_YES+'</div><div style="clear: both"></div></div>',this._decorate({displayName:f.operDisplayName,sender:d.OPERATOR,time:c.now().toString(),text:j.PROMPT_LABEL+a},!1,this._displayElem,!0,"prompt"),this.scrollBottom(),this.hideTyping(),f.chatState==g.MINIMIZED&&b.send("openChat"))},switchOperator:function(){if(k._lastMessageFrom==
d.OPERATOR)k._lastMessageFrom=null}};return k});
redhelper.define("view/view","application/session.objects,config/lang,config/setup,common/extensions/jquery.plugins,view/chat,common/constants/sender,application/dispatcher".split(","),function(a,e,d,f,j,g,b){var c={_firstMessageAppended:!1,initLanguage:function(){if(a.locale){if(e.initLanguage(),f("#offline .header").html(e.OFFLINE_HEADER),f("#offline .description").html(e.OFFLINE_TEXT),f(".name label").html(e.NAME_LABEL),f(".email label").html(e.EMAIL_LABEL),f(".message label").html(e.MESSAGE_LABEL),
f("#sendButton").text(e.SEND_BUTTON),f("#throbber").text(e.THROBBER),f("#offlineSuccess div").text(e.MAIL_SUCCESS),f("#footer a").attr("href",e.WEBSITE),f("#typingLabel .text").html(e.TYPING_LABEL),!f("#online textarea").is(":focus"))f("#online textarea").val((tmp=a.currentTypedText,tmp)?tmp:e.CHAT_LABEL)}else setTimeout(function(){c.initLanguage()},100)},show:function(){if(!d.empty(a.skin)&&!d.empty(a.isOnline))c.initLanguage(),document.title=d.PAGE_TITLE,a.offlineText&&f("#offline .description").html(a.offlineText),
a.offlineHeader&&f("#offline .header").html(a.offlineHeader),a.currentHeader?f("#topHeader").html(a.currentHeader):f("#topHeader").html(a.defaultHeader),a.currentTopText?f("#topText").html(a.currentTopText):f("#topText").html(a.defaultText),a.chatColor&&f(".colorifier").css("background","#"+a.chatColor),a.dispatcher.addEventListener("onChatColorChanged",function(){a.chatColor?f(".colorifier").css("background","#"+a.chatColor):f(".colorifier").css("background","none")}),a.chatIntensity&&f(".colorifier").css({opacity:a.chatIntensity/
600,filter:"alpha(opacity = "+Math.round(a.chatIntensity/6)+")"}),a.dispatcher.addEventListener("onChatIntensityChanged",function(){a.chatIntensity?f(".colorifier").css({opacity:a.chatIntensity/600,filter:"alpha(opacity = "+Math.round(a.chatIntensity/6)+")"}):f(".colorifier").css({opacity:0.6,filter:"alpha(opacity = 60)"})}),a.defaultFace&&d.DATA_URL&&f("#face").attr("src",d.DATA_URL+"/images/"+(a.operAvatar?a.operAvatar:a.defaultFace)),a.dispatcher.addEventListener("onOperAvatarChanged",function(){if(d.DATA_URL&&
(a.operAvatar||a.defaultFace))f("#face").attr("src",d.DATA_URL+"/images/"+(a.operAvatar?a.operAvatar:a.defaultFace))}),a.dispatcher.addEventListener("onFaceChanged",function(){if(d.DATA_URL&&(a.operAvatar||a.defaultFace))f("#face").attr("src",d.DATA_URL+"/images/"+(a.operAvatar?a.operAvatar:a.defaultFace))}),f(".topPanel, #footer, #sendButton, label").disableTextSelect(),f(".topPanel").mousedown(function(a){a.stopPropagation()}),f(a.isOnline?"#offline":"#online").hide(),f(a.isOnline?"#online":"#offline").show(),
b.addEventListener("typing",function(){j.showTyping();j.hideLabel()}),b.addEventListener("message",function(a){a.sender==g.OPERATOR&&j.hideTyping();j.hideLabel()}),b.addEventListener("operatorRedirect",function(){j.showLabel(e.OPERATOR_REDIRECT)}),b.removeAllEventListeners("operatorRedirectOk"),b.addEventListener("operatorRedirectOk",function(a){j.hideLabel();j.switchOperator();a=e.OPERATOR_REDIRECT_OK+a.displayName;j.hideTyping();j.showLabel(a)}),b.addEventListener("operatorRedirectFail",function(){j.hideLabel()})},
hide:function(){f("#online, #offline").hide()}};return c});
var Base64=function(){return{encode:function(a){var e="",d,f,j,g,b,c,k=0;do d=a.charCodeAt(k++),f=a.charCodeAt(k++),j=a.charCodeAt(k++),g=d>>2,d=(d&3)<<4|f>>4,b=(f&15)<<2|j>>6,c=j&63,isNaN(f)?b=c=64:isNaN(j)&&(c=64),e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);
while(k<a.length);return e},decode:function(a){var e="",d,f,j,g,b,c=0,a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c++)),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c++)),d=d<<2|f>>4,f=(f&15)<<
4|g>>2,j=(g&3)<<6|b,e+=String.fromCharCode(d),g!=64&&(e+=String.fromCharCode(f)),b!=64&&(e+=String.fromCharCode(j));while(c<a.length);return e}}}(),MD5=function(){var a=function(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535},e=function(a){for(var b=[],c=0;c<a.length*8;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<c%32;return b},d=function(a){for(var b="",c=0;c<a.length*32;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b},f=function(a){for(var b="",c=0;c<a.length*4;c++)b+=
"0123456789abcdef".charAt(a[c>>2]>>c%4*8+4&15)+"0123456789abcdef".charAt(a[c>>2]>>c%4*8&15);return b},j=function(a){for(var b="",c,d,e=0;e<a.length*4;e+=3){c=(a[e>>2]>>8*(e%4)&255)<<16|(a[e+1>>2]>>8*((e+1)%4)&255)<<8|a[e+2>>2]>>8*((e+2)%4)&255;for(d=0;d<4;d++)b+=e*8+d*6>a.length*32?"":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>6*(3-d)&63)}return b},g=function(b,c,d,e,g,f){b=a(a(c,b),a(e,f));return a(b<<g|b>>>32-g,d)},b=function(a,b,c,d,e,f,k){return g(b&c|~b&d,a,
b,e,f,k)},c=function(a,b,c,d,e,f,k){return g(b&d|c&~d,a,b,e,f,k)},k=function(a,b,c,d,e,f,k){return g(c^(b|~d),a,b,e,f,k)},n=function(d,e){d[e>>5]|=128<<e%32;d[(e+64>>>9<<4)+14]=e;for(var f=1732584193,m=-271733879,j=-1732584194,n=271733878,w,y,H,z,t=0;t<d.length;t+=16)w=f,y=m,H=j,z=n,f=b(f,m,j,n,d[t+0],7,-680876936),n=b(n,f,m,j,d[t+1],12,-389564586),j=b(j,n,f,m,d[t+2],17,606105819),m=b(m,j,n,f,d[t+3],22,-1044525330),f=b(f,m,j,n,d[t+4],7,-176418897),n=b(n,f,m,j,d[t+5],12,1200080426),j=b(j,n,f,m,d[t+
6],17,-1473231341),m=b(m,j,n,f,d[t+7],22,-45705983),f=b(f,m,j,n,d[t+8],7,1770035416),n=b(n,f,m,j,d[t+9],12,-1958414417),j=b(j,n,f,m,d[t+10],17,-42063),m=b(m,j,n,f,d[t+11],22,-1990404162),f=b(f,m,j,n,d[t+12],7,1804603682),n=b(n,f,m,j,d[t+13],12,-40341101),j=b(j,n,f,m,d[t+14],17,-1502002290),m=b(m,j,n,f,d[t+15],22,1236535329),f=c(f,m,j,n,d[t+1],5,-165796510),n=c(n,f,m,j,d[t+6],9,-1069501632),j=c(j,n,f,m,d[t+11],14,643717713),m=c(m,j,n,f,d[t+0],20,-373897302),f=c(f,m,j,n,d[t+5],5,-701558691),n=c(n,f,
m,j,d[t+10],9,38016083),j=c(j,n,f,m,d[t+15],14,-660478335),m=c(m,j,n,f,d[t+4],20,-405537848),f=c(f,m,j,n,d[t+9],5,568446438),n=c(n,f,m,j,d[t+14],9,-1019803690),j=c(j,n,f,m,d[t+3],14,-187363961),m=c(m,j,n,f,d[t+8],20,1163531501),f=c(f,m,j,n,d[t+13],5,-1444681467),n=c(n,f,m,j,d[t+2],9,-51403784),j=c(j,n,f,m,d[t+7],14,1735328473),m=c(m,j,n,f,d[t+12],20,-1926607734),f=g(m^j^n,f,m,d[t+5],4,-378558),n=g(f^m^j,n,f,d[t+8],11,-2022574463),j=g(n^f^m,j,n,d[t+11],16,1839030562),m=g(j^n^f,m,j,d[t+14],23,-35309556),
f=g(m^j^n,f,m,d[t+1],4,-1530992060),n=g(f^m^j,n,f,d[t+4],11,1272893353),j=g(n^f^m,j,n,d[t+7],16,-155497632),m=g(j^n^f,m,j,d[t+10],23,-1094730640),f=g(m^j^n,f,m,d[t+13],4,681279174),n=g(f^m^j,n,f,d[t+0],11,-358537222),j=g(n^f^m,j,n,d[t+3],16,-722521979),m=g(j^n^f,m,j,d[t+6],23,76029189),f=g(m^j^n,f,m,d[t+9],4,-640364487),n=g(f^m^j,n,f,d[t+12],11,-421815835),j=g(n^f^m,j,n,d[t+15],16,530742520),m=g(j^n^f,m,j,d[t+2],23,-995338651),f=k(f,m,j,n,d[t+0],6,-198630844),n=k(n,f,m,j,d[t+7],10,1126891415),j=k(j,
n,f,m,d[t+14],15,-1416354905),m=k(m,j,n,f,d[t+5],21,-57434055),f=k(f,m,j,n,d[t+12],6,1700485571),n=k(n,f,m,j,d[t+3],10,-1894986606),j=k(j,n,f,m,d[t+10],15,-1051523),m=k(m,j,n,f,d[t+1],21,-2054922799),f=k(f,m,j,n,d[t+8],6,1873313359),n=k(n,f,m,j,d[t+15],10,-30611744),j=k(j,n,f,m,d[t+6],15,-1560198380),m=k(m,j,n,f,d[t+13],21,1309151649),f=k(f,m,j,n,d[t+4],6,-145523070),n=k(n,f,m,j,d[t+11],10,-1120210379),j=k(j,n,f,m,d[t+2],15,718787259),m=k(m,j,n,f,d[t+9],21,-343485551),f=a(f,w),m=a(m,y),j=a(j,H),n=
a(n,z);return[f,m,j,n]},w=function(a,b){var c=e(a);c.length>16&&(c=n(c,a.length*8));for(var d=Array(16),f=Array(16),g=0;g<16;g++)d[g]=c[g]^909522486,f[g]=c[g]^1549556828;c=n(d.concat(e(b)),512+b.length*8);return n(f.concat(c),640)};return{hexdigest:function(a){return f(n(e(a),a.length*8))},b64digest:function(a){return j(n(e(a),a.length*8))},hash:function(a){return d(n(e(a),a.length*8))},hmac_hexdigest:function(a,b){return f(w(a,b))},hmac_b64digest:function(a,b){return j(w(a,b))},hmac_hash:function(a,
b){return d(w(a,b))},test:function(){return MD5.hexdigest("abc")==="900150983cd24fb0d6963f7d28e17f72"}}}();if(!Function.prototype.bind)Function.prototype.bind=function(a){var e=this,d=Array.prototype.slice,f=Array.prototype.concat,j=d.call(arguments,1);return function(){return e.apply(a?a:this,f.call(j,d.call(arguments,0)))}};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,e){var d=this.length,f=Number(e)||0,f=f<0?Math.ceil(f):Math.floor(f);for(f<0&&(f+=d);f<d;f++)if(f in this&&this[f]===a)return f;return-1};
(function(a){function e(a,c){return new g.Builder(a,c)}function d(a){return new g.Builder("message",a)}function f(a){return new g.Builder("iq",a)}function j(a){return new g.Builder("presence",a)}var g;g={VERSION:"1.0.2",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",
SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas"},addNamespace:function(a,c){g.NS[a]=c},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4},TIMEOUT:1.1,
SECONDARY_TIMEOUT:0.1,forEachChild:function(a,c,d){var e,f;for(e=0;e<a.childNodes.length;e++)f=a.childNodes[e],f.nodeType==g.ElementType.NORMAL&&(!c||this.isTagEqual(f,c))&&d(f)},isTagEqual:function(a,c){return a.tagName.toLowerCase()==c.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var a;document.implementation.createDocument===void 0?(a=this._getIEXmlDom(),a.appendChild(a.createElement("strophe"))):a=document.implementation.createDocument("jabber:client","strophe",null);return a},
xmlGenerator:function(){if(!g._xmlGenerator)g._xmlGenerator=g._makeGenerator();return g._xmlGenerator},_getIEXmlDom:function(){for(var a=null,c="Msxml2.DOMDocument.6.0,Msxml2.DOMDocument.5.0,Msxml2.DOMDocument.4.0,MSXML2.DOMDocument.3.0,MSXML2.DOMDocument,MSXML.DOMDocument,Microsoft.XMLDOM".split(","),d=0;d<c.length;d++)if(a===null)try{a=new ActiveXObject(c[d])}catch(e){a=null}else break;return a},xmlElement:function(a){if(!a)return null;var c=g.xmlGenerator().createElement(a),d,e,f;for(d=1;d<arguments.length;d++)if(arguments[d])if(typeof arguments[d]==
"string"||typeof arguments[d]=="number")c.appendChild(g.xmlTextNode(arguments[d]));else if(typeof arguments[d]=="object"&&typeof arguments[d].sort=="function")for(e=0;e<arguments[d].length;e++)typeof arguments[d][e]=="object"&&typeof arguments[d][e].sort=="function"&&c.setAttribute(arguments[d][e][0],arguments[d][e][1]);else if(typeof arguments[d]=="object")for(f in arguments[d])arguments[d].hasOwnProperty(f)&&c.setAttribute(f,arguments[d][f]);return c},xmlescape:function(a){a=a.replace(/\&/g,"&amp;");
a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/'/g,"&apos;");return a=a.replace(/"/g,"&quot;")},xmlTextNode:function(a){a=g.xmlescape(a);return g.xmlGenerator().createTextNode(a)},getText:function(a){if(!a)return null;var c="";a.childNodes.length===0&&a.nodeType==g.ElementType.TEXT&&(c+=a.nodeValue);for(var d=0;d<a.childNodes.length;d++)a.childNodes[d].nodeType==g.ElementType.TEXT&&(c+=a.childNodes[d].nodeValue);return c},copyElement:function(a){var c,d;if(a.nodeType==g.ElementType.NORMAL){d=
g.xmlElement(a.tagName);for(c=0;c<a.attributes.length;c++)d.setAttribute(a.attributes[c].nodeName.toLowerCase(),a.attributes[c].value);for(c=0;c<a.childNodes.length;c++)d.appendChild(g.copyElement(a.childNodes[c]))}else a.nodeType==g.ElementType.TEXT&&(d=g.xmlGenerator().createTextNode(a.nodeValue));return d},escapeNode:function(a){return a.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,
"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(a){return a.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(a){return a.indexOf("@")<0?null:a.split("@")[0]},getDomainFromJid:function(a){a=g.getBareJidFromJid(a);return a.indexOf("@")<0?a:(a=a.split("@"),a.splice(0,1),
a.join("@"))},getResourceFromJid:function(a){a=a.split("/");if(a.length<2)return null;a.splice(0,1);return a.join("/")},getBareJidFromJid:function(a){return a?a.split("/")[0]:null},log:function(){},debug:function(a){this.log(this.LogLevel.DEBUG,a)},info:function(a){this.log(this.LogLevel.INFO,a)},warn:function(a){this.log(this.LogLevel.WARN,a)},error:function(a){this.log(this.LogLevel.ERROR,a)},fatal:function(a){this.log(this.LogLevel.FATAL,a)},serialize:function(a){var c;if(!a)return null;typeof a.tree===
"function"&&(a=a.tree());var d=a.nodeName,e,f;a.getAttribute("_realname")&&(d=a.getAttribute("_realname"));c="<"+d;for(e=0;e<a.attributes.length;e++)a.attributes[e].nodeName!="_realname"&&(c+=" "+a.attributes[e].nodeName.toLowerCase()+"='"+a.attributes[e].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/</g,"&lt;")+"'");if(a.childNodes.length>0){c+=">";for(e=0;e<a.childNodes.length;e++)switch(f=a.childNodes[e],f.nodeType){case g.ElementType.NORMAL:c+=g.serialize(f);break;case g.ElementType.TEXT:c+=
g.xmlescape(f.nodeValue);break;case g.ElementType.CDATA:c+="<![CDATA["+f.nodeValue+"]]\>"}c+="</"+d+">"}else c+="/>";return c},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(a,c){g._connectionPlugins[a]=c}};g.Builder=function(a,c){if(a=="presence"||a=="message"||a=="iq")c&&!c.xmlns?c.xmlns=g.NS.CLIENT:c||(c={xmlns:g.NS.CLIENT});this.node=this.nodeTree=g.xmlElement(a,c)};g.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return g.serialize(this.nodeTree)},
up:function(){this.node=this.node.parentNode;return this},attrs:function(a){for(var c in a)a.hasOwnProperty(c)&&this.node.setAttribute(c,a[c]);return this},c:function(a,c,d){a=g.xmlElement(a,c,d);this.node.appendChild(a);if(!d)this.node=a;return this},cnode:function(a){var c=g.xmlGenerator();try{var d=c.importNode!==void 0}catch(e){d=!1}a=d?c.importNode(a,!0):g.copyElement(a);this.node.appendChild(a);this.node=a;return this},t:function(a){this.node.appendChild(g.xmlTextNode(a));return this}};g.Handler=
function(a,c,d,e,f,j,r){this.handler=a;this.ns=c;this.name=d;this.type=e;this.id=f;this.options=r||{matchbare:!1};if(!this.options.matchBare)this.options.matchBare=!1;this.from=this.options.matchBare?j?g.getBareJidFromJid(j):null:j;this.user=!0};g.Handler.prototype={isMatch:function(a){var c,d=null,d=this.options.matchBare?g.getBareJidFromJid(a.getAttribute("from")):a.getAttribute("from");c=!1;if(this.ns){var e=this;g.forEachChild(a,null,function(a){a.getAttribute("xmlns")==e.ns&&(c=!0)});c=c||a.getAttribute("xmlns")==
this.ns}else c=!0;return c&&(!this.name||g.isTagEqual(a,this.name))&&(!this.type||a.getAttribute("type")==this.type)&&(!this.id||a.getAttribute("id")==this.id)&&(!this.from||d==this.from)?!0:!1},run:function(a){var c=null;try{c=this.handler(a)}catch(d){throw d.sourceURL?g.fatal("error: "+this.handler+" "+d.sourceURL+":"+d.line+" - "+d.name+": "+d.message):d.fileName?(typeof console!="undefined"&&(console.trace(),console.error(this.handler," - error - ",d,d.message)),g.fatal("error: "+this.handler+
" "+d.fileName+":"+d.lineNumber+" - "+d.name+": "+d.message)):g.fatal("error: "+this.handler),d;}return c},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}};g.TimedHandler=function(a,c){this.period=a;this.handler=c;this.lastCalled=(new Date).getTime();this.user=!0};g.TimedHandler.prototype={run:function(){this.lastCalled=(new Date).getTime();return this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+
this.handler+"("+this.period+")}"}};g.Request=function(a,c,d,e){this.id=++g._requestId;this.xmlData=a;this.data=g.serialize(a);this.func=this.origFunc=c;this.rid=d;this.date=NaN;this.sends=e||0;this.abort=!1;this.dead=null;this.age=function(){return!this.date?0:(new Date-this.date)/1E3};this.timeDead=function(){return!this.dead?0:(new Date-this.dead)/1E3};this.xhr=this._newXHR()};g.Request.prototype={getResponse:function(){var a=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(a=
this.xhr.responseXML.documentElement,a.tagName=="parsererror")throw g.error("invalid response received"),g.error("responseText: "+this.xhr.responseText),g.error("responseXML: "+g.serialize(this.xhr.responseXML)),"parsererror";}else this.xhr.responseText&&(g.error("invalid response received"),g.error("responseText: "+this.xhr.responseText),g.error("responseXML: "+g.serialize(this.xhr.responseXML)));return a},_newXHR:function(){var a=null;window.XMLHttpRequest?(a=new XMLHttpRequest,a.overrideMimeType&&
a.overrideMimeType("text/xml")):window.ActiveXObject&&(a=new ActiveXObject("Microsoft.XMLHTTP"));a.onreadystatechange=this.func.bind(null,this);return a}};g.Connection=function(a){this.service=a;this.jid="";this.rid=Math.floor(Math.random()*4294967295);this.features=this.streamId=this.sid=null;this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._disconnectTimeout=this._idleTimeout=null;this.connected=
this.disconnecting=this.authenticated=!1;this.errors=0;this.paused=!1;this.hold=1;this.wait=60;this.window=5;this._data=[];this._requests=[];this._uniqueId=Math.round(Math.random()*1E4);this._sasl_challenge_handler=this._sasl_failure_handler=this._sasl_success_handler=null;this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var c in g._connectionPlugins)if(g._connectionPlugins.hasOwnProperty(c))a=function(){},a.prototype=g._connectionPlugins[c],this[c]=new a,this[c].init(this)};g.Connection.prototype=
{reset:function(){this.rid=Math.floor(Math.random()*4294967295);this.streamId=this.sid=null;this.do_bind=this.do_session=!1;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this.connected=this.disconnecting=this.authenticated=!1;this.errors=0;this._requests=[];this._uniqueId=Math.round(Math.random()*1E4)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(a){return typeof a=="string"||typeof a==
"number"?++this._uniqueId+":"+a:++this._uniqueId+""},connect:function(a,c,d,e,f){this.jid=a;this.pass=c;this.connect_callback=d;this.authenticated=this.connected=this.disconnecting=!1;this.errors=0;this.wait=e||this.wait;this.hold=f||this.hold;this.domain=g.getDomainFromJid(this.jid);a=this._buildBody().attrs({to:this.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":g.NS.BOSH});this._changeConnectStatus(g.Status.CONNECTING,
null);this._requests.push(new g.Request(a.tree(),this._onRequestStateChange.bind(this,this._connect_cb.bind(this)),a.tree().getAttribute("rid")));this._throttledRequestHandler()},attach:function(a,c,d,e,f,j,r){this.jid=a;this.sid=c;this.rid=d;this.connect_callback=e;this.domain=g.getDomainFromJid(this.jid);this.connected=this.authenticated=!0;this.wait=f||this.wait;this.hold=j||this.hold;this.window=r||this.window;this._changeConnectStatus(g.Status.ATTACHED,null)},xmlInput:function(){},xmlOutput:function(){},
rawInput:function(){},rawOutput:function(){},send:function(a){if(a!==null){if(typeof a.sort==="function")for(var c=0;c<a.length;c++)this._queueData(a[c]);else typeof a.tree==="function"?this._queueData(a.tree()):this._queueData(a);this._throttledRequestHandler();clearTimeout(this._idleTimeout);this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}},flush:function(){clearTimeout(this._idleTimeout);this._onIdle()},sendIQ:function(a,c,d,e){var f=null,g=this;typeof a.tree==="function"&&(a=a.tree());
var j=a.getAttribute("id");j||(j=this.getUniqueId("sendIQ"),a.setAttribute("id",j));var u=this.addHandler(function(a){f&&g.deleteTimedHandler(f);var b=a.getAttribute("type");if(b=="result")c&&c(a);else if(b=="error")d&&d(a);else throw{name:"StropheError",message:"Got bad IQ type of "+b};},null,"iq",null,j);e&&(f=this.addTimedHandler(e,function(){g.deleteHandler(u);d&&d(null);return!1}));this.send(a);return j},_queueData:function(a){if(a===null||!a.tagName||!a.childNodes)throw{name:"StropheError",
message:"Cannot queue non-DOMElement."};this._data.push(a)},_sendRestart:function(){this._data.push("restart");this._throttledRequestHandler();clearTimeout(this._idleTimeout);this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(a,c){var d=new g.TimedHandler(a,c);this.addTimeds.push(d);return d},deleteTimedHandler:function(a){this.removeTimeds.push(a)},addHandler:function(a,c,d,e,f,j,r){a=new g.Handler(a,c,d,e,f,j,r);this.addHandlers.push(a);return a},deleteHandler:function(a){this.removeHandlers.push(a)},
disconnect:function(a){this._changeConnectStatus(g.Status.DISCONNECTING,a);g.info("Disconnect was called because: "+a);if(this.connected)this._disconnectTimeout=this._addSysTimedHandler(3E3,this._onDisconnectTimeout.bind(this)),this._sendTerminate()},_changeConnectStatus:function(a,c){for(var d in g._connectionPlugins)if(g._connectionPlugins.hasOwnProperty(d)){var e=this[d];if(e.statusChanged)try{e.statusChanged(a,c)}catch(f){g.error(""+d+" plugin caused an exception changing status: "+f)}}if(this.connect_callback)try{this.connect_callback(a,
c)}catch(j){g.error("User connection callback caused an exception: "+j)}},_buildBody:function(){var a=e("body",{rid:this.rid++,xmlns:g.NS.HTTPBIND});this.sid!==null&&a.attrs({sid:this.sid});return a},_removeRequest:function(a){g.debug("removing request");var c;for(c=this._requests.length-1;c>=0;c--)a==this._requests[c]&&this._requests.splice(c,1);a.xhr.onreadystatechange=function(){};this._throttledRequestHandler()},_restartRequest:function(a){var c=this._requests[a];if(c.dead===null)c.dead=new Date;
this._processRequest(a)},_processRequest:function(a){var c=this._requests[a],d=-1;try{if(c.xhr.readyState==4)d=c.xhr.status}catch(e){g.error("caught an error in _requests["+a+"], reqStatus: "+d)}typeof d=="undefined"&&(d=-1);if(c.sends>5)this._onDisconnectTimeout();else{var f=c.age(),f=!isNaN(f)&&f>Math.floor(g.TIMEOUT*this.wait),j=c.dead!==null&&c.timeDead()>Math.floor(g.SECONDARY_TIMEOUT*this.wait),d=c.xhr.readyState==4&&(d<1||d>=500);if(f||j||d)j&&g.error("Request "+this._requests[a].id+" timed out (secondary), restarting"),
c.abort=!0,c.xhr.abort(),c.xhr.onreadystatechange=function(){},this._requests[a]=new g.Request(c.xmlData,c.origFunc,c.rid,c.sends),c=this._requests[a];if(c.xhr.readyState===0){g.debug("request id "+c.id+"."+c.sends+" posting");try{c.xhr.open("POST",this.service,!0)}catch(r){g.error("XHR open failed.");this.connected||this._changeConnectStatus(g.Status.CONNFAIL,"bad-service");this.disconnect();return}a=function(){c.date=new Date;c.xhr.send(c.data)};c.sends>1?(d=Math.min(Math.floor(g.TIMEOUT*this.wait),
Math.pow(c.sends,3))*1E3,setTimeout(a,d)):a();c.sends++;this.xmlOutput!==g.Connection.prototype.xmlOutput&&this.xmlOutput(c.xmlData);this.rawOutput!==g.Connection.prototype.rawOutput&&this.rawOutput(c.data)}else g.debug("_processRequest: "+(a===0?"first":"second")+" request has readyState of "+c.xhr.readyState)}},_throttledRequestHandler:function(){this._requests?g.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):g.debug("_throttledRequestHandler called with undefined requests");
this._requests&&this._requests.length!==0&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))},_onRequestStateChange:function(a,c){g.debug("request id "+c.id+"."+c.sends+" state changed to "+c.xhr.readyState);if(c.abort)c.abort=!1;else{var d;if(c.xhr.readyState==4){d=0;try{d=c.xhr.status}catch(e){}typeof d=="undefined"&&(d=0);if(this.disconnecting&&d>=400)this._hitError(d);else{var f=
this._requests[0]==c,j=this._requests[1]==c;if(d>0&&d<500||c.sends>5)this._removeRequest(c),g.debug("request id "+c.id+" should now be removed");if(d==200)(j||f&&this._requests.length>0&&this._requests[0].age()>Math.floor(g.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),g.debug("request id "+c.id+"."+c.sends+" got 200"),a(c),this.errors=0;else if(g.error("request id "+c.id+"."+c.sends+" error "+d+" happened"),d===0||d>=400&&d<600||d>=12E3)this._hitError(d),d>=400&&d<500&&(this._changeConnectStatus(g.Status.DISCONNECTING,
null),this._doDisconnect());d>0&&d<500||c.sends>5||this._throttledRequestHandler()}}}},_hitError:function(a){this.errors++;g.warn("request errored, status: "+a+", number of errors: "+this.errors);this.errors>4&&this._onDisconnectTimeout()},_doDisconnect:function(){g.info("_doDisconnect was called");this.disconnecting=this.authenticated=!1;this.streamId=this.sid=null;this.rid=Math.floor(Math.random()*4294967295);if(this.connected)this._changeConnectStatus(g.Status.DISCONNECTED,null),this.connected=
!1;this.handlers=[];this.timedHandlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[]},_dataRecv:function(a){try{var c=a.getResponse()}catch(d){if(d!="parsererror")throw d;this.disconnect("strophe-parsererror")}if(c!==null){this.xmlInput!==g.Connection.prototype.xmlInput&&this.xmlInput(c);for(this.rawInput!==g.Connection.prototype.rawInput&&this.rawInput(g.serialize(c));this.removeHandlers.length>0;)a=this.removeHandlers.pop(),a=this.handlers.indexOf(a),a>=0&&
this.handlers.splice(a,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._requests.length===0)this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null,this._doDisconnect();else if(a=c.getAttribute("type"),a!==null&&a=="terminate")this.disconnecting||(a=c.getAttribute("condition"),c=c.getElementsByTagName("conflict"),a!==null?(a=="remote-stream-error"&&c.length>0&&(a="conflict"),this._changeConnectStatus(g.Status.CONNFAIL,
a)):this._changeConnectStatus(g.Status.CONNFAIL,"unknown"),this.disconnect());else{var e=this;g.forEachChild(c,null,function(a){var b,c;c=e.handlers;e.handlers=[];for(b=0;b<c.length;b++){var d=c[b];try{d.isMatch(a)&&(e.authenticated||!d.user)?d.run(a)&&e.handlers.push(d):e.handlers.push(d)}catch(f){}}})}}},_sendTerminate:function(){g.info("_sendTerminate was called");var a=this._buildBody().attrs({type:"terminate"});this.authenticated&&a.c("presence",{xmlns:g.NS.CLIENT,type:"unavailable"});this.disconnecting=
!0;this._requests.push(new g.Request(a.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),a.tree().getAttribute("rid")));this._throttledRequestHandler()},_connect_cb:function(a){g.info("_connect_cb was called");this.connected=!0;if(a=a.getResponse()){this.xmlInput!==g.Connection.prototype.xmlInput&&this.xmlInput(a);this.rawInput!==g.Connection.prototype.rawInput&&this.rawInput(g.serialize(a));var c=a.getAttribute("type");if(c!==null&&c=="terminate")c=a.getAttribute("condition"),
a=a.getElementsByTagName("conflict"),c!==null?(c=="remote-stream-error"&&a.length>0&&(c="conflict"),this._changeConnectStatus(g.Status.CONNFAIL,c)):this._changeConnectStatus(g.Status.CONNFAIL,"unknown");else{if(!this.sid)this.sid=a.getAttribute("sid");if(!this.stream_id)this.stream_id=a.getAttribute("authid");if(c=a.getAttribute("requests"))this.window=parseInt(c,10);if(c=a.getAttribute("hold"))this.hold=parseInt(c,10);if(c=a.getAttribute("wait"))this.wait=parseInt(c,10);var d=c=!1,j=!1,a=a.getElementsByTagName("mechanism"),
w,o;if(a.length>0){for(w=0;w<a.length;w++)o=g.getText(a[w]),o=="DIGEST-MD5"?d=!0:o=="PLAIN"?c=!0:o=="ANONYMOUS"&&(j=!0);g.getNodeFromJid(this.jid)===null&&j?(this._changeConnectStatus(g.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(e("auth",{xmlns:g.NS.SASL,mechanism:"ANONYMOUS"}).tree())):g.getNodeFromJid(this.jid)===
null?(this._changeConnectStatus(g.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect()):d?(this._changeConnectStatus(g.Status.AUTHENTICATING,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge1_cb.bind(this),null,"challenge",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this.send(e("auth",{xmlns:g.NS.SASL,mechanism:"DIGEST-MD5"}).tree())):c?(a=g.getBareJidFromJid(this.jid),a+="\x00",a+=g.getNodeFromJid(this.jid),
a+="\x00",a+=this.pass,this._changeConnectStatus(g.Status.AUTHENTICATING,null),this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),a=Base64.encode(a),this.send(e("auth",{xmlns:g.NS.SASL,mechanism:"PLAIN"}).t(a).tree())):(this._changeConnectStatus(g.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),
this.send(f({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:g.NS.AUTH}).c("username",{}).t(g.getNodeFromJid(this.jid)).tree()))}else a=this._buildBody(),this._requests.push(new g.Request(a.tree(),this._onRequestStateChange.bind(this,this._connect_cb.bind(this)),a.tree().getAttribute("rid"))),this._throttledRequestHandler()}}},_sasl_challenge1_cb:function(a){var c=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,d=Base64.decode(g.getText(a)),a=MD5.hexdigest(""+Math.random()*1234567890),f="",j=null,o=
"",r;for(this.deleteHandler(this._sasl_failure_handler);d.match(c);)switch(r=d.match(c),d=d.replace(r[0],""),r[2]=r[2].replace(/^"(.+)"$/,"$1"),r[1]){case "realm":f=r[2];break;case "nonce":o=r[2];break;case "host":j=r[2]}c="xmpp/"+this.domain;j!==null&&(c=c+"/"+j);j=MD5.hash(g.getNodeFromJid(this.jid)+":"+f+":"+this.pass)+":"+o+":"+a;d="AUTHENTICATE:"+c;r="";r+="username="+this._quote(g.getNodeFromJid(this.jid))+",";r+="realm="+this._quote(f)+",";r+="nonce="+this._quote(o)+",";r+="cnonce="+this._quote(a)+
",";r+='nc="00000001",';r+='qop="auth",';r+="digest-uri="+this._quote(c)+",";r+="response="+this._quote(MD5.hexdigest(MD5.hexdigest(j)+":"+o+":00000001:"+a+":auth:"+MD5.hexdigest(d)))+",";r+='charset="utf-8"';this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge2_cb.bind(this),null,"challenge",null,null);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),
null,"failure",null,null);this.send(e("response",{xmlns:g.NS.SASL}).t(Base64.encode(r)).tree());return!1},_quote:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},_sasl_challenge2_cb:function(){this.deleteHandler(this._sasl_success_handler);this.deleteHandler(this._sasl_failure_handler);this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",
null,null);this.send(e("response",{xmlns:g.NS.SASL}).tree());return!1},_auth1_cb:function(){var a=f({type:"set",id:"_auth_2"}).c("query",{xmlns:g.NS.AUTH}).c("username",{}).t(g.getNodeFromJid(this.jid)).up().c("password").t(this.pass);if(!g.getResourceFromJid(this.jid))this.jid=g.getBareJidFromJid(this.jid)+"/strophe";a.up().c("resource",{}).t(g.getResourceFromJid(this.jid));this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2");this.send(a.tree());return!1},_sasl_success_cb:function(){g.info("SASL authentication succeeded.");
this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null);this._sendRestart();return!1},_sasl_auth1_cb:function(a){this.features=a;var c,d;for(c=0;c<a.childNodes.length;c++){d=a.childNodes[c];if(d.nodeName=="bind")this.do_bind=!0;if(d.nodeName=="session")this.do_session=!0}this.do_bind?
(this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2"),(a=g.getResourceFromJid(this.jid))?this.send(f({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:g.NS.BIND}).c("resource",{}).t(a).tree()):this.send(f({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:g.NS.BIND}).tree())):this._changeConnectStatus(g.Status.AUTHFAIL,null);return!1},_sasl_bind_cb:function(a){if(a.getAttribute("type")=="error")return g.info("SASL binding failed."),this._changeConnectStatus(g.Status.AUTHFAIL,
null),!1;a=a.getElementsByTagName("bind");if(a.length>0){if(a=a[0].getElementsByTagName("jid"),a.length>0)this.jid=g.getText(a[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(f({type:"set",id:"_session_auth_2"}).c("session",{xmlns:g.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(g.Status.CONNECTED,null))}else return g.info("SASL binding failed."),this._changeConnectStatus(g.Status.AUTHFAIL,null),!1},_sasl_session_cb:function(a){a.getAttribute("type")==
"result"?(this.authenticated=!0,this._changeConnectStatus(g.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(g.info("Session creation failed."),this._changeConnectStatus(g.Status.AUTHFAIL,null));return!1},_sasl_failure_cb:function(){if(this._sasl_success_handler)this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null;if(this._sasl_challenge_handler)this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null;this._changeConnectStatus(g.Status.AUTHFAIL,
null);return!1},_auth2_cb:function(a){a.getAttribute("type")=="result"?(this.authenticated=!0,this._changeConnectStatus(g.Status.CONNECTED,null)):a.getAttribute("type")=="error"&&(this._changeConnectStatus(g.Status.AUTHFAIL,null),this.disconnect());return!1},_addSysTimedHandler:function(a,c){var d=new g.TimedHandler(a,c);d.user=!1;this.addTimeds.push(d);return d},_addSysHandler:function(a,c,d,e,f){a=new g.Handler(a,c,d,e,f);a.user=!1;this.addHandlers.push(a);return a},_onDisconnectTimeout:function(){g.info("_onDisconnectTimeout was called");
for(var a;this._requests.length>0;)a=this._requests.pop(),a.abort=!0,a.xhr.abort(),a.xhr.onreadystatechange=function(){};this._doDisconnect();return!1},_onIdle:function(){for(var a,c,d,e;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)c=this.removeTimeds.pop(),a=this.timedHandlers.indexOf(c),a>=0&&this.timedHandlers.splice(a,1);var f=(new Date).getTime();e=[];for(a=0;a<this.timedHandlers.length;a++)if(c=this.timedHandlers[a],this.authenticated||
!c.user)d=c.lastCalled+c.period,d-f<=0?c.run()&&e.push(c):e.push(c);this.timedHandlers=e;this.authenticated&&this._requests.length===0&&this._data.length===0&&!this.disconnecting&&(g.info("no requests during idle cycle, sending blank request"),this._data.push(null));if(this._requests.length<2&&this._data.length>0&&!this.paused){c=this._buildBody();for(a=0;a<this._data.length;a++)this._data[a]!==null&&(this._data[a]==="restart"?c.attrs({to:this.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":g.NS.BOSH}):
c.cnode(this._data[a]).up());delete this._data;this._data=[];this._requests.push(new g.Request(c.tree(),this._onRequestStateChange.bind(this,this._dataRecv.bind(this)),c.tree().getAttribute("rid")));this._processRequest(this._requests.length-1)}this._requests.length>0&&(a=this._requests[0].age(),this._requests[0].dead!==null&&this._requests[0].timeDead()>Math.floor(g.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),a>Math.floor(g.TIMEOUT*this.wait)&&(g.warn("Request "+this._requests[0].id+
" timed out, over "+Math.floor(g.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler()));clearTimeout(this._idleTimeout);if(this.connected)this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}};a&&a(g,e,d,f,j)})(function(a,e,d,f,j){window.Strophe=a;window.$build=e;window.$msg=d;window.$iq=f;window.$pres=j});redhelper.define("common/extensions/strophe.base",function(){});redhelper.require(["common/extensions/strophe.base"],function(){Strophe.xmlTextNode=function(a){return Strophe.xmlGenerator().createTextNode(a)}});
redhelper.define("common/extensions/strophe",function(){});
redhelper.define("xmpp/connection",["application/dispatcher","common/extensions/debug","config/setup","application/session.objects","common/extensions/strophe"],function(a,e,d,f){var j={disconnecting:!1,_errorHandlers:[],_reconId:null,_connection:null,_messageHandler:null,_reconnecting:!1,_attached:!1,setMessageHandler:function(a){this._messageHandler=a},init:function(){this._connection=new Strophe.Connection(d.BOSH_SERVICE);this._connection.rawInput=function(a){e.log("RECV: "+a);try{f.rid=j._connection.rid,
f.sid=j._connection.sid}catch(b){e.error(b)}};this._connection.rawOutput=function(a){e.log("SEND: "+a);try{f.rid=j._connection.rid,f.sid=j._connection.sid}catch(b){e.error(b)}};this._connection.connect(d.XMPP_DOMAIN,"",j.onStatusChanged,50);this._connection.addHandler(j._messageHandler,null,"message",null,null,null);this._connection._hitError=function(a){j._connection.errors++;j._connection.errors>4&&j._connection._onDisconnectTimeout();for(var b in j._errorHandlers)if(j._errorHandlers.hasOwnProperty(b)&&
typeof j._errorHandlers[b]=="function")j._errorHandlers[b](a,j._connection.errors)}},addErrorHandler:function(a){typeof a=="function"&&this._errorHandlers.push(a)},checkPresence:function(){this._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:presence",from:d.XMPP_DOMAIN,to:d.CLIENT_NAME.toOperatorJid()}).tree(),this.onPresence,j.reconnect,2E3)},disconnect:function(){j.disconnecting=!0;this._connection.disconnect()},reconnect:function(){j.disconnecting=!1;f.reconnecting=!0;this._connection.disconnect()},
onStatusChanged:function(e){if(e==Strophe.Status.CONNECTED||e==Strophe.Status.ATTACHED){a.fire("connected");if(f.reconnecting)a.fire("refreshHistory"),f.reconnecting=!1;if(e==Strophe.Status.ATTACHED)a.fire("attached"),j._attached=!0}else if(e==Strophe.Status.DISCONNECTING&&(j._isAuthenticated=!1,!j.disconnecting&&j._reconId==null))j._reconId=setTimeout(function(){j._connection.reset();f.reconnecting=!0;j._connection.connect(d.XMPP_DOMAIN,"",j.onStatusChanged,50);j._connection.addHandler(j._messageHandler,
null,"message",null,null,null);j._reconId=null},1E4);return!0},onPresence:function(){a.fire("connected")},isAuthenticated:function(){return this._isAuthenticated}};return j});
redhelper.define("common/application/basicActivity",["application/dispatcher"],function(a){function e(a,d){this._prefix=d||"";this._dispatcher=null;this._CHECK_INTERVAL=a;this._intervalId=null;this._flag=this._isUserAway=!1;this._children=[]}e.prototype={check:function(){!this._flag&&!this._isUserAway?(this._dispatcher.fire(this._prefix+"userAway"),this._isUserAway=!0):this._flag=!1},isActive:function(){return!this._isUserAway},update:function(){this._flag=!0;if(this._isUserAway)this._dispatcher.fire(this._prefix+
"userBack"),this._isUserAway=!1;for(var a=0;a<this._children.length;a++)this._children[a].update()},start:function(){if(!this._intervalId){var a=this;this._intervalId=setInterval(function(){a.check()},this._CHECK_INTERVAL)}},stop:function(){if(this._intervalId)clearInterval(this._intervalId),this._intervalId=null},init:function(a,d){if(d)this._CHECK_INTERVAL=d;this._dispatcher=a},getChild:function(a,d){var g=new e(a,d);g.init(this._dispatcher);this._children.push(g);return g}};var d=new e(3E5);d.init(a);
return d});redhelper.define("application/timer",["application/session.objects","common/application/basicActivity"],function(a,e){var d=function(){var d=null,j=0,g=e.getChild(3E4,"timer_");g.start();return{start:function(){d||(d=setInterval(function(){a.time++;j++},1E3))},stop:function(){clearInterval(d);d=null},getActivity:function(){return g},flush:function(){var a=j;j=0;return a}}}();d.start();return d});redhelper.define("xmpp/xmppException",[],function(){});
redhelper.define("xmpp/update","application/session.objects,xmpp/connection,config/setup,application/timer,xmpp/xmppException,common/extensions/strophe".split(","),function(a,e,d,f,j){var g={_firstUpdateSent:!1,simple:function(){if(a.vid){var b=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(d.CLIENT_NAME+"").up().c("time").t(f.flush()+"").up();if(!g._firstUpdateSent)g._firstUpdateSent=!0;e._connection.sendIQ(b,null,null,2E3)}},state:function(b){var c=
$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(d.CLIENT_NAME+"").up();typeof b=="undefined"&&(b="browse");c.c("chatState").t(b);e._connection.sendIQ(c,null,null,2E3)},invite:function(b,c,f){a.inviteState=c;a.trigger=f;a.stringChatState=b;var g=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(d.CLIENT_NAME+"").up();typeof f=="undefined"&&(f="");g.c("trigger").t(f).up().c("inviteState").t(c).up().c("chatState").t(b).up();
e._connection.sendIQ(g,null,null,2E3)},currentOperator:function(){if(a.vid&&a.currentOperator){var b=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("currentOperator").t(a.currentOperator).up().c("clientName").t(d.CLIENT_NAME+"").up();e._connection.sendIQ(b,null,null,2E3)}else throw new j("currentOperator or vid not specified");},inviteSniff:function(b,c){var f=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(a.vid.toString()).up().c("clientName").t(d.CLIENT_NAME+
"").up();typeof b=="undefined"||b==""||(typeof c=="undefined"&&(c=""),f.c("trigger").t(b).up().c("operator").t(c).up(),e._connection.sendIQ(f,null,null,2E3))}};return g});
redhelper.define("xmpp/queue","xmpp/connection,application/session.objects,config/setup,common/extensions/jquery.plugins,xmpp/update,application/dispatcher,common/extensions/strophe".split(","),function(a,e,d,f,j,g){var b={getOperator:function(){if(e.isOnline){var b=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(d.CLIENT_NAME).up().c("vid").t(e.vid.toString()).up();typeof d.REQUIRE_OPERATOR=="string"&&d.REQUIRE_OPERATOR!=""&&b.c("require").t(d.REQUIRE_OPERATOR).up();e.currentOperator&&
b.c("operator").t(e.currentOperator);a._connection.sendIQ(b,this.onGetOperator,this.onGetOperatorFail,2E3)}},checkOperator:function(){function b(c){(e.isOnline&&!f("operator",c).text()||!e.isOnline&&f("operator",c).text())&&a.disconnect()}var g=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(d.CLIENT_NAME).up().c("vid").t(e.vid.toString()).up();typeof d.REQUIRE_OPERATOR=="string"&&d.REQUIRE_OPERATOR!=""&&g.c("require").t(d.REQUIRE_OPERATOR).up();e.currentOperator&&g.c("operator").t(e.currentOperator);
a._connection.sendIQ(g,b,b,1E4)},onGetOperator:function(a){f("operator",a).text()?(e.currentOperator=f("operator",a).text(),e.operDisplayName=f("displayName",a).text(),e.operAvatar=f("avatar",a).text(),j.currentOperator(),g.fire("operator")):(d.QUEUE_DELAY_COUNT++,setTimeout(function(){b.getOperator()},3E3))},onGetOperatorFail:function(){d.QUEUE_DELAY_COUNT++;setTimeout(function(){b.getOperator()},3E3)}};return b});
redhelper.define("common/extensions/mouse",["common/extensions/jquery.plugins"],function(a){function e(a){return{x:a.x||0,y:a.y||0,width:a.width,height:a.height,scrollX:a.scrollX,scrollY:a.scrollY}}function d(){for(var a=0,a=0;a<g.length;a++)g[a].send("getMouse");for(a=0;a<b.length;a++)b[a].send("getMouse");n()}var f={},j=!1,g=[],b=[],c={},k={},n=function(){},w=function(){},o=!1,r=!1,u=!1;return{init:function(){a("body").hover(function(){j=!0},function(){j=!1}).mouseleave(function(){j=!1}).mouseenter(function(){j=
!0});f.width=Math.max(a("html").width(),a(window).width());f.height=Math.max(a("html").height(),a(window).height());f.scrollX=a(window).scrollLeft();f.scrollY=a(window).scrollTop();a(window).mousemove(function(b){j=!0;f={x:b.clientX,y:b.clientY,width:Math.max(a(document).width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});a(window).bind("scroll",function(){f.scrollX=a(window).scrollLeft();f.scrollY=a(window).scrollTop();
j=!0});a("html").bind("click",function(b){o=!0;u=r=!1;j=!0;f={x:b.clientX,y:b.clientY,width:Math.max(a(document).width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});a("html").bind("mouseup",function(b){u=!0;r=!1;f={x:b.clientX,y:b.clientY,width:Math.max(a("html").width(),a(window).width()),height:Math.max(a(document).height(),a(window).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});
a("html").bind("mousedown",function(b){r=!0;u=!1;f={x:b.clientX,y:b.clientY,width:Math.max(a("html").width(),a(window).width()),height:Math.max(a(document).height(),a(document).height()),scrollX:a(window).scrollLeft(),scrollY:a(window).scrollTop()}});return this},setAsSlave:function(b){b.addHandler("getMouse",function(){var a=e(f);a.isInside=j;a.clicked=o;a.mouseDown=r;a.mouseUp=u;u=r=o=!1;typeof w=="function"&&w(a);b.send("mouseData",a)});a("html").mousemove(function(){b.send("forceLeave")});return this},
setAsMaster:function(){setInterval(d,100);return this},addParentSlave:function(a){typeof a.send=="function"&&(g.push(a),a.addHandler("mouseData",function(a){j||(c=a)}),a.addHandler("forceLeave",function(){j=!1}));return this},addChildSlave:function(a){typeof a.send=="function"&&(b.push(a),a.addHandler("mouseData",function(a){a.isInside&&(k=a)}));return this},setHandler:function(a){n=a;return this},setOffsetFunction:function(a){w=a;return this},getMouseData:function(){var a=e(f);a.isInside=j;a.clicked=
o;a.mouseDown=r;a.mouseUp=u;u=r=o=!1;typeof w=="function"&&w(a);if(k.isInside)return k.mouseUp|=a.mouseUp,e(k),k;if(!a.isInside&&c.isInside)return c.mouseUp|=a.mouseUp,e(c),c;c.x=a.x;c.y=a.y;e(a);return a},getParentMouseData:function(){return c},getChildMouseData:function(){return k}}});
redhelper.define("xmpp/messages","application/session.objects,xmpp/connection,xmpp/queue,application/dispatcher,common/constants/sender,common/extensions/jquery.plugins,common/application/time,common/extensions/mouse,common/extensions/strophe".split(","),function(a,e,d,f,j,g,b,c){var k={_isTypedTextChanged:"",_firstMessageSent:!1,_isTyping:!1,_lockOperatorTyping:!1,_notTypingCount:0,_mouseOperators:{},_isMouseSniffed:!1,_immediateMouse:!1,sniff:function(){var b=a.currentTypedText.replace(/[\n]+$/g,
" "),c=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t(b).up();if(this._isTypedTextChanged&&b){this._isTypedTextChanged=!1;if(!this._isTyping)c.c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),this._lockOperatorTyping=this._isTyping=!0;e._connection.send(c.tree())}else if(k._isTyping)this._notTypingCount<3?this._notTypingCount++:(this._notTypingCount=0,c.c("paused",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),
e._connection.send(c.tree()),k._isTyping=!1)},typedTextChanged:function(){this._isTypedTextChanged=!0},stopSniffMouse:function(b){delete k._mouseOperators[b.extractNode().toOperatorJid()];var b=!1,c;for(c in k._mouseOperators)if(k._mouseOperators.hasOwnProperty(c)){b=!0;break}a.mouseOperators=JSON.stringify(k._mouseOperators);a.isSendMouseActive=b},sniffMouse:function(b,d){var f=[],g=[],j=[],m=[],p=[],q=[],E=[],y=[],H=0,z=new Date,d=d||z.getTime(),b=b.extractNode(),b=(b||a.currentOperator).toOperatorJid();
k._mouseOperators[b]={jid:b,start:d};a.mouseOperators=JSON.stringify(k._mouseOperators);k._immediateMouse=!0;this._isMouseSniffed||c.setHandler(function(){if(a.isSendMouseActive){var b=c.getMouseData(),d=new Date,n=b.width,w=b.height;f.push(b.x);g.push(b.y);j.push(+b.clicked);p.push(+b.mouseUp);m.push(+b.mouseDown);q.push(b.scrollX);E.push(b.scrollY);y.push(b.isInside);H++;(H>=10||k._immediateMouse)&&function(){var b={};b.chatX=a.currentChatX;b.chatY=a.currentChatY;b.chatWidth=a.currentChatWidth?
a.currentChatWidth:a.chatWidth;b.chatHeight=a.currentChatHeight?a.currentChatHeight:a.chatHeight;b.chatState=a.chatState;b.xArr=f;b.yArr=g;b.clickedArr=j;b.upArr=p;b.downArr=m;b.scrollXArr=q;b.scrollYArr=E;b.insideArr=y;b.width=n;b.height=w;b.id=d.getTime();for(var c in k._mouseOperators)if(d.getTime()-k._mouseOperators[c].start>36E5)k.stopSniffMouse(c);else{var s=$msg({to:k._mouseOperators[c].jid,jid:a.vid.toVisitorJid(),type:"chat",content:"mouse"}).c("body").t(JSON.stringify(b)).up().up();e.isAuthenticated()&&
(e._connection.send(s.tree()),e._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),k._immediateMouse&&e._connection.flush())}H=0;f=[];g=[];j=[];p=[];m=[];q=[];E=[];y=[];k._immediateMouse=!1}()}});this._isMouseSniffed=!0},onMessageReceived:function(c){c.getAttribute("to");var e=c.getAttribute("from"),o=c.getAttribute("displayName"),r=c.getAttribute("type");if(c.getAttribute("content")=="invitation"){if(e.extractNode()==a.currentOperator)f.fire({type:"invitation",message:g("body",
c).text()});else{var u=function(){f.removeEventListener("operator",u);f.fire({type:"invitation",message:g("body",c).text()})};f.addEventListener("operator",u);f.fire("updateServerInfo")}return!0}if(c.getAttribute("content")=="mouse")g("state",c).text()=="on"?(k.sniffMouse(e),a.isSendMouseActive=!0):k.stopSniffMouse(e);else if(c.getAttribute("content")=="typing")if(k._firstMessageSent&&!k._lockOperatorTyping)f.fire("typing");else{var m=function(a){if(a.sender==j.VISITOR){var b=setTimeout(function(){f.fire("typing")},
2500),c=function(a){a.sender==j.OPERATOR&&(clearTimeout(b),f.removeEventListener("message",c))};f.addEventListener("message",c)}f.removeEventListener("message",m)};f.addEventListener("message",m)}else if(c.getAttribute("content")=="command")o=JSON.parse(g("body",c).text()),o.type=="highlight"&&f.fire(o),o.type=="redirect"&&f.fire(o);else if(!c.getAttribute("content")||c.getAttribute("content")=="normal"){var p=Strophe.getText(c.getElementsByTagName("body")[0]);if(p&&(p.indexOf(":g")==0||p.indexOf(":\u0433")==
0))return o=p.substr(3),f.fire("redirect",{link:o}),!0;if(p&&p.indexOf(":r")==0)return f.fire("operatorRedirect"),!0;if(p&&p.indexOf(":ok redirect")!=-1)return p=e.extractNode(),a.currentOperator=p,f.fire("operatorRedirectOk",{operator:e,displayName:o}),d.getOperator(),!0;if(p&&p.indexOf(":fail redirect")==0)return f.fire("operatorRedirectFail"),!0;r=="chat"&&p&&(e=b.now().toString(),f.fire({type:"message",time:e,text:p,sender:j.OPERATOR,displayName:o,id:(new Date).getTime()}))}return!0},onMessageSent:function(b){if(b.raw)e._connection.send(g(b.text));
else{if(b.sent){k._lockOperatorTyping=!1;var c=$msg({to:a.currentOperator.toOperatorJid(),jid:a.vid.toVisitorJid(),type:"chat"}).c("body").attrs({mid:b.guid}).t(b.text).up();k._firstMessageSent||c.c("active",{xmlns:"http://jabber.org/protocol/chatstates"}).up();e._connection.send(c.tree());e._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"}))}if(b.sender==j.VISITOR)k._firstMessageSent=!0}}};return k});
redhelper.define("view/cssChecker",["common/extensions/jquery.plugins","application/dispatcher"],function(a,e){var d={_defaultCssLoadSelector:"redhlp_loadCss",_checkLoadInterval:50,check:function(a,d){if(typeof a=="undefined")a=this._defaultCssLoadSelector;this._listenCssLoad(a,d)},_listenCssLoad:function(f,j){a("#"+f).css("z-index")=="1"?typeof j!="undefined"?e.fire(j):setTimeout(function(){e.fire("cssLoaded")},200):setTimeout(function(){d._listenCssLoad(f,j)},d._checkLoadInterval)}};return d});
redhelper.define("application/statistics",["application/session.objects"],function(a){var e=!1,d=!1;return{checkNewVisit:function(){var d=new Date(a.lastVisit),j=new Date;a.lastVisit=new Date+"";return e=j.getTime()-d.getTime()>12E5},checkNewDay:function(){var e=new Date(a.previousDay);if(d=(new Date).getTime()-e.getTime()>864E5)a.previousDay=new Date+"";return d}}});
redhelper.define("common/extensions/browserDetect",[],function(){var a={init:function(){this.browser=this.searchString(this.dataBrowser)||"-";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"";this.OS=this.searchString(this.dataOS)||"-";if(this.browser=="Opera"&&navigator.userAgent.split("Version/")[1])this.version=navigator.userAgent.split("Version/")[1]},searchString:function(a){for(var d=0;d<a.length;d++){var f=a[d].string,j=a[d].prop;this.versionSearchString=
a[d].versionSearch||a[d].identity;if(f){if(f.indexOf(a[d].subString)!=-1)return a[d].identity}else if(j)return a[d].identity}},searchVersion:function(a){var d=a.indexOf(this.versionSearchString);return d==-1?void 0:parseFloat(a.substring(d+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",
versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",
identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};a.init();return a});
redhelper.define("xmpp/authentication","xmpp/connection,application/dispatcher,application/session.objects,common/constants/sender,common/extensions/jquery.plugins,common/application/time,application/statistics,config/setup,common/extensions/browserDetect,common/extensions/strophe".split(","),function(a,e,d,f,j,g,b,c,k){var n={init:function(){a._connection.send($pres().tree());var f=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(c.CLIENT_NAME).up().c("clientName").t(c.CLIENT_NAME).up().c("os").t(k.OS).up().c("browser").c("type").t(k.browser).up().c("version").t(k.version+
"").up().up().c("browserName").t(k.browser+" "+k.version).up().c("ip").t(d.ip).up().c("url").t(c.CURRENT_URL).up().c("currentUrl").t(c.CURRENT_URL).up().c("title").t(c.CURRENT_TITLE).up().c("currentPageTitle").t(c.CURRENT_TITLE).up().c("referrer").t(d.referrer).up().c("visits").t(d.visits+"").up().c("time").t(d.time+"").up().c("timeOnSite").t(d.time+"").up().c("currentOperator").t(d.currentOperator).up().c("viewedPages").t(d.viewedPages+"").up().c("inviteState").t(d.inviteState+"").up().c("chatState").t(d.stringChatState?
d.stringChatState:"browse").up().c("trigger").t(d.trigger).up().c("country").t(d.country).up().c("region").t(d.region).up().c("city").t(d.city).up();b.checkNewVisit()&&f.c("newVisit").t("1").up();b.checkNewDay()&&f.c("newDay").t("1").up();d.vid>0&&f.c("vid").t(d.vid.toString());a._connection.sendIQ(f.tree(),n.onAuthenticate,null,2E3);e.addEventListener("refreshHistory",function(){n.getHistory(!0)})},getHistory:function(b){if(b||!window.localStorage)b=$iq({type:"get",jid:d.vid.toVisitorJid()}).c("query",
{xmlns:"consultant:history"}),a._connection.sendIQ(b.tree(),n.onHistory,null,2E3)},onAuthenticate:function(a){j("vid",a).text()?d.vid=j("vid",a).text():(n.getHistory(),g.setTimeDifference(j("time",a).text()));e.fire("authenticated")},onHistory:function(a){e.fire("historyReceived");a=j("message",a);for(i=0;i<a.length;i++){var b=j(a[i]),c=b.attr("from")==d.vid.toVisitorJid()?f.VISITOR:f.OPERATOR,k=g.parse(b.attr("time")).toString(),m=b.children("body").text(),n=b.attr("displayName")||"";e.fire({type:"message",
time:k,id:g.parse(b.attr("time")).getTime(),text:m,sender:c,displayName:n,isHistory:!0})}}};return n});redhelper.requirejs.config({baseUrl:"js",paths:{common:"../../common/js"}});
redhelper.define("xmpp/xmppManager","application/dispatcher,xmpp/update,xmpp/xmppException,xmpp/queue,xmpp/authentication,application/session.objects,xmpp/connection,xmpp/messages,common/extensions/strophe".split(","),function(a,e,d,f,j,g,b,c){var k=[],n={_updateId:null,_sniffId:null,_isAuthenticated:!1,_UPDATE_TIME:35E3,logMessages:function(){a.addEventListener("message",function(a){b._isAuthenticated||!a.isSync&&!a.isHistory&&k.push(a)})},flushQueue:function(){k.splice(0,k.length)},start:function(){b.setMessageHandler(c.onMessageReceived);
b.init();b.addErrorHandler(function(){});a.addEventListener("authenticated",function(){n.routines();f.getOperator()});a.addEventListener("authenticated",function(){for(var a in k)c.onMessageSent(k[a]),k.splice(a,1)});a.addEventListener("connected",function(){j.init()});a.addEventListener("attached",function(){j.init()});b._attached&&j.init();a.addEventListener("updateServerInfo",function(){f.checkOperator()});a.addEventListener("sniffMouse",function(){g.isSendMouseActive=!0;c.sniffMouse()});a.addEventListener("cobrowseMessage",
function(c){var d=$msg({to:g.currentOperator.toOperatorJid(),jid:g.vid.toVisitorJid(),type:"chat",content:"cobrowse"}).c("body").t(JSON.stringify(c)).up();b.isAuthenticated()?(b._connection.send(d.tree()),b._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),b._connection.flush(),c.type="cobrowseMessageSent",a.fire(c)):setTimeout(function(){a.fire(c)},500)});a.addEventListener("operatorRedirectOk",function(b){g.currentOperator=b.operator.extractNode();g.operDisplayName=b.displayName;
a.fire("updateServerInfo")});a.addEventListener("stropheDisconnected",function(){if(!b.disconnecting)g.reconnects++,b._isAuthenticated=!1,a.fire("disconnected")});a.addEventListener("reconnect",b.reconnect);a.addEventListener("disconnect",function(){clearInterval(n._updateId);clearInterval(n._sniffId);b.disconnect()});if(g.isSendMouseActive){var d=JSON.parse(g.mouseOperators||"{}"),e;for(e in d)c.sniffMouse(d[e].jid,d[e].start)}},routines:function(){e.simple();n._updateId&&clearInterval(n._updateId);
n._sniffId&&clearInterval(n._sniffId);this._updateId=setInterval(function(){e.simple()},this._UPDATE_TIME);this._sniffId=setInterval(function(){c.sniff()},1E3);b._isAuthenticated=!0;a.removeEventListener("message",c.onMessageSent);a.removeEventListener("rawMessage",c.onMessageSent);a.addEventListener("message",c.onMessageSent);a.addEventListener("rawMessage",c.onMessageSent)}};return n});redhelper.define("common/constants/offlineError",{UNDEFINED:0,INCORRECT_EMAIL:1});
redhelper.define("common/extensions/guid",[],function(){return{generate:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var e=Math.random()*16|0;return(a=="x"?e:e&3|8).toString(16)})}}});
redhelper.define("view/uiEvents","common/extensions/jquery.plugins,application/session.objects,config/lang,config/setup,application/dispatcher,common/constants/sender,common/constants/offlineError,common/application/basicActivity,common/application/time,common/extensions/guid".split(","),function(a,e,d,f,j,g,b,c,k,n){var w={_isSendingOffline:!1,bind:function(){var b=function(){c.update();return!0};a(window).click(b);a(window).mousemove(b);a(window).keydown(b);a(window).resize(function(){var b=a("#chatItself")[0];
b.scrollTop=b.scrollHeight});a("#chatTextarea").focus(function(){a(this).val()==d.CHAT_LABEL&&a(this).val("");a(this).css("color","#000")}).blur(function(){a(this).val().trim()==""&&a(this).val(d.CHAT_LABEL);a(this).css("color","#bbb")}).keydown(function(b){if(b.keyCode==13){if(b.ctrlKey)if(b=this.value,typeof this.selectionStart=="number"&&typeof this.selectionEnd=="number"){var c=this.selectionStart;this.value=b.slice(0,c)+"\n"+b.slice(this.selectionEnd);this.selectionStart=this.selectionEnd=c+
1}else{if(document.selection&&document.selection.createRange)this.focus(),b=document.selection.createRange(),b.text="\r\n",b.collapse(!1),b.select()}else{if(f.DEBUG&&b.shiftKey)return j.fire({type:"rawMessage",text:a("#chatTextarea").val(),raw:!0}),!1;a("#chatSend").click()}return!1}e.currentTypedText=a(this).val()});a("#chatSend").click(function(){e.currentTypedText="";var b=a("#chatTextarea").val();if(b.replace(/\n+/g,"\n").trim()!=""&&b.replace(/\n+/g,"")!=d.CHAT_LABEL){var c=k.now().toString();
j.fire({type:"message",text:b,id:(new Date).getTime(),time:c,sender:g.VISITOR,displayName:d.YOU_LABEL,sent:!0,guid:n.generate()})}a("#chatTextarea").val("");try{a("#chatTextarea").focus()}catch(f){}});a(document).keydown(function(a){a.ctrlKey&&a.altKey&&a.keyCode==69&&j.fire("refreshHistory");if(a.ctrlKey&&a.altKey&&a.keyCode==68)return f.DEBUG=!f.DEBUG,localStorage.setItem("rhlp.debug",f.DEBUG?"true":""),!1});a("#sendButton").click(function(){}).mousedown(function(){a(this).addClass("pressed")}).mouseup(function(){a(this).removeClass("pressed")}).mouseout(function(){a(this).removeClass("pressed")}).click(function(){if(w._isSendingOffline)return!1;
!a("#email").val()||!a("#name").val()||!a("#message").val()?a("#offlineError").text(d.NOT_ALL_FIELDS):a("#email").val().match(/^[^@?&]+[@][a-zA-Z0-9]+([a-z0-9A-Z-.]*[a-zA-Z0-9])[.][^@]{2,16}$/)?(this._isSendingOffline=!0,a("#email, #name, #message").attr("disabled","disabled"),a("#throbber").show(),a("#sendButton").css("opacity","0.7"),j.fire("sendOffline",{name:a("#name").val(),email:a("#email").val(),message:a("#message").val()})):a("#offlineError").text(d.INCORRECT_EMAIL)});a("input, textarea").keyup(function(){a("#mailSuccess").hide()});
j.addEventListener("offlineSuccess",function(){w.showSuccess()});j.addEventListener("offlineFailure",function(a){w.showFailure(a)})},showSuccess:function(){w._isSendingOffline=!1;a("#offlineError").hide();a("#throbber").hide();a("#sendButton").css("opacity","1");a("#offlineSuccess").show();a("#offline").hide();setTimeout(function(){a("#offlineSuccess").hide();a("#offline").show();a("#email, #name, #message").removeAttr("disabled").val("");a("#mailSuccess").text(d.MAIL_SENT).show();j.fire("offlineDone")},
1200)},showFailure:function(c){w._isSendingOffline=!1;a("#offlineError").text(c.errorCode==b.INCORRECT_EMAIL?d.EMAIL_INCORRECT:d.FAILED_TO_SEND).show();a("#offlineSuccess").hide();a("#email, #name, #message").removeAttr("disabled");a("#throbber").hide();a("#sendButton").css("opacity","1")}};return w});
var swfobject=function(){function a(){if(!R){try{var a=v.getElementsByTagName("body")[0].appendChild(v.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var a=O.length,c=0;c<a;c++)O[c]()}}function e(a){R?a():O[O.length]=a}function d(a){if(typeof G.addEventListener!=y)G.addEventListener("load",a,!1);else if(typeof v.addEventListener!=y)v.addEventListener("load",a,!1);else if(typeof G.attachEvent!=y)u(G,"onload",a);else if(typeof G.onload=="function"){var b=G.onload;G.onload=
function(){b();a()}}else G.onload=a}function f(){var a=v.getElementsByTagName("body")[0],b=v.createElement(H);b.setAttribute("type",z);var c=a.appendChild(b);if(c){var d=0;(function(){if(typeof c.GetVariable!=y){var e=c.GetVariable("$version");if(e)e=e.split(" ")[1].split(","),x.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}else if(d<10){d++;setTimeout(arguments.callee,10);return}a.removeChild(b);c=null;j()})()}else j()}function j(){var a=s.length;if(a>0)for(var d=0;d<a;d++){var e=s[d].id,
f=s[d].callbackFn,j={success:!1,id:e};if(x.pv[0]>0){var n=r(e);if(n)if(m(s[d].swfVersion)&&!(x.wk&&x.wk<312)){if(q(e,!0),f)j.success=!0,j.ref=g(e),f(j)}else if(s[d].expressInstall&&b()){j={};j.data=s[d].expressInstall;j.width=n.getAttribute("width")||"0";j.height=n.getAttribute("height")||"0";if(n.getAttribute("class"))j.styleclass=n.getAttribute("class");if(n.getAttribute("align"))j.align=n.getAttribute("align");for(var o={},n=n.getElementsByTagName("param"),p=n.length,u=0;u<p;u++)n[u].getAttribute("name").toLowerCase()!=
"movie"&&(o[n[u].getAttribute("name")]=n[u].getAttribute("value"));c(j,o,e,f)}else k(n),f&&f(j)}else if(q(e,!0),f){if((e=g(e))&&typeof e.SetVariable!=y)j.success=!0,j.ref=e;f(j)}}}function g(a){var b=null;if((a=r(a))&&a.nodeName=="OBJECT")typeof a.SetVariable!=y?b=a:(a=a.getElementsByTagName(H)[0])&&(b=a);return b}function b(){return!F&&m("6.0.65")&&(x.win||x.mac)&&!(x.wk&&x.wk<312)}function c(a,b,c,d){F=!0;Z=d||null;J={success:!1,id:c};var e=r(c);if(e){e.nodeName=="OBJECT"?(B=n(e),V=null):(B=e,V=
c);a.id=t;if(typeof a.width==y||!/%$/.test(a.width)&&parseInt(a.width,10)<310)a.width="310";if(typeof a.height==y||!/%$/.test(a.height)&&parseInt(a.height,10)<137)a.height="137";v.title=v.title.slice(0,47)+" - Flash Player Installation";d=x.ie&&x.win?"ActiveX":"PlugIn";d="MMredirectURL="+G.location.toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+v.title;typeof b.flashvars!=y?b.flashvars+="&"+d:b.flashvars=d;if(x.ie&&x.win&&e.readyState!=4)d=v.createElement("div"),c+="SWFObjectNew",
d.setAttribute("id",c),e.parentNode.insertBefore(d,e),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}();w(a,b,c)}}function k(a){if(x.ie&&x.win&&a.readyState!=4){var b=v.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(n(a),b);a.style.display="none";(function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(n(a),a)}function n(a){var b=v.createElement("div");
if(x.win&&x.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(H)[0])if(a=a.childNodes)for(var c=a.length,d=0;d<c;d++)!(a[d].nodeType==1&&a[d].nodeName=="PARAM")&&a[d].nodeType!=8&&b.appendChild(a[d].cloneNode(!0));return b}function w(a,b,c){var d,e=r(c);if(x.wk&&x.wk<312)return d;if(e){if(typeof a.id==y)a.id=c;if(x.ie&&x.win){var f="",g;for(g in a)if(a[g]!=Object.prototype[g])g.toLowerCase()=="data"?b.movie=a[g]:g.toLowerCase()=="styleclass"?f+=' class="'+a[g]+'"':g.toLowerCase()!="classid"&&
(f+=" "+g+'="'+a[g]+'"');g="";for(var j in b)b[j]!=Object.prototype[j]&&(g+='<param name="'+j+'" value="'+b[j]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+g+"</object>";S[S.length]=a.id;d=r(a.id)}else{j=v.createElement(H);j.setAttribute("type",z);for(var k in a)a[k]!=Object.prototype[k]&&(k.toLowerCase()=="styleclass"?j.setAttribute("class",a[k]):k.toLowerCase()!="classid"&&j.setAttribute(k,a[k]));for(f in b)b[f]!=Object.prototype[f]&&f.toLowerCase()!=
"movie"&&(a=j,g=f,k=b[f],c=v.createElement("param"),c.setAttribute("name",g),c.setAttribute("value",k),a.appendChild(c));e.parentNode.replaceChild(j,e);d=j}}return d}function o(a){var b=r(a);if(b&&b.nodeName=="OBJECT")x.ie&&x.win?(b.style.display="none",function(){if(b.readyState==4){var c=r(a);if(c){for(var d in c)typeof c[d]=="function"&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b)}function r(a){var b=null;try{b=v.getElementById(a)}catch(c){}return b}
function u(a,b,c){a.attachEvent(b,c);P[P.length]=[a,b,c]}function m(a){var b=x.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function p(a,b,c,d){if(!x.ie||!x.mac){var e=v.getElementsByTagName("head")[0];if(e){c=c&&typeof c=="string"?c:"screen";d&&(U=M=null);if(!M||U!=c)d=v.createElement("style"),d.setAttribute("type","text/css"),d.setAttribute("media",c),M=e.appendChild(d),
x.ie&&x.win&&typeof v.styleSheets!=y&&v.styleSheets.length>0&&(M=v.styleSheets[v.styleSheets.length-1]),U=c;x.ie&&x.win?M&&typeof M.addRule==H&&M.addRule(a,b):M&&typeof v.createTextNode!=y&&M.appendChild(v.createTextNode(a+" {"+b+"}"))}}}function q(a,b){if(Y){var c=b?"visible":"hidden";R&&r(a)?r(a).style.visibility=c:p("#"+a,"visibility:"+c)}}function E(a){return/[\\\"<>\.;]/.exec(a)!=null&&typeof encodeURIComponent!=y?encodeURIComponent(a):a}var y="undefined",H="object",z="application/x-shockwave-flash",
t="SWFObjectExprInst",G=window,v=document,D=navigator,Q=!1,O=[function(){Q?f():j()}],s=[],S=[],P=[],B,V,Z,J,R=!1,F=!1,M,U,Y=!0,x=function(){var a=typeof v.getElementById!=y&&typeof v.getElementsByTagName!=y&&typeof v.createElement!=y,b=D.userAgent.toLowerCase(),c=D.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,e=!+"\u000b1",f=[0,0,0],g=null;if(typeof D.plugins!=y&&typeof D.plugins["Shockwave Flash"]==
H){if((g=D.plugins["Shockwave Flash"].description)&&!(typeof D.mimeTypes!=y&&D.mimeTypes[z]&&!D.mimeTypes[z].enabledPlugin))Q=!0,e=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof G.ActiveXObject!=y)try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(j&&(g=j.GetVariable("$version")))e=!0,g=g.split(" ")[1].split(","),
f=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}catch(k){}return{w3:a,pv:f,wk:b,ie:e,win:d,mac:c}}();(function(){x.w3&&((typeof v.readyState!=y&&v.readyState=="complete"||typeof v.readyState==y&&(v.getElementsByTagName("body")[0]||v.body))&&a(),R||(typeof v.addEventListener!=y&&v.addEventListener("DOMContentLoaded",a,!1),x.ie&&x.win&&(v.attachEvent("onreadystatechange",function(){v.readyState=="complete"&&(v.detachEvent("onreadystatechange",arguments.callee),a())}),G==top&&function(){if(!R){try{v.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,
0);return}a()}}()),x.wk&&function(){R||(/loaded|complete/.test(v.readyState)?a():setTimeout(arguments.callee,0))}(),d(a)))})();(function(){x.ie&&x.win&&window.attachEvent("onunload",function(){for(var a=P.length,b=0;b<a;b++)P[b][0].detachEvent(P[b][1],P[b][2]);a=S.length;for(b=0;b<a;b++)o(S[b]);for(var c in x)x[c]=null;x=null;for(var d in swfobject)swfobject[d]=null;swfobject=null})})();return{registerObject:function(a,b,c,d){if(x.w3&&a&&b){var e={};e.id=a;e.swfVersion=b;e.expressInstall=c;e.callbackFn=
d;s[s.length]=e;q(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(x.w3)return g(a)},embedSWF:function(a,d,f,g,j,k,n,s,o,p){var r={success:!1,id:d};x.w3&&!(x.wk&&x.wk<312)&&a&&d&&f&&g&&j?(q(d,!1),e(function(){f+="";g+="";var e={};if(o&&typeof o===H)for(var u in o)e[u]=o[u];e.data=a;e.width=f;e.height=g;u={};if(s&&typeof s===H)for(var v in s)u[v]=s[v];if(n&&typeof n===H)for(var t in n)typeof u.flashvars!=y?u.flashvars+="&"+t+"="+n[t]:u.flashvars=t+"="+n[t];if(m(j))v=w(e,u,d),e.id==
d&&q(d,!0),r.success=!0,r.ref=v;else if(k&&b()){e.data=k;c(e,u,d,p);return}else q(d,!0);p&&p(r)})):p&&p(r)},switchOffAutoHideShow:function(){Y=!1},ua:x,getFlashPlayerVersion:function(){return{major:x.pv[0],minor:x.pv[1],release:x.pv[2]}},hasFlashPlayerVersion:m,createSWF:function(a,b,c){if(x.w3)return w(a,b,c)},showExpressInstall:function(a,d,e,f){x.w3&&b()&&c(a,d,e,f)},removeSWF:function(a){x.w3&&o(a)},createCSS:function(a,b,c,d){x.w3&&p(a,b,c,d)},addDomLoadEvent:e,addLoadEvent:d,getQueryParamValue:function(a){var b=
v.location.search||v.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return E(b);for(var b=b.split("&"),c=0;c<b.length;c++)if(b[c].substring(0,b[c].indexOf("="))==a)return E(b[c].substring(b[c].indexOf("=")+1))}return""},expressInstallCallback:function(){if(F){var a=r(t);if(a&&B){a.parentNode.replaceChild(B,a);if(V&&(q(V,!0),x.ie&&x.win))B.style.display="block";Z&&Z(J)}F=!1}}}}();redhelper.define("common/extensions/swfobject",function(){});
redhelper.define("common/extensions/audio",["common/extensions/swfobject","config/setup"],function(a,e){return function(){var d,f,j=!0,g,b=!0;return{init:function(c){d=c?c:document.createElement("audio");if(d.canPlayType)c||(d.canPlayType("audio/mp3")?d.setAttribute("src",e.DATA_URL+"/extras/msg.mp3"):d.setAttribute("src",e.DATA_URL+"/extras/msg.ogg")),d.volume=0.4,g=function(){d.play()};else{try{if(!a.hasFlashPlayerVersion("1")){g=function(){};b=!1;return}}catch(j){g=function(){};b=!1;return}f=a.createSWF({data:"extras/mp3player.swf",
width:"0",height:"0"},{AllowScriptAccess:"always"},d.id);g=function(){try{f.SetVariable("method:setVolume","40"),f.SetVariable("method:setUrl","extras/msg.mp3"),f.SetVariable("method:play","")}catch(a){}}}},play:function(){j&&g()},turnOn:function(){j=!0},turnOff:function(){j=!1},soundCheck:function(){return b}}}()});
redhelper.define("common/extensions/punycode",[],function(){var a={};(function(a){function d(a){throw RangeError(G[a]);}function f(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function j(a){for(var b=[],c=0,d=a.length,e,f;c<d;)e=a.charCodeAt(c++),(e&63488)==55296&&c<d?(f=a.charCodeAt(c++),(f&64512)==56320?b.push(((e&1023)<<10)+(f&1023)+65536):b.push(e,f)):b.push(e);return b}function g(a){return f(a,function(a){var b="";a>65535&&(a-=65536,b+=Q(a>>>10&1023|55296),a=56320|a&1023);b+=Q(a);return b}).join("")}
function b(a,b,c){var d=0,a=c?D(a/q):a>>1;for(a+=D(a/b);a>v*m>>1;d+=r)a=D(a/v);return D(d+(v+1)*a/(a+p))}function c(a){var c=[],e=a.length,f,j=0,k=y,n=E,p,q,v,t,w;p=a.lastIndexOf(H);p<0&&(p=0);for(q=0;q<p;++q)a.charCodeAt(q)>=128&&d("not-basic"),c.push(a.charCodeAt(q));for(p=p>0?p+1:0;p<e;){for(q=j,f=1,v=r;;v+=r){p>=e&&d("invalid-input");t=a.charCodeAt(p++);t=t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:r;(t>=r||t>D((o-j)/f))&&d("overflow");j+=t*f;w=v<=n?u:v>=n+m?m:v-n;if(t<w)break;t=r-w;f>D(o/t)&&d("overflow");
f*=t}f=c.length+1;n=b(j-q,f,q==0);D(j/f)>o-k&&d("overflow");k+=D(j/f);j%=f;c.splice(j++,0,k)}return g(c)}function k(a){var c,e,f,g,k,n,p,q,t,v=[],w,z,x,a=j(a);w=a.length;c=y;e=0;k=E;for(n=0;n<w;++n)t=a[n],t<128&&v.push(Q(t));for((f=g=v.length)&&v.push(H);f<w;){for(p=o,n=0;n<w;++n)t=a[n],t>=c&&t<p&&(p=t);z=f+1;p-c>D((o-e)/z)&&d("overflow");e+=(p-c)*z;c=p;for(n=0;n<w;++n)if(t=a[n],t<c&&++e>o&&d("overflow"),t==c){for(q=e,p=r;;p+=r){t=p<=k?u:p>=k+m?m:p-k;if(q<t)break;x=q-t;q=r-t;v.push(Q(t+x%q+22+75*
(t+x%q<26)-0));q=D(x/q)}v.push(Q(q+22+75*(q<26)-0));k=b(e,z,f==g);e=0;++f}++e;++c}return v.join("")}function n(a){return f(a.split("."),function(a){return t.test(a)?c(a.slice(4).toLowerCase()):a}).join(".")}function w(a){return f(a.split("."),function(a){return z.test(a)?"xn--"+k(a):a}).join(".")}var o=2147483647,r=36,u=1,m=26,p=38,q=700,E=72,y=128,H="-",z=/[^ -~]/,t=/^xn--/,G={overflow:"Overflow: input needs wider integers to process.","not-basic":"Illegal input >= 0x80 (not a basic code point)",
"invalid-input":"Invalid input"},v=r-u,D=Math.floor,Q=String.fromCharCode;a.punycode={version:"1.1.1",ucs2:{decode:j,encode:g},decode:c,encode:k,toASCII:w,toUnicode:n,decodeUri:function(a){var b=a.split("//").pop().split("/")[0],c=n(b);return a.replace(b,c)},encodeUri:function(a){var b=a.split("//").pop().split("/")[0],c=w(b);return a.replace(b,c)}}})(a);return a.punycode});
redhelper.require(["application/dispatcher","config/setup","common/extensions/compatibility"],function(a,e){function d(){j=JSON.parse(window.localStorage.getItem(f))||[]}if(window.localStorage){var f=e.CLIENT_NAME+".history",j=JSON.parse(window.localStorage.getItem(f))||[];a.addEventListener("message",function(a){!a.isHistory&&!a.ignore&&a.text&&!a.isSync&&(j.push({time:a.time,id:a.id,text:a.text,sender:a.sender,displayName:a.displayName,guid:a.guid}),window.localStorage.setItem(f,JSON.stringify(j)))});
a.addEventListener("getHistory",function(){d();for(var e in j)if(j.hasOwnProperty(e))j[e].isHistory=!0,a.fire("message",j[e]);a.fire("historyShown")});rhlpSetInterval(function(){var e=j;d();var b=j,c=[],f;for(f in b){var n=!0,w;for(w in e)e[w].id==b[f].id&&(n=!1);n&&c.push(b[f])}for(var o in c)if(c.hasOwnProperty(o))c[o].isHistory=!0,c[o].isSync=!0,c[o].sent=!0,c[o].log=!0,a.fire("message",c[o])},300)}});redhelper.define("xmpp/history.cache",function(){});
redhelper.define("xmpp/offline",["common/extensions/jquery.plugins","application/dispatcher","config/lang","config/setup","common/constants/offlineError"],function(a,e,d,f,j){var g=function(){return{send:function(b,c,d){d="["+f.CURRENT_URL+"]\n\n"+d;a.ajax({url:f.NX_URL+"offline/"+f.CLIENT_NAME,data:{message:d,name:b,email:c,domain:f.CURRENT_URL},dataType:"jsonp",type:"POST",success:function(a){a=="OK"?e.fire("offlineSuccess"):e.fire("offlineFailure",{errorCode:j.INCORRECT_EMAIL})}})}}}();e.addEventListener("sendOffline",
function(a){g.send(a.name,a.email,a.message)})});
redhelper.define("common/extensions/tabs",["common/extensions/compatibility","config/setup"],function(a,e){var d=function(){},f=function(){},j="rhlp."+e.CLIENT_NAME+".tabs.",g=1,b=1,c=[],k={};if(localStorage.getItem(j+"count"))for(var n=1;n<parseInt(localStorage.getItem(j+"count"))+2;n++)localStorage.getItem(j+n)?(c.push(n),b=n):g==1&&(b=g=n);else localStorage.setItem(j+"count",1);localStorage.getItem(j+"count")<b&&localStorage.setItem(j+"count",b);rhlpSetInterval(function(){localStorage.setItem(j+
g,(new Date).getTime())},50);rhlpSetInterval(function(){var a=!1,b;for(b in c)c.hasOwnProperty(b)&&(k[c[b]]?k[c[b]]==localStorage.getItem(j+c[b])||!localStorage.getItem(j+c[b])?(c.splice(b,1),c.length==0&&d()):(k[c[b]]=localStorage.getItem(j+c[b]),a=!0):k[c[b]]=localStorage.getItem(j+c[b]));a&&f()},1100);return{setWaiter:function(a){c.length==0?a():d=a},isSingle:function(){return c.length==0},setStep:function(a){f=a}}});redhelper.requirejs.config({baseUrl:"js",paths:{common:"../../common/js"}});
redhelper.requirejs("application/dispatcher,view/view,view/chat,application/session.objects,common/extensions/jquery.plugins,config/lang,xmpp/messages,view/cssChecker,xmpp/xmppManager,view/uiEvents,common/extensions/audio,common/extensions/punycode,application/parent,xmpp/connection,common/constants/sender,application/timer,common/application/basicActivity,common/extensions/debug,config/setup,xmpp/update,common/extensions/mouse,common/communication/messageTarget,xmpp/history.cache,xmpp/offline,common/extensions/tabs".split(","),function(a,
e,d,f,j,g,b,c,k,n,w,o,r,u,m,p,q,E,y,H,z,t,G,v,D){a.addEventListener("start",function(){a.removeAllEventListeners("start");g.initLanguage();e.show();var b=function(a){f.isOnline===!1&&!a.isHistory&&setTimeout(function(){location.reload()},3E3)};a.addEventListener("message",b);a.addEventListener("invitation",b);d.setOutput("#chatItself");a.addEventListener("message",function(a){d.append(a)});a.addEventListener("cssLoaded",function(){j("#loading").animate({opacity:"hide"},150);d.scrollBottom()});setTimeout(function(){j("#loading").hide()},
1E3);a.addEventListener("historyShown",function(){d.scrollBottom()});a.addEventListener("cssLoaded",function(){if(navigator.userAgent.indexOf("Android")>-1){var a=function(){parseInt(j("#online .center").css("padding-top"))?j("#onlinePanel").css("height",j("#online").height()-parseInt(j("#online .center").css("padding-top"))-parseInt(j("#online .center").css("padding-bottom"))+"px"):setTimeout(a,100)};setTimeout(a,500)}});c.check();a.fire("getHistory");g.initLanguage();n.bind();d.scrollBottom();a.addEventListener("cssLoaded",
function(){if(f.cachedEvent){var b=JSON.parse(f.cachedEvent);f.cachedEvent="";Array.isArray(b)?j.each(b,function(b,c){c.isCached=!0;a.fire(c)}):(b.isCached=!0,a.fire(b))}});!f.isOnline&&!f.offlineEnabled&&r.send("hide")});a.addEventListener("xmppStart",function(){a.addEventListener("operator",function(){f.firstMessage&&f.operDisplayName&&(j("#chatItself .invitation").length||d.showFirstMessage({sender:m.OPERATOR,time:"",text:f.currentFirstMessage||f.firstMessage,displayName:f.operDisplayName}))});
f.dispatcher.addEventListener("onCurrentTypedTextChanged",function(){b.typedTextChanged()});a.addEventListener("message",function(){q.update()});a.addEventListener("authenticated",function(){e.show();E.timeEnd("Connection")});a.addEventListener("connected",function(){d.scrollBottom()});a.addEventListener("highlight",function(b){b.url===y.CURRENT_URL||o.decodeUri(b.url)===y.CURRENT_URL?(w.play(),r.send("highlight",b),a.fire("cobrowseMessage",{action:"confirm",target:"highlight"})):(f.cachedEvent=JSON.stringify(b),
a.fire({type:"redirect",link:b.url,noFeedback:!0}))});a.addEventListener("redirect",function(a){w.play();d.showRedirectPrompt(a.link,a.noFeedback)});a.addEventListener("redirectCancel",function(){a.fire("cobrowseMessage",{action:"reject",target:"redirect"})});a.addEventListener("redirectOK",function(b){var c=function(d){d.action=="confirm"&&d.target=="redirect"&&r.send("redirect",b);a.removeEventListener("cobrowseMessageSent",c)};a.addEventListener("cobrowseMessageSent",c);a.fire("cobrowseMessage",
{action:"confirm",target:"redirect"})})});f.onLoad(function(){j(document).ready(function(){E.time("Connection");k.logMessages();D.setWaiter(function(){k.start()});D.setStep(function(){k.flushQueue()});D.isSingle()||a.addEventListener("start",function(){f.firstMessage&&f.operDisplayName&&(j("#chatItself .invitation").length||d.showFirstMessage({sender:m.OPERATOR,time:"",text:f.currentFirstMessage||f.firstMessage,displayName:f.operDisplayName}))});q.start();if(y.STANDALONE)y.CURRENT_URL=g.URL_NEW_TAB,
y.CURRENT_TITLE=g.TITLE_NEW_TAB,a.fire("start"),a.addEventListener("operator",function(){H.state("chat")}),a.addEventListener("userBack",function(){u.init(!0);a.fire("refreshHistory")}),a.addEventListener("userAway",function(){a.fire("disconnect")}),a.addEventListener("timer_userBack",function(){p.start()}),a.addEventListener("timer_userAway",function(){p.stop()});else{r=new t(parent,y.PARENT_URL,y.PARENT_URI);r.addHandler("init",function(){r.send("ready")});r.addHandler("echo",function(){r.send("echo")});
r.addHandler("start",function(b){y.CURRENT_URL=b.url;y.CURRENT_TITLE=b.title;f.referrer=b.referrer;r.setOrigin(b.url);a.fire("xmppStart")});var b=!0,c=!0;r.addHandler("active",function(){b=!0;q.isActive()||u.init(!0)});r.addHandler("inactive",function(){b=!1;q.isActive()||a.fire("disconnect")});a.addEventListener("userBack",function(){b||(u.init(!0),a.fire("refreshHistory"))});a.addEventListener("userAway",function(){b||a.fire("disconnect")});r.addHandler("timer_active",function(){c=!0;p.getActivity().isActive()||
p.start()});r.addHandler("timer_inactive",function(){c=!1;p.getActivity().isActive()||p.stop()});a.addEventListener("timer_userBack",function(){c||p.start()});a.addEventListener("timer_userAway",function(){c||p.stop()});r.addHandler("message",function(a){d.append(a)});r.addHandler("reconnect",function(){a.fire("reconnect")});r.send("ready");z.init().setAsMaster().addParentSlave(r);z.setOffsetFunction(function(a){a.x+=f.currentChatX;a.y=a.y+f.currentChatY+20;a.width=z.getParentMouseData().width;a.height=
z.getParentMouseData().height;a.scrollX=z.getParentMouseData().scrollX;a.scrollY=z.getParentMouseData().scrollY});r.addHandler("state",function(a){a.inviteState?H.invite(a.chatState,a.inviteState,a.trigger):H.state(a.chatState)});r.addHandler("invitationSniff",function(a){H.inviteSniff(a.trigger,a.trigger=="manual"?f.currentOperator:"")});r.addHandler("chOper",function(a){y.REQUIRE_OPERATOR=a.value});r.addHandler("chatXChanged",function(a){f.chatX=a.x});r.addHandler("chatYChanged",function(a){f.chatY=
a.y});r.addHandler("chatWidthChanged",function(a){f.chatWidth=a.width});r.addHandler("chatHeightChanged",function(a){f.chatHeight=a.height});r.addHandler("chatStateChanged",function(a){f.chatState=a.chatState});r.addHandler("chatXChanged",function(a){f.chatX=a.x;f.currentChatX=a.x});r.addHandler("chatYChanged",function(a){f.chatY=a.y;f.currentChatY=a.y});r.addHandler("chatWidthChanged",function(a){f.chatWidth=a.width;f.currentChatWidth=a.width});r.addHandler("chatHeightChanged",function(a){f.chatHeight=
a.height;f.currentChatHeight=a.height});r.addHandler("currentChatXChanged",function(a){f.currentChatX=a.x});r.addHandler("currentChatYChanged",function(a){f.currentChatY=a.y});r.addHandler("currentChatWidthChanged",function(a){f.currentChatWidth=a.width});r.addHandler("currentChatHeightChanged",function(a){f.currentChatHeight=a.height});r.addHandler("chatStateChanged",function(a){f.chatState=a.chatState});a.addEventListener("invitation",function(a){r.send("invitation",a)});a.addEventListener("authenticated",
function(){r.send("authenticated");!f.isOnline&&!f.offlineEnabled&&(r.send("hide"),a.fire("disconnect"))});a.addEventListener("disconnected",function(){r.send("disconnected");u.reconnect()});r.addHandler("reload",function(){setTimeout(function(){location.reload()},3E3)});a.addEventListener("message",function(a){r.send("message",a)});a.addEventListener("offlineDone",function(){r.send("minimize")})}w.init(j("#audio")[0]);w.soundCheck()||r.send("hideSoundButton");a.addEventListener("message",function(a){a.sender==
m.OPERATOR&&!a.isHistory&&w.play()});r.addHandler("soundOn",function(){w.turnOn()});r.addHandler("soundOff",function(){w.turnOff()});a.fire("start")})})});redhelper.define("application/main",function(){});
//@ sourceMappingURL=main.js.map